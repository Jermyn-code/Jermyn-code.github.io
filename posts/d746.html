<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>shell 学习笔记 | Jermyn's blog</title><meta name="keywords" content="shell脚本"><meta name="author" content="Jermyn,born_in2084@yeah.net"><meta name="copyright" content="Jermyn"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="shell脚本学习笔记，学完可自行编写shell脚本"><meta property="og:type" content="article"><meta property="og:title" content="shell 学习笔记"><meta property="og:url" content="https://www.jermyn.cn/posts/d746.html"><meta property="og:site_name" content="Jermyn&#39;s blog"><meta property="og:description" content="shell脚本学习笔记，学完可自行编写shell脚本"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed@main/9a8a/8.png"><meta property="article:published_time" content="2022-08-26T20:13:52.000Z"><meta property="article:modified_time" content="2023-07-11T16:25:21.188Z"><meta property="article:author" content="Jermyn"><meta property="article:tag" content="shell脚本"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed@main/9a8a/8.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.jermyn.cn/posts/d746"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#49b1f5"><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/128.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/32.png"><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/16.png"><link rel="mask-icon" href="/img/siteicon/128.png" color="#5bbad5"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"shell 学习笔记",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-07-11 16:25:21"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css"><link rel="stylesheet" href="/js/runtime/runtime.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload='this.media="screen"'><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload='this.media="all"'><script src="https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Jermyn's blog" type="application/atom+xml"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed@main/9a8a/auther.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">17</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><span>留言</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><span>档案</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><span>音乐</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/index.html"><span>番剧</span></a></div><div class="menus_item"><a class="site-page" href="/books"><span>书籍</span></a></div><div class="menus_item"><a class="site-page" href="/movies/"><span>影视</span></a></div><div class="menus_item"><a class="site-page" href="/games/"><span>游戏</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed@main/9a8a/8.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Jermyn's blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><span>留言</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><span>档案</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><span>音乐</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/index.html"><span>番剧</span></a></div><div class="menus_item"><a class="site-page" href="/books"><span>书籍</span></a></div><div class="menus_item"><a class="site-page" href="/movies/"><span>影视</span></a></div><div class="menus_item"><a class="site-page" href="/games/"><span>游戏</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">shell 学习笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-26T20:13:52.000Z" title="发表于 2022-08-26 20:13:52">2022-08-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-07-11T16:25:21.188Z" title="更新于 2023-07-11 16:25:21">2023-07-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux/">Linux</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">29.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>132分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="shell 学习笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="小工具用法"><a href="#小工具用法" class="headerlink" title="小工具用法"></a>小工具用法</h2><h4 id="grep-用法"><a href="#grep-用法" class="headerlink" title="grep 用法"></a>grep 用法</h4><p>语法：行过滤</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep [选项] <span class="string">&#x27;关键字&#x27;</span> 文件名 </span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">OPTIONS:</span><br><span class="line">    <span class="literal">-i</span>: 不区分大小写</span><br><span class="line">    <span class="literal">-v</span>: 查找不包含指定内容的行,反向选择(取反)</span><br><span class="line">    <span class="literal">-w</span>: 按单词搜索</span><br><span class="line">    <span class="literal">-o</span>: 打印匹配关键字</span><br><span class="line">    <span class="literal">-c</span>: 统计匹配到的行数</span><br><span class="line">    <span class="literal">-n</span>: 显示行号（注：区分大小写。不区分大小写的话 <span class="literal">-ni</span> ）</span><br><span class="line">    <span class="literal">-r</span>: 逐层遍历目录查找</span><br><span class="line">    <span class="literal">-A</span>: 显示匹配行及后面多少行	</span><br><span class="line">    <span class="literal">-B</span>: 显示匹配行及前面多少行</span><br><span class="line">    <span class="literal">-C</span>: 显示匹配行前后多少行</span><br><span class="line">    <span class="literal">-l</span>：只列出匹配的文件名</span><br><span class="line">    <span class="literal">-L</span>：列出不匹配的文件名</span><br><span class="line">    <span class="literal">-e</span>: 使用正则匹配</span><br><span class="line">    <span class="literal">-E</span>:使用扩展正则匹配</span><br><span class="line">    ^key:以关键字开头</span><br><span class="line">    key<span class="variable">$</span>:以关键字结尾</span><br><span class="line">    ^<span class="variable">$</span>:匹配空行</span><br><span class="line">    <span class="literal">--color</span>=auto ：可以将找到的关键词部分加上颜色的显示</span><br></pre></td></tr></table></figure><p><strong>1.1 对 grep 起个别名 每次输入 grep 达到 grep —color=auto 效果</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.临时生效</span><br><span class="line">alias grep=<span class="string">&#x27;grep --color=auto&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.永久生效，全局,修改配置文件/etc/bashrc 文末添加</span><br><span class="line">此文件是用户在登陆时被读取</span><br><span class="line">vim /etc/bashrc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># vim:ts=4:sw=4</span></span><br><span class="line">alias grep=<span class="string">&#x27;grep --color=auto&#x27;</span></span><br><span class="line"></span><br><span class="line">重新加载文件</span><br><span class="line">source /etc/bashrc</span><br></pre></td></tr></table></figure><p><strong>1.2 需求</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">前置：<span class="built_in">cp</span> /etc/passwd .</span><br><span class="line"><span class="number">1</span>.过滤文件内容包含 root 的</span><br><span class="line">grep <span class="string">&#x27;root&#x27;</span> passwd</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.过滤文件内容包含 root 的行显示行号（区分大小写）</span><br><span class="line">grep <span class="literal">-n</span> <span class="string">&#x27;root&#x27;</span> passwd</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.过滤文件内容包含 root 的行显示行号（不区分大小写）</span><br><span class="line">grep <span class="literal">-ni</span> <span class="string">&#x27;root&#x27;</span> passwd</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>.过滤文件内容以 root 开头的行</span><br><span class="line">grep <span class="string">&#x27;^root&#x27;</span> passwd</span><br><span class="line"></span><br><span class="line"><span class="number">5</span>.过滤文件内容以 bash 结尾的行</span><br><span class="line">grep  <span class="string">&#x27;bash$&#x27;</span> passwd</span><br><span class="line"></span><br><span class="line"><span class="number">6</span>.过滤不以 root 开头的行</span><br><span class="line">grep <span class="literal">-iv</span> <span class="string">&#x27;^root&#x27;</span> passwd</span><br><span class="line"></span><br><span class="line"><span class="number">7</span>.过滤包含 root 的后<span class="number">5</span>行，显示行号</span><br><span class="line">grep <span class="literal">-nA</span> <span class="number">5</span> <span class="string">&#x27;root&#x27;</span> passwd</span><br><span class="line"></span><br><span class="line"><span class="number">8</span>.过滤包含 mail 的前<span class="number">5</span>行，显示行号</span><br><span class="line">grep <span class="literal">-nB</span> <span class="string">&#x27;mail&#x27;</span> passwd</span><br><span class="line"></span><br><span class="line"><span class="number">9</span>.过滤包含 mail 的前后<span class="number">3</span>行，显示行号</span><br><span class="line">grep <span class="literal">-nC</span> <span class="number">3</span> <span class="string">&#x27;mail&#x27;</span> passwd</span><br><span class="line"></span><br><span class="line"><span class="number">10</span>.统计 passwd 文件中 root 出现的次数</span><br><span class="line">grep <span class="literal">-c</span> <span class="string">&#x27;root&#x27;</span> passwd</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="cut-用法"><a href="#cut-用法" class="headerlink" title="cut 用法"></a>cut 用法</h4><p>语法：列截取的工具</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cut 选项  文件名</span><br></pre></td></tr></table></figure><p><strong>2.1 常见选项：</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">-c</span>:	以字符为单位进行分割,截取</span><br><span class="line"><span class="literal">-d</span>:	自定义分隔符，默认为制表符\t</span><br><span class="line"><span class="operator">-f</span>:	与<span class="literal">-d</span>一起使用，指定截取哪个区域</span><br></pre></td></tr></table></figure><p><strong>2.2 需求</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.分割以 ：为分隔符第一列的内容</span><br><span class="line">cut <span class="literal">-d</span> <span class="string">&#x27;:&#x27;</span> <span class="operator">-f</span> <span class="number">1</span> passwd</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.以 ：为分割符 第<span class="number">1</span>列和第<span class="number">5</span>列的内容，显示前<span class="number">10</span>行</span><br><span class="line">cut <span class="literal">-d</span> <span class="string">&#x27;:&#x27;</span> <span class="operator">-f</span> <span class="number">1</span>,<span class="number">5</span> passwd | head </span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.截取第<span class="number">2</span>到第<span class="number">5</span>个字符</span><br><span class="line">cut <span class="literal">-c</span> <span class="number">2</span><span class="literal">-5</span> passwd</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>.截取第<span class="number">1</span>个字符</span><br><span class="line">cut <span class="literal">-c</span> <span class="number">1</span> passwd</span><br><span class="line"></span><br><span class="line"><span class="number">5</span>.截取第<span class="number">10</span>个字符以后的内容</span><br><span class="line">cut <span class="literal">-c</span> <span class="number">10</span>- passwd</span><br><span class="line"></span><br><span class="line"><span class="number">6</span>.显示当前系统的运行级别</span><br><span class="line">runlevel | cut <span class="literal">-d</span> <span class="string">&#x27; &#x27;</span> <span class="operator">-f</span> <span class="number">2</span></span><br><span class="line">runlevel | cut <span class="literal">-c</span> <span class="number">3</span></span><br></pre></td></tr></table></figure><h4 id="tee-用法"><a href="#tee-用法" class="headerlink" title="tee 用法"></a>tee 用法</h4><p>语法：tee工具是从标准输入读取并写入到标准输出和文件，即：双向覆盖重定向（屏幕输出|文本输入）</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[语法] | <span class="built_in">tee</span> [内容]</span><br></pre></td></tr></table></figure><p><strong>3.1 常见选项</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">选项：</span><br><span class="line"><span class="literal">-a</span>：双向追加重定向</span><br><span class="line">注：不加 <span class="literal">-a</span> 默认是覆盖的</span><br></pre></td></tr></table></figure><p><strong>3.2 需求</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.查看主机的网络配置文件并保存到 network_config.txt</span><br><span class="line">grep <span class="literal">-v</span> <span class="string">&#x27;^#&#x27;</span> /etc/sysconfig/network<span class="literal">-scripts</span>/ifcfg<span class="literal">-ens33</span> | grep <span class="literal">-v</span> <span class="string">&#x27;^$&#x27;</span> | <span class="built_in">tee</span> network_config.txt</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.查看主机的广播地址并保存到 broadcast.txt</span><br><span class="line">ifconfig | grep <span class="string">&#x27;broadcast&#x27;</span> | cut <span class="literal">-d</span> <span class="string">&#x27; &#x27;</span> <span class="operator">-f</span> <span class="number">15</span>,<span class="number">16</span> | <span class="built_in">tee</span> broadcast.txt</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.查看主机的子网掩码并追加到 broadcast.txt</span><br><span class="line">ifconfig | grep <span class="string">&#x27;broadcast&#x27;</span> | cut <span class="literal">-d</span> <span class="string">&#x27; &#x27;</span> <span class="operator">-f</span> <span class="number">12</span>,<span class="number">13</span> | <span class="built_in">tee</span> <span class="literal">-a</span> broadcast.txt</span><br></pre></td></tr></table></figure><h4 id="sort-用法"><a href="#sort-用法" class="headerlink" title="sort 用法"></a>sort 用法</h4><p>语法：sort工具用于排序;它将文件的每一行作为一个单位，从首字符向后，依次按ASCII码值进行比较，最后将他们按升序输出。</p><p><strong>4.1 常见选项</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">-u</span> ：去除重复行</span><br><span class="line"><span class="literal">-r</span> ：降序排列，默认是升序</span><br><span class="line"><span class="literal">-o</span> : 将排序结果输出到文件中,类似重定向符号&gt;</span><br><span class="line"><span class="literal">-n</span> ：以数字排序，默认是按字符排序</span><br><span class="line"><span class="literal">-t</span> ：分隔符</span><br><span class="line"><span class="literal">-k</span> ：第N列</span><br><span class="line"><span class="literal">-b</span> ：忽略前导空格。</span><br><span class="line"><span class="literal">-R</span> ：随机排序，每次运行的结果均不同</span><br></pre></td></tr></table></figure><p><strong>4.2 需求</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. 按照用户的uid进行升序排列</span><br><span class="line"><span class="built_in">sort</span> <span class="literal">-n</span> <span class="literal">-t</span> <span class="string">&#x27;:&#x27;</span> <span class="literal">-k</span> <span class="number">3</span> passwd</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.按照用户的uid进行降序排列</span><br><span class="line"><span class="built_in">sort</span> <span class="literal">-nr</span> <span class="literal">-t</span> <span class="string">&#x27;:&#x27;</span> <span class="literal">-k</span> <span class="number">3</span> passwd</span><br></pre></td></tr></table></figure><h4 id="uniq-用法"><a href="#uniq-用法" class="headerlink" title="uniq 用法"></a>uniq 用法</h4><p>语法：uniq用于去除 连续的 重复行</p><p><strong>5.1 常见选项</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">-i</span>: 忽略大小写</span><br><span class="line"><span class="literal">-c</span>: 统计重复行次数</span><br><span class="line"><span class="literal">-d</span>:只显示重复行</span><br></pre></td></tr></table></figure><h4 id="diff-用法"><a href="#diff-用法" class="headerlink" title="diff 用法"></a>diff 用法</h4><p>语法：逐行比较两个文件的不同，即怎样改变第一个文件才能和第二个文件相同。</p><p>两个文件的内容相同的时候就不出结果</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">diff</span> [选项] 文件<span class="number">1</span> 文件<span class="number">2</span> </span><br></pre></td></tr></table></figure><p><strong>6.1 常见选项</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">-b</span>：不检查空格</span><br><span class="line"><span class="literal">-B</span>：不检查空白行</span><br><span class="line"><span class="literal">-i</span>：不检查大小写</span><br><span class="line"><span class="literal">-w</span>：忽略所有的空格</span><br><span class="line"><span class="literal">--normal</span>：正常格式显示(默认)</span><br><span class="line"><span class="literal">-c</span>：上下文格式显示</span><br><span class="line"><span class="literal">-u</span>：合并格式显示</span><br></pre></td></tr></table></figure><p><strong>6.2 举例说明</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">vim file1</span><br><span class="line">添加内容：</span><br><span class="line">aaaa</span><br><span class="line"><span class="number">111</span></span><br><span class="line">hello world</span><br><span class="line"><span class="number">222</span></span><br><span class="line"><span class="number">333</span></span><br><span class="line">bbb</span><br><span class="line"></span><br><span class="line">vim file2</span><br><span class="line">添加内容：</span><br><span class="line">aaa</span><br><span class="line">hello</span><br><span class="line"><span class="number">111</span></span><br><span class="line"><span class="number">222</span></span><br><span class="line">bbb</span><br><span class="line"><span class="number">333</span></span><br><span class="line">world</span><br></pre></td></tr></table></figure><p><strong>6.2.1 diff 正常格式显示即 —normal （默认）</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">diff</span> file1 file2</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">结果显示：</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># diff file1 file2</span></span><br><span class="line"><span class="number">1</span>c1,<span class="number">2</span>           第一个文件（file1）的第<span class="number">1</span>行需改变（c=change）和第二个文件（file2）的 <span class="number">1</span>至<span class="number">2</span>行匹配</span><br><span class="line">&lt; aaaa          “&lt;” 即左边的文件（file1）内容 aaaa </span><br><span class="line"><span class="literal">---</span>             分割线</span><br><span class="line">&gt; aaa           “&gt;” 即右边文件（file2）的内容 </span><br><span class="line">&gt; hello</span><br><span class="line"><span class="number">3</span>d3             第一个文件的第<span class="number">3</span>行需删除（d=delete）和第二个文件（file2）的第 <span class="number">3</span> 行匹配</span><br><span class="line">&lt; hello world   文件左边的内容 即删除 hello world</span><br><span class="line"><span class="number">5</span>d4             第一个文件的第<span class="number">5</span>行需删除（d=delete）和第二个文件（file2）的第 <span class="number">4</span> 行匹配</span><br><span class="line">&lt; <span class="number">333</span>           文件左边的内容 即删除 <span class="number">333</span></span><br><span class="line"><span class="number">6</span>a6,<span class="number">7</span>           第一个文件的第<span class="number">6</span>行需添加（a=add）和第二个文件（file2）的第 <span class="number">6</span>，<span class="number">7</span> 行匹配</span><br><span class="line">&gt; <span class="number">333</span>           添加的内容是第二个文件<span class="number">6</span>，<span class="number">7</span>行的 <span class="number">333</span> 和 world</span><br><span class="line">&gt; world</span><br></pre></td></tr></table></figure><p><strong>6.2.2 diff 上下文格式显示 -c</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">diff</span> <span class="literal">-c</span> file1 file2</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">结果显示：</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># diff -c file1 file2</span></span><br><span class="line">下面两行显示了文件名，时间戳； *** 表示前一个文件即file1  <span class="literal">---</span>表示后一个文件即 file2</span><br><span class="line">下面两个部分都是在 file1的角度，指如何改变file1 才能和file2 一样</span><br><span class="line">*** file1       <span class="number">2022</span><span class="literal">-07-03</span> <span class="number">09</span>:<span class="number">51</span>:<span class="number">21.046292165</span> +<span class="number">0800</span></span><br><span class="line"><span class="literal">---</span> file2       <span class="number">2022</span><span class="literal">-07-03</span> <span class="number">09</span>:<span class="number">51</span>:<span class="number">39.631278483</span> +<span class="number">0800</span></span><br><span class="line">***************        分隔符</span><br><span class="line">*** <span class="number">1</span>,<span class="number">6</span> ****           以***开头的表示file1 数字<span class="number">1</span>,<span class="number">6</span> 表示<span class="number">1</span>到<span class="number">6</span>行</span><br><span class="line">! aaaa                 ! 表示此行需要修改才可以与file2 匹配</span><br><span class="line">  <span class="number">111</span></span><br><span class="line">- hello world          - 表示此行需要删除才可以与file2 匹配</span><br><span class="line">  <span class="number">222</span></span><br><span class="line">- <span class="number">333</span>                  - 表示此行需要删除才可以与file2 匹配</span><br><span class="line">  bbb</span><br><span class="line"><span class="literal">---</span> <span class="number">1</span>,<span class="number">7</span> <span class="literal">----</span>           以<span class="literal">---</span>开头的表示file2 数字<span class="number">1</span>,<span class="number">7</span> 表示<span class="number">1</span>到<span class="number">7</span>列</span><br><span class="line">! aaa	               表示第一个文件需要修改才与第二个文件匹配</span><br><span class="line">! hello                表示第一个文件需要修改才与第二个文件匹配</span><br><span class="line">  <span class="number">111</span></span><br><span class="line">  <span class="number">222</span></span><br><span class="line">  bbb</span><br><span class="line">+ <span class="number">333</span>                  表示第一个文件需要加上该行才与第二个文件匹配</span><br><span class="line">+ world                表示第一个文件需要加上该行才与第二个文件匹配</span><br></pre></td></tr></table></figure><p><strong>6.2.3 diff 合并模式 -u</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">diff</span> <span class="literal">-u</span> file1 file2</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">结果显示：</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># diff -u file1 file2</span></span><br><span class="line"><span class="literal">---</span> 指的是第一个文件即 file1 +++ 指的是第二个文件即file2 数字是时间戳 </span><br><span class="line"><span class="literal">---</span> file1       <span class="number">2022</span><span class="literal">-07-03</span> <span class="number">09</span>:<span class="number">51</span>:<span class="number">21.046292165</span> +<span class="number">0800</span></span><br><span class="line">+++ file2       <span class="number">2022</span><span class="literal">-07-03</span> <span class="number">09</span>:<span class="number">51</span>:<span class="number">39.631278483</span> +<span class="number">0800</span></span><br><span class="line"><span class="selector-tag">@</span><span class="selector-tag">@</span> <span class="literal">-1</span>,<span class="number">6</span> +<span class="number">1</span>,<span class="number">7</span> <span class="selector-tag">@</span><span class="selector-tag">@</span></span><br><span class="line"><span class="literal">-aaaa</span>           第一个文件需要 删除 aaaa</span><br><span class="line">+aaa            第一个文件 添加 aaa</span><br><span class="line">+hello          第一个文件 添加 hello</span><br><span class="line"> <span class="number">111</span>            <span class="number">111</span>不变</span><br><span class="line"><span class="literal">-hello</span> world    第一个文件 删除 hello world</span><br><span class="line"> <span class="number">222</span>            <span class="number">222</span>不变</span><br><span class="line"><span class="literal">-333</span>            第一个文件 删除 <span class="number">333</span></span><br><span class="line"> bbb            bbb不变</span><br><span class="line">+<span class="number">333</span>            第一个文件 添加 <span class="number">333</span></span><br><span class="line">+world          第一个文件 添加 world</span><br></pre></td></tr></table></figure><p><strong>6.3 diff 工具比较两个目录的不同（注：此功能较常用）</strong></p><p>数据准备：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># mkdir dir1 dir2</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># touch dir1/file&#123;1..5&#125;</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># touch dir2/file&#123;1..3&#125;</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># touch dir2/test&#123;1..2&#125;</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># ls -R dir*</span></span><br><span class="line">dir1:</span><br><span class="line">file1  file2  file3  file4  file5</span><br><span class="line"></span><br><span class="line">dir2:</span><br><span class="line">file1  file2  file3  test1  test2</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment">#</span></span><br><span class="line">文件里面随便添加一些数据</span><br></pre></td></tr></table></figure><p><strong>6.3.1 比较两个文件目录的不同，也会比较两个文件里面文件内容的不同</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># diff dir1 dir2</span></span><br><span class="line"><span class="built_in">diff</span> dir1/file1 dir2/file1</span><br><span class="line"><span class="number">1</span>c1</span><br><span class="line">&lt; aa</span><br><span class="line"><span class="literal">---</span></span><br><span class="line">&gt; fja</span><br><span class="line"><span class="built_in">diff</span> dir1/file2 dir2/file2</span><br><span class="line"><span class="number">1</span>d0</span><br><span class="line">&lt; aa</span><br><span class="line"><span class="built_in">diff</span> dir1/file3 dir2/file3</span><br><span class="line"><span class="number">1</span>d0</span><br><span class="line">&lt; afdas</span><br><span class="line">Only <span class="keyword">in</span> dir1: file4</span><br><span class="line">Only <span class="keyword">in</span> dir1: file5</span><br><span class="line">Only <span class="keyword">in</span> dir2: test1</span><br><span class="line">Only <span class="keyword">in</span> dir2: test2</span><br></pre></td></tr></table></figure><p><strong>6.3.1 只比较文件目录的不同不比较文件内容不同 -q</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># diff -q dir1 dir2</span></span><br><span class="line">Files dir1/file1 and dir2/file1 differ</span><br><span class="line">Files dir1/file2 and dir2/file2 differ</span><br><span class="line">Files dir1/file3 and dir2/file3 differ</span><br><span class="line">Only <span class="keyword">in</span> dir1: file4</span><br><span class="line">Only <span class="keyword">in</span> dir1: file5</span><br><span class="line">Only <span class="keyword">in</span> dir2: test1</span><br><span class="line">Only <span class="keyword">in</span> dir2: test2</span><br></pre></td></tr></table></figure><p><strong>6.4 打补丁</strong></p><p>diff 找出文件的不同的目的是变相同，以一个文件为标准，去修改其他文件，并且修改的地方较多时，我们可以通过打补丁的方式完成。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.先找出两个文件的不同输出到另一个文件中</span><br><span class="line"><span class="built_in">diff</span> <span class="literal">-uN</span> file1 file2 | <span class="built_in">tee</span> file.patch</span><br><span class="line"><span class="literal">-u</span>:合并模式</span><br><span class="line"><span class="literal">-N</span>:将不存在的文件当作空文件</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.将不同的内容打补丁到 file1</span><br><span class="line">patch file1 file.patch</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.测试验证（注：内容为空则修改完成）</span><br><span class="line"><span class="built_in">diff</span> file1 file2</span><br></pre></td></tr></table></figure><h4 id="paste用法"><a href="#paste用法" class="headerlink" title="paste用法"></a>paste用法</h4><p>用法：paste工具用于合并文件行，并不改变原文件</p><p><strong>7.1 常见选项</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">-d</span>：自定义间隔符，默认是tab</span><br><span class="line"><span class="literal">-s</span>：串行处理，非并行</span><br></pre></td></tr></table></figure><p><strong>7.2 举例说明</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;file1的第一行内容&#x27;</span> &gt; file1</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;file1的第二行内容&#x27;</span> &gt;&gt; file1</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;file2的第一行内容&#x27;</span> &gt; file2</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;file2的第二行内容&#x27;</span> &gt;&gt; file2</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;file2的第三行内容&#x27;</span> &gt;&gt; file2</span><br></pre></td></tr></table></figure><p><strong>7.2.1 默认分隔符</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">paste file1 file2</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">结果显示：</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># paste file1 file2</span></span><br><span class="line">file1的第一行内容       file2的第一行内容</span><br><span class="line">file1的第二行内容       file2的第二行内容</span><br><span class="line">        file2的第三行内容</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><strong>7.2.1 以 ： 作为分隔符</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">paste -d &#x27;:&#x27; file1 file2</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">结果显示：</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># paste -d &#x27;:&#x27; file1 file2</span></span><br><span class="line">file1的第一行内容:file2的第一行内容</span><br><span class="line">file1的第二行内容:file2的第二行内容</span><br><span class="line">:file2的第三行内容</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><strong>7.2.2 串行合并</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">paste <span class="literal">-d</span> <span class="string">&#x27;:&#x27;</span> <span class="literal">-s</span> file1 file2</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">结果显示：</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># paste -d &#x27;:&#x27; -s file1 file2</span></span><br><span class="line">file1的第一行内容:file1的第二行内容</span><br><span class="line">file2的第一行内容:file2的第二行内容:file2的第三行内容</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment">#</span></span><br></pre></td></tr></table></figure><h4 id="tr-用法"><a href="#tr-用法" class="headerlink" title="tr 用法"></a>tr 用法</h4><p>用法：tr用于字符转换，替换和删除；主要用于 删除文件中控制字符 或 进行字符转换</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、命令的执行结果交给tr处理，其中string1用于查询，string2用于转换处理</span><br><span class="line">commands|tr  <span class="string">&#x27;string1&#x27;</span>  <span class="string">&#x27;string2&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、tr处理的内容来自文件，记住要使用<span class="string">&quot;&lt;&quot;</span>标准输入</span><br><span class="line">tr  <span class="string">&#x27;string1&#x27;</span>  <span class="string">&#x27;string2&#x27;</span> &lt; filename</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、匹配string1进行相应操作，如删除操作</span><br><span class="line">tr [<span class="type">options</span>] <span class="string">&#x27;string1&#x27;</span> &lt; filename</span><br></pre></td></tr></table></figure><p><strong>8.1 常见选项</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">-d</span>：删除字符串<span class="number">1</span>中所有输入字符。</span><br><span class="line"><span class="literal">-s</span>：删除所有重复出现字符序列，只保留第一个；即将重复出现字符串压缩为一个字符串</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a<span class="literal">-z</span> 或 [:<span class="type">lower</span>:] : 匹配所有小写字母    </span><br><span class="line">A<span class="literal">-Z</span> 或 [:<span class="type">upper</span>:] : 匹配所有大写字母    </span><br><span class="line"><span class="number">0</span><span class="literal">-9</span> 或 [:<span class="type">digit</span>:] : 匹配所有数字      </span><br><span class="line">[<span class="type">a</span>-<span class="type">zA</span>-<span class="type">Z0</span>-<span class="number">9</span>] : 所有大小写和数字</span><br><span class="line">[:<span class="type">alnum</span>:] : 匹配所有字母和数字   </span><br><span class="line">[:<span class="type">alpha</span>:] : 匹配所有字母        </span><br><span class="line">[:<span class="type">blank</span>:] : 所有水平空白       </span><br><span class="line">[:<span class="type">punct</span>:] : 匹配所有标点符号    </span><br><span class="line">[:<span class="type">space</span>:] : 所有水平或垂直的空格 </span><br><span class="line">[:<span class="type">cntrl</span>:] : 匹配所有的控制字符如：\f 走行换页   \n 换行    \r 回车     \t tab键</span><br></pre></td></tr></table></figure><p><strong>8.2需求</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /etc/passwd .</span><br><span class="line"><span class="number">1</span>.找到文件中所有的小写字母替换为大写字母</span><br><span class="line"><span class="built_in">cat</span> passwd | tr <span class="string">&#x27;a-z&#x27;</span> <span class="string">&#x27;A-Z&#x27;</span></span><br><span class="line">tr <span class="string">&#x27;[:lower:]&#x27;</span> <span class="string">&#x27;[:upper:]&#x27;</span> &lt; passwd</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.找到文件中所有的数字替换成为 <span class="selector-tag">@</span></span><br><span class="line"><span class="built_in">cat</span> passwd | tr <span class="string">&#x27;0-9&#x27;</span> <span class="string">&#x27;@&#x27;</span></span><br><span class="line">tr <span class="string">&#x27;[:digit:]&#x27;</span> <span class="string">&#x27;@&#x27;</span> &lt; passwd</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.找到文件中的所有的 ： 和 / 替换为 <span class="comment">#</span></span><br><span class="line"><span class="built_in">cat</span> passwd | tr <span class="string">&#x27;:/&#x27;</span> <span class="string">&#x27;#&#x27;</span> </span><br><span class="line">tr <span class="string">&#x27;:/&#x27;</span> <span class="string">&#x27;#&#x27;</span> &lt; passwd</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>.删除文件中的所有小写字母</span><br><span class="line"><span class="built_in">cat</span> passwd | tr <span class="literal">-d</span> <span class="string">&#x27;a-z&#x27;</span> </span><br><span class="line">tr <span class="literal">-d</span> <span class="string">&#x27;[:lower:]&#x27;</span> &lt; passwd</span><br><span class="line"></span><br><span class="line"><span class="number">6</span>.查看系统的内置模块，并且按照模块的大小进行升序排列</span><br><span class="line">lsmod | tr <span class="literal">-s</span> <span class="string">&#x27; &#x27;</span> | <span class="built_in">sort</span> <span class="literal">-n</span> <span class="literal">-t</span> <span class="string">&#x27; &#x27;</span> <span class="literal">-k</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="number">7</span>.查看本机网卡 ens33 的 IP,NETMASK,BROADCAST 并存储到net_conf</span><br><span class="line">ifconfig ens33 | grep <span class="string">&#x27;netmask&#x27;</span> | tr <span class="literal">-s</span> <span class="string">&#x27; &#x27;</span> | cut <span class="literal">-d</span> <span class="string">&#x27; &#x27;</span> <span class="operator">-f</span> <span class="number">2</span><span class="literal">-7</span> | tr <span class="string">&#x27; &#x27;</span> <span class="string">&#x27;\n&#x27;</span> | <span class="built_in">tee</span> net_conf</span><br></pre></td></tr></table></figure><h2 id="bash-特性"><a href="#bash-特性" class="headerlink" title="bash 特性"></a>bash 特性</h2><h4 id="命令和文件自动补全"><a href="#命令和文件自动补全" class="headerlink" title="命令和文件自动补全"></a>命令和文件自动补全</h4><p>Tab只能补全 命令 和 文件</p><p><strong>1.1 常见的快捷键</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">^c   			终止前台运行的程序</span><br><span class="line">^z	  			将前台运行的程序挂起到后台</span><br><span class="line">^d   			退出 等价<span class="keyword">exit</span></span><br><span class="line">^l 或 <span class="built_in">clear</span>	   清屏 </span><br><span class="line">^a |home  	    光标移到命令行的最前端</span><br><span class="line">^e |<span class="keyword">end</span>  	    光标移到命令行的后端</span><br><span class="line">^u   			删除光标前所有字符</span><br><span class="line">^k   			删除光标后所有字符</span><br><span class="line">^r	 			搜索历史命令</span><br></pre></td></tr></table></figure><p><strong>1.2 常用的通配符（重点）</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">* :	匹配<span class="number">0</span>或多个任意字符</span><br><span class="line">? :	匹配任意单个字符</span><br><span class="line">[<span class="type">list</span>] :	匹配[<span class="type">list</span>]中的任意单个字符,或者一组单个字符   [<span class="type">a</span>-<span class="type">z</span>]</span><br><span class="line">[!<span class="type">list</span>] :   匹配除list中的任意单个字符</span><br><span class="line">&#123;string1,string2,...&#125; ：匹配string1,string2或更多字符串</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># rm -f file*</span></span><br><span class="line"><span class="comment"># cp *.conf  /dir1</span></span><br><span class="line"><span class="comment"># touch file&#123;1..5&#125;</span></span><br></pre></td></tr></table></figure><p><strong>1.3 bash中的引号（重点）</strong></p><ul><li>双引号”” :会把引号的内容当成整体来看待，允许通过$符号引用其他变量值</li><li>单引号’’ :会把引号的内容当成整体来看待，禁止引用其他变量值，shell中特殊符号都被视为普通字符</li><li>反撇号`` :反撇号和$()一样，引号或括号里的命令会优先执行，如果存在嵌套，反撇号不能用</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.把 passwd 文件做备份，要求看出备份的日期</span><br><span class="line"><span class="built_in">cp</span> /etc/passwd ./passwd_`date +%F_%<span class="built_in">H</span>:%M:%S`.bak</span><br><span class="line"><span class="built_in">cp</span> /etc/passwd ./passwd_<span class="variable">$</span>(date +%F_%<span class="built_in">H</span>:%M:%S).bak</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># ls</span></span><br><span class="line">passwd_2022<span class="literal">-07-04_17</span>:<span class="number">31</span>:<span class="number">00</span>.bak  passwd_2022<span class="literal">-07-04_17</span>:<span class="number">31</span>:<span class="number">28</span>.bak</span><br></pre></td></tr></table></figure><h2 id="shell-初识"><a href="#shell-初识" class="headerlink" title="shell 初识"></a>shell 初识</h2><h4 id="第一个shll-脚本"><a href="#第一个shll-脚本" class="headerlink" title="第一个shll 脚本"></a>第一个shll 脚本</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#！/bin/env bash</span></span><br><span class="line"><span class="comment">######################################################</span></span><br><span class="line"><span class="comment"># Name    : first_shell.sh                           #</span></span><br><span class="line"><span class="comment"># Desc    : OUPUT HELLO WORLD                        #</span></span><br><span class="line"><span class="comment"># Path    : /root/test/first_shell.sh                #</span></span><br><span class="line"><span class="comment"># Auther  : Jermyn                                   #</span></span><br><span class="line"><span class="comment"># Date    : 2022-07-04                               #</span></span><br><span class="line"><span class="comment"># Version : 1.0                                      #</span></span><br><span class="line"><span class="comment">######################################################</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;HELLO WORLD!!!!&quot;</span></span><br></pre></td></tr></table></figure><p><strong>1.1 执行方式</strong></p><p><strong>1.1.1 标准执行（必须有可执行权限）</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">给执行的脚本添加一个可执行的权限！后面加脚本的相对路径或者绝对路径</span><br><span class="line">chmod +x first_shell.sh  </span><br><span class="line">./first_shell.sh</span><br><span class="line"></span><br><span class="line">/root/test/first_shell.sh</span><br></pre></td></tr></table></figure><p><strong>1.1.2 在命令行指定解释器执行（可以没有可执行权限）</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">bash first_shell.sh</span><br><span class="line"></span><br><span class="line">sh first_shell.sh</span><br><span class="line"></span><br><span class="line"><span class="literal">------------------------------</span></span><br><span class="line"><span class="literal">-x</span>:一般用于排错，查看脚本的执行过程</span><br><span class="line"><span class="literal">-n</span>:用来查看脚本的语法是否有问题</span><br><span class="line"><span class="literal">------------------------------</span></span><br><span class="line"></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># bash -x first_shell.sh</span></span><br><span class="line">+ <span class="built_in">echo</span> <span class="string">&#x27;HELLO WORLD!!!!&#x27;</span></span><br><span class="line">HELLO WORLD!!!!</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># bash -n first_shell.sh</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><strong>1.1.3 source 重新读取文件的内容（可以没有可执行权限）</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source first_shell.sh</span><br></pre></td></tr></table></figure><h4 id="写一个-shell-脚本"><a href="#写一个-shell-脚本" class="headerlink" title="写一个 shell 脚本"></a>写一个 shell 脚本</h4><p>需求：拷贝 /etc/passwd 的内容到 /test 目录下，拷贝文件的命名需要显示时间，运行此脚本的时候显示运行脚本的时间</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">vim cp_passwd.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#！/bin/env bash</span></span><br><span class="line"><span class="comment">######################################################</span></span><br><span class="line"><span class="comment"># Name    : cp_passwd.sh                             #</span></span><br><span class="line"><span class="comment"># Desc    : COPY PASSWD                              #</span></span><br><span class="line"><span class="comment"># Path    : /root/testcp_passwd.sh                   #</span></span><br><span class="line"><span class="comment"># Auther  : Jermyn                                   #</span></span><br><span class="line"><span class="comment"># Date    : 2022-07-04                               #</span></span><br><span class="line"><span class="comment"># Version : 1.0                                      #</span></span><br><span class="line"><span class="comment">######################################################</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cp</span> /etc/passwd /root/test/passwd_<span class="variable">$</span>(date +%F_%<span class="built_in">H</span>:%M:%S).bak</span><br><span class="line"><span class="built_in">echo</span> <span class="literal">-e</span> <span class="string">&quot;\033[32m --------------------------------------------------- \033[0m&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="literal">-e</span> <span class="string">&quot;\033[32m 您运行此脚本的时间是<span class="variable">$</span>(date +%F_%H:%M:%S)！！！ \033[0m&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="literal">-e</span> <span class="string">&quot;\033[32m --------------------------------------------------- \033[0m&quot;</span></span><br><span class="line"><span class="built_in">ls</span></span><br></pre></td></tr></table></figure><h2 id="变量的定义"><a href="#变量的定义" class="headerlink" title="变量的定义"></a>变量的定义</h2><p>变量：变量是用来临时保存数据的，该数据是可以变化的数据。</p><h4 id="定义变量"><a href="#定义变量" class="headerlink" title="定义变量"></a>定义变量</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">变量名=变量值</span><br><span class="line"></span><br><span class="line">变量名：用来临时保存数据的</span><br><span class="line">变量值：就是临时的可变化的数据</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">定义变量，调用变量</span></span><br><span class="line">A=25</span><br><span class="line">echo &quot;$&#123;A&#125;&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">取消变量</span></span><br><span class="line">unset A</span><br><span class="line">echo &quot;$&#123;A&#125;&quot;</span><br></pre></td></tr></table></figure><h4 id="变量名定义规则"><a href="#变量名定义规则" class="headerlink" title="变量名定义规则"></a>变量名定义规则</h4><p><strong>2.1 变量名严格区分大小写</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">A=hello</span><br><span class="line">a=world</span><br><span class="line"></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># echo &quot;$&#123;A&#125;&quot;</span></span><br><span class="line">hello</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># echo &quot;$&#123;a&#125;&quot;</span></span><br><span class="line">world</span><br></pre></td></tr></table></figure><p><strong>2.2 变量名不能有特殊符号</strong></p><p>命名要求：命名只能使用英文字母，数字和下划线，<strong>首个字符不能以数字开头</strong>。 中间<strong>不能有空格</strong>，可以使用下划线（_）。<strong>不能使用标点符号</strong>。 <strong>不能使用bash里的关键字</strong>（可用help命令查看保留关键字）。</p><blockquote><p>注：对于有空格的字符串给变量赋值时，要用引号引起来</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A=&quot;hello world&quot;</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th style="text-align:center">合法变量</th><th style="text-align:center">非法变量</th></tr></thead><tbody><tr><td style="text-align:center">A=10</td><td style="text-align:center">\t=10</td></tr><tr><td style="text-align:center">a=10</td><td style="text-align:center">*a=10</td></tr><tr><td style="text-align:center">A_A=10</td><td style="text-align:center">5=10</td></tr><tr><td style="text-align:center">A_=10</td><td style="text-align:center">A =10</td></tr><tr><td style="text-align:center">a_=10</td><td style="text-align:center">A-=10</td></tr><tr><td style="text-align:center">_a=10</td><td style="text-align:center">A A=10</td></tr><tr><td style="text-align:center">_A=10</td><td style="text-align:center">5A=10</td></tr><tr><td style="text-align:center">ABC=10</td><td style="text-align:center">A = 10</td></tr><tr><td style="text-align:center">a</td><td style="text-align:center">A=hello world</td></tr><tr><td style="text-align:center">A<em>_</em>=10</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">………</td><td style="text-align:center">……….</td></tr></tbody></table></div><blockquote><p><strong>变量名最好做到见名知意</strong></p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">好的变量名：</span><br><span class="line">IPADDR=<span class="number">192.168</span>.<span class="number">0.0</span></span><br><span class="line"><span class="built_in">DIR</span>=/export/server</span><br><span class="line">TMP_FILE=/var/log/<span class="number">1</span>.log</span><br><span class="line">.......</span><br></pre></td></tr></table></figure><h4 id="变量名的定义方式"><a href="#变量名的定义方式" class="headerlink" title="变量名的定义方式"></a>变量名的定义方式</h4><p><strong>3.1 基本方式</strong></p><p>直接赋值</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># A=1234567</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># echo $&#123;A:2:4&#125;</span></span><br><span class="line"><span class="number">3456</span>		表示从A变量中第<span class="number">3</span>个字符开始截取，截取<span class="number">4</span>个字符</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">说明：</span><br><span class="line"><span class="variable">$</span>变量名 和 <span class="variable">$</span>&#123;变量名&#125;的异同</span><br><span class="line">相同点：都可以调用变量</span><br><span class="line">不同点：<span class="variable">$</span>&#123;变量名&#125;可以只截取变量的一部分，而<span class="variable">$</span>变量名不可以</span><br></pre></td></tr></table></figure><p><strong>3.2 命令执行结果赋值给变量</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.时间</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># TIME=&quot;$(date +%F_%T)&quot;</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># echo &quot;$&#123;TIME&#125;&quot;</span></span><br><span class="line"><span class="number">2022</span><span class="literal">-07-04_21</span>:<span class="number">21</span>:<span class="number">51</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.主机名</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># HOSTNAME=&quot;$(hostname)&quot;</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># echo &quot;$&#123;HOSTNAME&#125;&quot;</span></span><br><span class="line">master</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.内核版本</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># c=&quot;$(uname -r)&quot;</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># echo &quot;$&#123;c&#125;&quot;</span></span><br><span class="line"><span class="number">3.10</span>.<span class="number">0</span><span class="literal">-1160</span>.el7.x86_64</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="number">4</span>.系统版本</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># a=&quot;$(cat /etc/redhat-release)&quot;</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># echo &quot;$&#123;a&#125;&quot;</span></span><br><span class="line">CentOS Linux release <span class="number">7.9</span>.<span class="number">2009</span> (Core)</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><strong>3.3 交互式变量</strong></p><p>目的：让 用户自己 给变量赋值，比较灵活。</p><p>语法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">read [选项] 变量名</span><br></pre></td></tr></table></figure><p><strong>3.3.1 常见选项</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">-p</span>  : 定义提示用户的信息                                         </span><br><span class="line"><span class="literal">-n</span>  : 定义字符数（限制变量值的长度）                             </span><br><span class="line"><span class="literal">-s</span>  : 不显示（不显示用户输入的内容）                             </span><br><span class="line"><span class="literal">-t</span>  : 定义超时时间，默认单位为秒（限制用户输入变量值的超时时间） </span><br></pre></td></tr></table></figure><p><strong>3.3.2 例子</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.默认</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># read name</span></span><br><span class="line">Jermyn</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># echo &quot;$&#123;name&#125;&quot;</span></span><br><span class="line">Jermyn</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.提示</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># read -p &quot;请输入您的姓名：&quot; name</span></span><br><span class="line">请输入您的姓名：Jermyn</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># echo &quot;$&#123;name&#125;&quot;</span></span><br><span class="line">Jermyn</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.不显示</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># read -s passwd</span></span><br><span class="line"><span class="comment"># 输入不显示</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># echo &quot;$&#123;passwd&#125;&quot;</span></span><br><span class="line"><span class="number">123456</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="number">4</span>.定义时间</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># read -t 5 passwd</span></span><br><span class="line"><span class="comment"># 5秒后自动跳转 或者 输入回车后跳转</span></span><br><span class="line"><span class="number">123456</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># echo &quot;$&#123;passwd&#125;&quot;</span></span><br><span class="line"><span class="number">123456</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span>.定义字符数</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># read -n 5 -p &quot;Please input your name:&quot; name</span></span><br><span class="line">Please input your name:Jermy（字符超过<span class="number">5</span>个的时候自动跳转）(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">注：read <span class="literal">-s</span> <span class="literal">-p</span> <span class="string">&quot;&quot;</span>   <span class="literal">-p</span>后面跟内容  不可写作  read <span class="literal">-p</span> <span class="literal">-s</span> <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure><blockquote><p>变量值还以来自于文件</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># echo &quot;192.168.0.0 255.255.255.0&quot; &gt; net_conf</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment">#</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># read IPADDR NETMASK &lt; net_conf</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># echo &quot;$&#123;IPADDR&#125;&quot;</span></span><br><span class="line"><span class="number">192.168</span>.<span class="number">0.0</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment"># echo &quot;$&#123;NETMASK&#125;&quot;</span></span><br><span class="line"><span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">test</span>]<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><strong>3.4 定义有类型的变量</strong></p><p>目的： 给变量做一些限制，固定变量的类型，比如：整型、只读</p><p>用法：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">declare 选项 变量名=变量值</span><br></pre></td></tr></table></figure><p><strong>3.4.1 常用选项</strong></p><div class="table-container"><table><thead><tr><th>选项</th><th>释义</th><th>举例</th></tr></thead><tbody><tr><td>-i</td><td>将变量看成整数（只可赋值整数，其他数据类型为0）</td><td>declare -i A=123</td></tr><tr><td>-r</td><td>定义只读变量(不可重新赋值，不可 unset )</td><td>declare -r B=hello</td></tr><tr><td>-a</td><td>定义普通数组；查看普通数组</td><td></td></tr><tr><td>-A</td><td>定义关联数组；查看关联数组</td><td></td></tr><tr><td>-x</td><td>将变量通过环境导出</td><td>declare -x AAA=123456 等于 export AAA=123456</td></tr></tbody></table></div><h4 id="变量的分类"><a href="#变量的分类" class="headerlink" title="变量的分类"></a>变量的分类</h4><p><strong>4.1 本地变量</strong></p><ul><li>当前用户自定义的变量。当前进程中有效，其他进程及当前进程的子进程无效。</li></ul><p><strong>4.2 环境变量</strong></p><ul><li><p><strong>当前进程</strong>有效，并且能够被<strong>子进程</strong>调用。</p><ul><li><code>env</code> 查看当前用户的环境变量</li><li><code>set</code> 查询当前用户的所有变量(临时变量与环境变量)</li><li><code>export 变量名=变量值</code> 或者 <code>变量名=变量值；export 变量名</code></li></ul></li><li><p>定义一个环境变量</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.直接定义</span><br><span class="line">declare <span class="literal">-x</span> NAME=Jermyn</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.定义一个本地变量，转换为环境变量</span><br><span class="line">NAME=Jermyn</span><br><span class="line">export NAME</span><br><span class="line"></span><br><span class="line">export NAME=Jermyn</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.想要当前登陆的用户生效的话，修改/root/.bashrc 文件内容</span><br><span class="line">vim /root/.bashrc</span><br><span class="line">export NAME=Jermyn</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.永久生效，配置 profile 文件</span><br><span class="line">vim /etc/profile</span><br><span class="line">export NAME=Jermyn</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>.配置 HADOOP 的环境变量</span><br><span class="line"><span class="comment"># hadoop 环境变量</span></span><br><span class="line">export HADOOP_HOME=/export/server/hadoop<span class="literal">-3</span>.<span class="number">3.0</span></span><br><span class="line">export PATH=<span class="variable">$PATH:</span><span class="variable">$HADOOP_HOME</span>/bin:<span class="variable">$HADOOP_HOME</span>/sbin</span><br></pre></td></tr></table></figure></li></ul><p><strong>4.3 全局变量</strong></p><p>全局所有的用户和程序都能调用，且继承，新建的用户也默认能调用。</p><p><strong>4.3.1 配置文件</strong></p><div class="table-container"><table><thead><tr><th style="text-align:center">文件名</th><th style="text-align:center">说明</th><th style="text-align:center">备注</th></tr></thead><tbody><tr><td style="text-align:center">$HOME/.bashrc</td><td style="text-align:center">当前用户的bash信息,用户登录时读取</td><td style="text-align:center">定义别名、umask、函数等</td></tr><tr><td style="text-align:center">$HOME/.bash_profile</td><td style="text-align:center">当前用户的环境变量，用户登录时读取</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$HOME/.bash_logout</td><td style="text-align:center">当前 用户退出 当前shell时最后读取</td><td style="text-align:center">定义用户退出时执行的程序等</td></tr><tr><td style="text-align:center">/etc/bashrc</td><td style="text-align:center">全局的bash信息，所有用户都生效</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">/etc/profile</td><td style="text-align:center">全局环境变量信息</td><td style="text-align:center">系统和所有用户都生效</td></tr><tr><td style="text-align:center">$HOME/.bash_history</td><td style="text-align:center">用户的历史命令</td><td style="text-align:center">history -w 保存历史记录 history -c 清空历史记录</td></tr></tbody></table></div><blockquote><p><strong>注：修改后都需要 source 执行，重现加载环境变量才可以生效</strong></p></blockquote><p><strong>4.3.2 用户登录系统读取相关文件的顺序</strong></p><ol><li><code>/etc/profile</code></li><li><code>$HOME/.bash_profile</code></li><li><code>$HOME/.bashrc</code></li><li><code>/etc/bashrc</code></li><li><code>$HOME/.bash_logout</code></li></ol><p><strong>4.4 系统变量</strong></p><p>shell本身已经固定好了它的名字和作用.</p><div class="table-container"><table><thead><tr><th>内置变量</th><th>含义</th></tr></thead><tbody><tr><td>$?</td><td>上一条命令执行后返回的状态；状态值为<strong>0表示执行正常</strong>，<strong>非0表示执行异常</strong>或错误</td></tr><tr><td>$0</td><td>当前执行的程序或脚本名</td></tr><tr><td>$#</td><td>脚本后面接的<strong>参数的个数</strong></td></tr><tr><td>$*</td><td>脚本后面<strong>所有参数</strong>，参数当成一个整体输出，每一个变量参数之间以空格隔开</td></tr><tr><td>$@</td><td>脚本后面所有参数，参数是独立的，也是全部输出</td></tr><tr><td>$1~$9</td><td>脚本后面的位置参数，$1表示第1个位置参数，依次类推</td></tr><tr><td>${10}~${n}</td><td>扩展位置参数,第10个位置变量必须用{}大括号括起来(2位数字以上扩起来)</td></tr><tr><td>$$</td><td>当前所在进程的进程号，如<code>echo $$</code></td></tr><tr><td>$！</td><td>后台运行的最后一个进程号 (当前终端）</td></tr><tr><td>!$</td><td>调用最后一条命令历史中的参数</td></tr></tbody></table></div><blockquote><p>区分 $* 和 $@ 的区别</p><p><code>$*</code>：表示将变量看成一个整体<br><code>$@</code>：表示变量是独立的</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">例子：</span><br><span class="line">运行 ./demo.sh <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="variable">$</span>* 是指 <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="variable">$</span><span class="selector-tag">@</span> 是指 <span class="number">1</span></span><br><span class="line">       <span class="number">2</span></span><br><span class="line">       <span class="number">3</span></span><br></pre></td></tr></table></figure><h2 id="简单的四则运算"><a href="#简单的四则运算" class="headerlink" title="简单的四则运算"></a>简单的四则运算</h2><p>算数运算：默认情况下，只支持简单的整数运算</p><p>算数内容：加（+），减（-），乘（*），除（/），取余（%）</p><h4 id="四则运算符号"><a href="#四则运算符号" class="headerlink" title="四则运算符号"></a>四则运算符号</h4><div class="table-container"><table><thead><tr><th style="text-align:center">表达式</th><th style="text-align:center">举例</th></tr></thead><tbody><tr><td style="text-align:center">$(())</td><td style="text-align:center">echo “$((1+1))”</td></tr><tr><td style="text-align:center">$[]</td><td style="text-align:center">echo “$[1+1]”；</td></tr><tr><td style="text-align:center">expr</td><td style="text-align:center">expr 1 + 1 (<strong>必须有空格</strong>)；expr 10 * 5（<strong>* 需要转义</strong>）；expr 5 % 10 <strong>注：不可求次幂</strong></td></tr><tr><td style="text-align:center">let</td><td style="text-align:center">n=1;let n+=1;echo “${n}”</td></tr></tbody></table></div><blockquote><p>默认支持整数运算，特殊支持小数</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># echo 1+1.5|bc</span></span><br><span class="line"><span class="number">2.5</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># bc</span></span><br><span class="line">bc <span class="number">1.06</span>.<span class="number">95</span></span><br><span class="line">Copyright <span class="number">1991</span><span class="literal">-1994</span>, <span class="number">1997</span>, <span class="number">1998</span>, <span class="number">2000</span>, <span class="number">2004</span>, <span class="number">2006</span> Free Software Foundation, Inc.</span><br><span class="line">This is free software with ABSOLUTELY NO WARRANTY.</span><br><span class="line"><span class="keyword">For</span> details <span class="built_in">type</span> `warranty<span class="string">&#x27;.</span></span><br><span class="line"><span class="string">1+1.5</span></span><br><span class="line"><span class="string">2.5</span></span><br></pre></td></tr></table></figure></blockquote><h4 id="i-和-i"><a href="#i-和-i" class="headerlink" title="i++ 和 ++i"></a>i++ 和 ++i</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">i++ ：先赋值，在计算</span><br><span class="line">++i ：先计算，在赋值</span><br></pre></td></tr></table></figure><h4 id="数组定义"><a href="#数组定义" class="headerlink" title="数组定义"></a>数组定义</h4><p><strong>3.1 数组分类</strong></p><ul><li><p>普通数组：只能使用整数作为数组索引(元素的下标)</p></li><li><p>关联数组：可以使用字符串作为数组索引(元素的下标)（类似：K,V）</p></li></ul><p><strong>3.2 普通数组定义</strong></p><ul><li>一次赋予一个值</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">数组名[索引下标]=值</span><br><span class="line"></span><br><span class="line">array[<span class="number">0</span>]=v1</span><br><span class="line">array[<span class="number">1</span>]=v2</span><br><span class="line">array[<span class="number">2</span>]=v3</span><br><span class="line">array[<span class="number">3</span>]=v4</span><br></pre></td></tr></table></figure><ul><li>一次赋予多个值</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">数组名=(值<span class="number">1</span> 值<span class="number">2</span> 值<span class="number">3</span> ...)</span><br><span class="line"></span><br><span class="line">array=(var1 var2 var3 var4)</span><br><span class="line"></span><br><span class="line">array1=(`cat /etc/passwd`)			将文件中每一行赋值给array1数组</span><br><span class="line"></span><br><span class="line">array2=(`ls /root`)</span><br><span class="line"></span><br><span class="line">array3=(harry amy jack <span class="string">&quot;Miss Hou&quot;</span>)</span><br><span class="line"></span><br><span class="line">array4=(<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="string">&quot;hello world&quot;</span> [<span class="number">10</span>]=linux)</span><br></pre></td></tr></table></figure><p><strong>3.3 数组的读取</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="variable">$</span>&#123;数组名[元素下标]&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$</span>&#123;array[<span class="number">0</span>]&#125;			获取数组里第一个元素</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$</span>&#123;array[*]&#125;			获取数组里的所有元素</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$</span>&#123;<span class="comment">#array[*]&#125;			获取数组里所有元素个数</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$</span>&#123;!array[<span class="selector-tag">@</span>]&#125;    	获取数组元素的索引下标</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$</span>&#123;array[<span class="selector-tag">@</span>]:<span class="number">1</span>:<span class="number">2</span>&#125;    访问指定的元素；<span class="number">1</span>代表从下标为<span class="number">1</span>的元素开始获取；<span class="number">2</span>代表获取后面几个元素</span><br><span class="line"></span><br><span class="line">查看普通数组信息：</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># declare -a</span></span><br></pre></td></tr></table></figure><p><strong>3.4 关联数组定义</strong></p><ul><li>首先声明关联数组</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">declare <span class="literal">-A</span> asso_array1</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">declare <span class="literal">-A</span> asso_array1</span><br><span class="line">declare <span class="literal">-A</span> asso_array2</span><br><span class="line">declare <span class="literal">-A</span> asso_array3</span><br></pre></td></tr></table></figure><ul><li><p>数组赋值</p><ul><li><p>一次赋一个值</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">数组名[索引<span class="type">or</span>下标]=变量值</span><br><span class="line"></span><br><span class="line"><span class="comment"># asso_array1[linux]=one</span></span><br><span class="line"><span class="comment"># asso_array1[java]=two</span></span><br><span class="line"><span class="comment"># asso_array1[php]=three</span></span><br></pre></td></tr></table></figure></li><li><p>一次赋多个值</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># asso_array2=([name1]=harry [name2]=jack [name3]=amy [name4]=&quot;Jermyn&quot;)</span><br></pre></td></tr></table></figure></li></ul></li><li><p>查看关联数组</p></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># declare -A</span></span><br><span class="line">declare <span class="literal">-A</span> asso_array1=<span class="string">&#x27;([php]=&quot;three&quot; [java]=&quot;two&quot; [linux]=&quot;one&quot; )&#x27;</span></span><br><span class="line">declare <span class="literal">-A</span> asso_array2=<span class="string">&#x27;([name3]=&quot;amy&quot; [name2]=&quot;jack&quot; [name1]=&quot;harry&quot; [name4]=&quot;Jermyn&quot; )&#x27;</span></span><br></pre></td></tr></table></figure><ul><li>获取关联数组值</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># echo $&#123;asso_array1[linux]&#125;</span></span><br><span class="line">one</span><br><span class="line"><span class="comment"># echo $&#123;asso_array1[php]&#125;</span></span><br><span class="line">three</span><br><span class="line"><span class="comment"># echo $&#123;asso_array1[*]&#125;</span></span><br><span class="line">three two one</span><br><span class="line"><span class="comment"># echo $&#123;!asso_array1[*]&#125;</span></span><br><span class="line">php java linux</span><br><span class="line"><span class="comment"># echo $&#123;#asso_array1[*]&#125;</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="comment"># echo $&#123;#asso_array2[*]&#125;</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="comment"># echo $&#123;!asso_array2[*]&#125;</span></span><br><span class="line">name3 name2 name1 name4</span><br></pre></td></tr></table></figure><p><strong>3.5 其他变量定义</strong></p><ul><li>取出一个目录下的目录和文件：<code>dirname</code>和 <code>basename</code></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># A=/root/test/shell_scripts/cp_passwd.sh</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># echo &quot;$&#123;A&#125;&quot;</span></span><br><span class="line">/root/test/shell_scripts/cp_passwd.sh</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># dirname $&#123;A&#125;</span></span><br><span class="line">/root/test/shell_scripts</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># basename $&#123;A&#125;</span></span><br><span class="line">cp_passwd.sh</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment">#</span></span><br></pre></td></tr></table></figure><ul><li>变量”内容”的删除和替换</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">一个“%”代表从右往左删除</span><br><span class="line">两个“%%”代表从右往左去掉最多</span><br><span class="line">一个“<span class="comment">#”代表从左往右去掉删除</span></span><br><span class="line">两个“<span class="comment">##”代表从左往右去掉最多</span></span><br><span class="line"></span><br><span class="line">举例说明：</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># url=www.taobao.com</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># echo $&#123;#url&#125;       查看字符数</span></span><br><span class="line"><span class="number">14</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># echo $&#123;url#*.&#125;     从左到右去掉以 . 分割的www. 保留 taobao.com</span></span><br><span class="line">taobao.com</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># echo $&#123;url#*o&#125;     从左到右去掉以 o 分割的 www.tao 保留 bao.com</span></span><br><span class="line">bao.com</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># echo $&#123;url##*.&#125; </span></span><br><span class="line">com</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># echo $&#123;url##*0&#125;</span></span><br><span class="line">www.taobao.com</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># echo $&#123;url%.*&#125;     从右到左以 . 分割 去掉 .com 保留 www.taobao</span></span><br><span class="line">www.taobao</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># echo $&#123;url%o*&#125;     从右到左以 o 分割 去掉 m 保留 www.taobao.co</span></span><br><span class="line">www.taobao.c</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># echo $&#123;url%%.*&#125;</span></span><br><span class="line">www</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># echo $&#123;url%%o*&#125;</span></span><br><span class="line">www.ta</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure><ul><li>了解</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">替换：/ 和 //</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># echo $&#123;url/ao/AO&#125;    用AO代替ao（从左往右第一个）</span></span><br><span class="line">www.tAObao.com</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># echo $&#123;url//ao/AO&#125;   贪婪替换（替代所有）</span></span><br><span class="line">www.tAObAO.com</span><br></pre></td></tr></table></figure><h2 id="条件判断语句"><a href="#条件判断语句" class="headerlink" title="条件判断语句"></a>条件判断语句</h2><h4 id="条件判断语句-1"><a href="#条件判断语句-1" class="headerlink" title="条件判断语句"></a>条件判断语句</h4><p><strong>1.1 语法格式</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. test 条件表达式</span><br><span class="line"><span class="number">2</span>. [ 条件表达式 ]    注：表达式左右两边都有空格</span><br><span class="line"><span class="number">3</span>. [[ 条件表达式 ]]  注：支持正则，表达式左右两边都有空格</span><br></pre></td></tr></table></figure><h4 id="条件判断相关参数"><a href="#条件判断相关参数" class="headerlink" title="条件判断相关参数"></a>条件判断相关参数</h4><p>判断文件类型，判断文件新旧，判断字符串是否相等，判断权限等等</p><p><strong>2.1 判断文件类型</strong></p><div class="table-container"><table><thead><tr><th style="text-align:center">判断参数</th><th style="text-align:center">含义</th></tr></thead><tbody><tr><td style="text-align:center">-e</td><td style="text-align:center">判断文件<strong>是否存在</strong>（任何类型文件）</td></tr><tr><td style="text-align:center">-f</td><td style="text-align:center">判断文件<strong>是否存在并且是一个普通文件</strong></td></tr><tr><td style="text-align:center">-d</td><td style="text-align:center">判断文件是否存在并且<strong>是一个目录</strong></td></tr><tr><td style="text-align:center">-L</td><td style="text-align:center">判断文件是否存在并且<strong>是一个软连接文件</strong></td></tr><tr><td style="text-align:center">-b</td><td style="text-align:center">判断文件是否存在并且<strong>是一个块设备文件</strong></td></tr><tr><td style="text-align:center">-S</td><td style="text-align:center">判断文件是否存在并且<strong>是一个套接字文件</strong></td></tr><tr><td style="text-align:center">-c</td><td style="text-align:center">判断文件是否存在并且<strong>是一个字符设备文件</strong></td></tr><tr><td style="text-align:center">-p</td><td style="text-align:center">判断文件是否存在并且<strong>是一个命名管道文件</strong></td></tr><tr><td style="text-align:center">-s</td><td style="text-align:center">判断文件是否存在并且<strong>是一个非空文件（有内容）</strong></td></tr></tbody></table></div><p><strong>举例</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">server</span>]<span class="comment"># ls</span></span><br><span class="line">anaconda3                   hbase<span class="literal">-1</span>.<span class="number">2.4</span>       kafka<span class="literal">-eagle</span>                                  spark<span class="literal">-3</span>.<span class="number">2.0</span><span class="literal">-bin-hadoop3</span>.<span class="number">2</span></span><br><span class="line">apache<span class="literal">-zookeeper-3</span>.<span class="number">7.0</span><span class="literal">-bin</span>  jdk               kafka<span class="literal">-eagle-bin-master</span>                       zookeeper</span><br><span class="line"><span class="keyword">data</span>                        jdk1.<span class="number">8.0</span>_241      kafka<span class="literal">-eagle-web-2</span>.<span class="number">0.2</span>                        zookeeper.out</span><br><span class="line">hadoop<span class="literal">-3</span>.<span class="number">3.0</span>                kafka             mysql57<span class="literal">-community-release-el7-10</span>.noarch.rpm</span><br><span class="line">hbase                       kafka_2.<span class="number">11</span><span class="literal">-2</span>.<span class="number">0.0</span>  spark</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">server</span>]<span class="comment"># test -e zookeeper</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">server</span>]<span class="comment"># echo $?</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">server</span>]<span class="comment"># [ -d /export/server/ ]</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">server</span>]<span class="comment"># echo $?</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">server</span>]<span class="comment"># [ ! -d /export/server/ ]</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">server</span>]<span class="comment"># echo $?</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure><p><strong>2.2 判断文件的权限</strong></p><div class="table-container"><table><thead><tr><th style="text-align:center">判断参数</th><th style="text-align:center">含义</th></tr></thead><tbody><tr><td style="text-align:center">-r</td><td style="text-align:center">当前用户对其是否可读</td></tr><tr><td style="text-align:center">-w</td><td style="text-align:center">当前用户对其是否可写</td></tr><tr><td style="text-align:center">-x</td><td style="text-align:center">当前用户对其是否可执行</td></tr><tr><td style="text-align:center">-u</td><td style="text-align:center">是否有suid，高级权限冒险位</td></tr><tr><td style="text-align:center">-g</td><td style="text-align:center">是否sgid，高级权限强制位</td></tr><tr><td style="text-align:center">-k</td><td style="text-align:center">是否有t位，高级权限粘滞位(只有文件的创建者，管理员，root可以删除)</td></tr></tbody></table></div><p><strong>举例</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># ll</span></span><br><span class="line">total <span class="number">8</span></span><br><span class="line"><span class="literal">-rwxr-xr-x</span> <span class="number">1</span> root root  <span class="number">768</span> Jul  <span class="number">4</span> <span class="number">18</span>:<span class="number">49</span> cp_passwd.sh</span><br><span class="line"><span class="literal">-rw-r--r--</span> <span class="number">1</span> root root <span class="number">1679</span> Jul  <span class="number">5</span> <span class="number">16</span>:<span class="number">32</span> font_style.sh</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># [ -x /root/test/shell_scripts/font_style.sh ];echo $?</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># chmod +x font_style.sh</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># ll</span></span><br><span class="line">total <span class="number">8</span></span><br><span class="line"><span class="literal">-rwxr-xr-x</span> <span class="number">1</span> root root  <span class="number">768</span> Jul  <span class="number">4</span> <span class="number">18</span>:<span class="number">49</span> cp_passwd.sh</span><br><span class="line"><span class="literal">-rwxr-xr-x</span> <span class="number">1</span> root root <span class="number">1679</span> Jul  <span class="number">5</span> <span class="number">16</span>:<span class="number">32</span> font_style.sh</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># [ -x /root/test/shell_scripts/font_style.sh ];echo $?</span></span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure><p>2.3 判断文件新旧（修改时间的新旧）**</p><div class="table-container"><table><thead><tr><th style="text-align:center">判断参数</th><th style="text-align:center">含义</th></tr></thead><tbody><tr><td style="text-align:center">file1 -nt file2</td><td style="text-align:center">比较file1是否比file2新</td></tr><tr><td style="text-align:center">file1 -ot file2</td><td style="text-align:center">比较file1是否比file2旧</td></tr><tr><td style="text-align:center">file1 -ef file2</td><td style="text-align:center">比较是否为同一个文件，或者用于判断硬连接，是否指向同一个inode</td></tr></tbody></table></div><p><strong>举例</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># [ cp_passwd.sh -nt font_style.sh ];echo $?</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># [ cp_passwd.sh -ot font_style.sh ];echo $?</span></span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure><p><strong>2.4 判断整数</strong></p><div class="table-container"><table><thead><tr><th style="text-align:center">判断参数</th><th style="text-align:center">含义</th></tr></thead><tbody><tr><td style="text-align:center">-eq</td><td style="text-align:center">相等</td></tr><tr><td style="text-align:center">-ne</td><td style="text-align:center">不等</td></tr><tr><td style="text-align:center">-gt</td><td style="text-align:center">大于</td></tr><tr><td style="text-align:center">-lt</td><td style="text-align:center">小于</td></tr><tr><td style="text-align:center">-ge</td><td style="text-align:center">大于等于</td></tr><tr><td style="text-align:center">-le</td><td style="text-align:center">小于等于</td></tr></tbody></table></div><p><strong>举例</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># [ 1 -eq 2 ];echo $?</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># [ 1=2 ];echo $?</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># [ 1 = 2 ];echo $?    等号左右两边必须有空格</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure><p><strong>2.5 判字符串</strong></p><div class="table-container"><table><thead><tr><th style="text-align:center">判断参数</th><th style="text-align:center">含义</th></tr></thead><tbody><tr><td style="text-align:center">-z</td><td style="text-align:center">判断是否 为空 字符串，字符串长度为0则成立</td></tr><tr><td style="text-align:center">-n</td><td style="text-align:center">判断是否为 非空 字符串，字符串长度不为0则成立</td></tr><tr><td style="text-align:center">string1 = string2</td><td style="text-align:center">判断字符串是否相等</td></tr><tr><td style="text-align:center">string1 != string2</td><td style="text-align:center">判断字符串是否相不等</td></tr></tbody></table></div><p><strong>举例</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># [[ -z &quot;hello world&quot; ]];echo $?</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># [[ -z &quot;     &quot; ]];echo $?     空格也为字符</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># [[ -z &quot;&quot; ]];echo $?</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># [ &quot;hello&quot;=&quot;world&quot; ];echo $?</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># [ &quot;hello&quot; = &quot;world&quot; ];echo $?   等号左右两边必须有空格</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure><p><strong>2.6 多重条件判断</strong></p><div class="table-container"><table><thead><tr><th>判断符号</th><th>含义</th><th>举例</th></tr></thead><tbody><tr><td>-a 和 &amp;&amp;</td><td>逻辑与</td><td>[ 1 -eq 1 -a 1 -ne 0 ] [ 1 -eq 1 ] &amp;&amp; [ 1 -ne 0 ]</td></tr><tr><td>-o 和 \</td><td>\</td><td></td><td>逻辑或</td><td>[ 1 -eq 1 -o 1 -ne 1 ]</td></tr></tbody></table></div><blockquote><p>&amp;&amp; 前面的表达式为真，才会执行后面的代码（1&amp;&amp;1 —&gt;TRUE）</p><p>|| 前面的表达式为假，才会执行后面的代码（1||0—&gt;TRUE）</p><p>; 只用<strong>分割</strong>命令或表达式</p></blockquote><p><strong>举例</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.判断用户是否是 root 用户，是的话打印<span class="string">&quot;THE USER IS ADMIN&quot;</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># [ $(id | cut -c 5) -eq 0 ]&amp;&amp; echo &quot;THE USER IS ADMIN&quot;</span></span><br><span class="line">THE USER IS ADMIN</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># [ $(id -u) -eq 0 ]&amp;&amp; echo &quot;THE USER IS ADMIN&quot;</span></span><br><span class="line">THE USER IS ADMIN</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.是 root 的话打印是管理员，不是的话打印不是</span><br><span class="line">[ <span class="variable">$</span>(<span class="type">id</span> -<span class="type">u</span>) -<span class="type">eq</span> <span class="number">0</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;THE USER IS ADMIN&quot;</span> || <span class="built_in">echo</span> <span class="string">&quot;THE USER IS NOT ADMIN&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># [[ 1 -eq 2 ]] &amp;&amp; echo &quot;AAA&quot; || echo &quot;BBB&quot; &amp;&amp; echo &quot;CCC&quot;</span></span><br><span class="line">BBB</span><br><span class="line">CCC</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># [[ 1 -eq 2 ]] || echo &quot;AAA&quot; || echo &quot;BBB&quot; &amp;&amp; echo &quot;CCC&quot;</span></span><br><span class="line">AAA</span><br><span class="line">CCC</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># [[ 1 -eq 2 ]] || echo &quot;AAA&quot; || echo &quot;BBB&quot; || echo &quot;CCC&quot;</span></span><br><span class="line">AAA</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># [[ 1 -eq 2 ]] || echo &quot;AAA&quot; &amp;&amp; echo &quot;BBB&quot; || echo &quot;CCC&quot;</span></span><br><span class="line">AAA</span><br><span class="line">BBB</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># [[ 1 -eq 2 ]] || echo &quot;AAA&quot; &amp;&amp; echo &quot;BBB&quot; &amp;&amp; echo &quot;CCC&quot;</span></span><br><span class="line">AAA</span><br><span class="line">BBB</span><br><span class="line">CCC</span><br></pre></td></tr></table></figure><ul><li><p>字符串的比较</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">注意：双引号引起来，看作一个整体；= 和 == 在 [ 字符串 ] 比较中都表示判断</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># A=&quot;HELLO&quot;;B=&quot;HELLO&quot;;[[ &quot;$&#123;A&#125;&quot; = &quot;$&#123;B&#125;&quot; ]];echo $?</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># A=&quot;HELLO&quot;;B=&quot;hello&quot;;[[ &quot;$&#123;A&#125;&quot; == &quot;$&#123;B&#125;&quot; ]];echo $?</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure></li></ul><p><strong>2.7 <code>[ 条件 ]</code> 和 <code>[[ 条件 ]]</code> 的区别</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[]和test</span><br><span class="line">两者是一样的，在命令行里test expr和[ expr ]的效果相同。</span><br><span class="line">test的三个基本作用是判断文件、判断字符串、判断整数。支持使用 ”与或非“ 将表达式连接起来。</span><br><span class="line">test中可用的比较运算符只有==和!=，两者都是用于字符串比较的，不可用于整数比较，整数比较只能使用-eq, -gt这种形式。</span><br><span class="line">无论是字符串比较还是整数比较都千万不要使用大于号小于号。当然，如果你实在想用也是可以的，对于字符串比较可以使用尖括号的转义形式， 如果比较&quot;ab&quot;和&quot;bc&quot;：[ ab \&lt; bc ]，结果为真，也就是返回状态为0.</span><br><span class="line"></span><br><span class="line">[[ ]]</span><br><span class="line">这是内置在shell中的一个命令，它就比刚才说的test强大的多了。支持字符串的模式匹配（使用=~操作符时甚至支持shell的正则表达 式）。逻辑组合可以不使用test的-a,-o而使用&amp;&amp; ||。</span><br><span class="line">字符串比较时可以把右边的作为一个模式（这是右边的字符串不加双引号的情况下。如果右边的字符串加了双引号，则认为是一个文本字符串。），而不仅仅是一个字符串，比如[[ hello == hell? ]]，结果为真。</span><br><span class="line">注意：使用[]和[[]]的时候不要吝啬空格，每一项两边都要有空格，[[ 1 == 2 ]]的结果为“假”，但[[ 1==2 ]]的结果为“真”！</span><br><span class="line"></span><br><span class="line">let和(())</span><br><span class="line">两者也是一样的(或者说基本上是一样的，双括号比let稍弱一些)。主要进行算术运算(上面的两个都不行)，也比较适合进 行整数比较，可以直接使用熟悉的&lt;,&gt;等比较运算符。可以直接使用变量名如var而不需要$var这样的形式。支持分号隔开的多个表达式</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1. 首先，尽管很相似，但是从概念上讲，二者是不同层次的东西。</span><br><span class="line">&quot;[[&quot;，是关键字，许多shell(如ash bsh)并不支持这种方式。ksh, bash(据说从2.02起引入对[[的支持)等支持。</span><br><span class="line">&quot;[&quot;是一条命令， 与test等价，大多数shell都支持。在现代的大多数sh实现中，&quot;[&quot;与&quot;test&quot;是内部(builtin)命令，换句话说执行&quot;test&quot;/&quot;[&quot;时不会调用/some/path/to/test这样的外部命令(如果有这样的命令的话)。</span><br><span class="line"></span><br><span class="line">2.[[]]结构比Bash版本的[]更通用。在[[和]]之间的所有的字符都不会被文件扩展或是标记分割，但是会有参数引用和命令替换。</span><br><span class="line">用[[ ... ]]测试结构比用[ ... ]更能防止脚本里的许多逻辑错误。比如说，&amp;&amp;,||,&lt;和&gt;操作符能在一个[[]]测试里通过，但在[]结构会发生错误。</span><br><span class="line"></span><br><span class="line">3.(( ))结构扩展并计算一个算术表达式的值。如果表达式值为0，会返回1或假作为退出状态码。一个非零值的表达式返回一个0或真作为退出状态码。这个结构和先前test命令及[]结构的讨论刚好相反。</span><br><span class="line"></span><br><span class="line">4.[ ... ]为shell命令，所以在其中的表达式应是它的命令行参数，所以串比较操作符&quot;&gt;&quot; 与&quot;&lt;&quot;必须转义，否则就变成IO改向操作符了(请参看上面2中的例子)。在[[中&quot;&lt;&quot;与&quot;&gt;&quot;不需转义；</span><br><span class="line">由于&quot;[[&quot;是关键字，不会做命令行扩展，因而相对的语法就稍严格些。例如</span><br><span class="line">在[ ... ]中可以用引号括起操作符，因为在做命令行扩展时会去掉这些引号，而在[[ ... ]]则不允许这样做。</span><br><span class="line"></span><br><span class="line">5.[[ ... ]]进行算术扩展，而[ ... ]不做</span><br><span class="line"></span><br><span class="line">6.[[ ... &amp;&amp; ... &amp;&amp; ...  ]] 和 [ ... -a ... -a ...] 不一样，[[ ]] 是逻辑短路操作，而 [ ] 不会进行逻辑短路</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> ~]<span class="comment"># [ 1 -eq 0 &amp;&amp; 1 -ne 0 ];echo $?</span></span><br><span class="line"><span class="literal">-bash</span>: [: <span class="type">missing</span> `]<span class="string">&#x27;</span></span><br><span class="line"><span class="string">2</span></span><br><span class="line"><span class="string">(base) [root@master ~]# [ 1 -eq 0 -a 1 -ne 0 ];echo $?</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string">(base) [root@master ~]# [[ 1 -eq 0 &amp;&amp; 1 -ne 0 ]];echo $?</span></span><br><span class="line"><span class="string">1</span></span><br></pre></td></tr></table></figure><h2 id="流程控制语句（if…-）"><a href="#流程控制语句（if…-）" class="headerlink" title="流程控制语句（if….）"></a>流程控制语句（if….）</h2><h4 id="基本语法结构"><a href="#基本语法结构" class="headerlink" title="基本语法结构"></a>基本语法结构</h4><p><strong>1.1 if 结构</strong></p><p>语法：只要满足条件就一直执行</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ <span class="type">condition</span> ];then</span><br><span class="line">		command</span><br><span class="line">		command</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> test 条件;then</span><br><span class="line">	命令</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ 条件 ]];then</span><br><span class="line">	命令</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">[ 条件 ] &amp;&amp; command</span><br></pre></td></tr></table></figure><p><strong>1.2 if…else 结构</strong></p><p>语法：判断是否满足条件，满足走一条，不满足走另一条</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ <span class="type">condition</span> ];then</span><br><span class="line">		command1</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		command2</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">[ 条件 ] &amp;&amp; command1 || command2</span><br></pre></td></tr></table></figure><p><strong>1.3 if…elif…else 结构</strong></p><p>语法：选择的有很多，能走的只有一条</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ <span class="type">condition1</span> ];then</span><br><span class="line">		command1  	</span><br><span class="line">	elif [ <span class="type">condition2</span> ];then</span><br><span class="line">		command2   	</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		command3</span><br><span class="line">fi</span><br><span class="line">注释：</span><br><span class="line">如果条件<span class="number">1</span>满足，执行命令<span class="number">1</span>后结束；如果条件<span class="number">1</span>不满足，再看条件<span class="number">2</span>，如果条件<span class="number">2</span>满足执行命令<span class="number">2</span>后结束；如果条件<span class="number">1</span>和条件<span class="number">2</span>都不满足执行命令<span class="number">3</span>结束.</span><br></pre></td></tr></table></figure><p>例子</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.判断当前主机是否可以连接远程主机</span><br><span class="line"><span class="comment">#!/bin/env bash</span></span><br><span class="line">read <span class="literal">-p</span> <span class="string">&quot;请输入您的 IP 或者 域名：&quot;</span> IP</span><br><span class="line">ping <span class="variable">$</span>&#123;IP&#125; <span class="literal">-c1</span> &gt;/dev/null</span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$</span>? -<span class="type">eq</span> <span class="number">0</span> ]];then</span><br><span class="line">        <span class="built_in">echo</span> <span class="literal">-e</span> <span class="string">&quot;\033[32m 您的主机网络可以与<span class="variable">$</span>&#123;IP&#125;联通. \033[0m&quot;</span></span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="literal">-e</span> <span class="string">&quot;\033[31m 您的主机网路不可以与<span class="variable">$</span>&#123;IP&#125;联通！！！ \033[0m&quot;</span></span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">read <span class="literal">-p</span> <span class="string">&quot;INPUT YOUR IP :&quot;</span> IP ; ping <span class="literal">-c3</span> <span class="variable">$</span>&#123;IP&#125; &gt; /dev/null ; [[ <span class="variable">$</span>? -<span class="type">eq</span> <span class="number">0</span> ]] &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;YOUR NETOWRK IS OK&quot;</span> || <span class="built_in">echo</span> <span class="string">&quot;YOUR NETTWORK IS ERROR&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.判断一个门户网站是否正常</span><br><span class="line">（直接去访问一下，通过访问成功和失败的返回值来判断）</span><br><span class="line"><span class="built_in">wget</span> www.baidu.com   </span><br><span class="line"><span class="built_in">curl</span>  www.baidu.com</span><br><span class="line">elinks <span class="literal">-dump</span> www.baidu.com</span><br><span class="line"></span><br><span class="line">脚本：</span><br><span class="line"><span class="comment">#!/bin/env bash</span></span><br><span class="line">read <span class="literal">-p</span> <span class="string">&quot;Please input your IP or Domain Name:&quot;</span> web_server</span><br><span class="line"></span><br><span class="line"><span class="comment"># wget -P /root/test/index $&#123;web_server&#125; &amp;&gt;/dev/null</span></span><br><span class="line"><span class="built_in">wget</span> <span class="variable">$</span>&#123;web_server&#125; &amp;&gt;/dev/null</span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$</span>? -<span class="type">eq</span> <span class="number">0</span> ];then</span><br><span class="line">        <span class="comment"># Check whether the folder exists. If not, create it</span></span><br><span class="line">        test <span class="literal">-d</span> /root/test/index || mkdir /root/test/index</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Move the build file to index and mark build time.</span></span><br><span class="line">        <span class="built_in">mv</span> ./index.html /root/test/index/index_<span class="variable">$</span>(date +%F_%T).html</span><br><span class="line">        <span class="built_in">echo</span> <span class="literal">-e</span> <span class="string">&quot;\033[32m The current website service is normal \033[0m&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="literal">-e</span> <span class="string">&quot;\033[31m The network service of the current website is abnormal! \033[0m&quot;</span></span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h2 id="条件判断语句（for…-）"><a href="#条件判断语句（for…-）" class="headerlink" title="条件判断语句（for….）"></a>条件判断语句（for….）</h2><h4 id="for循环语法结构"><a href="#for循环语法结构" class="headerlink" title="for循环语法结构"></a>for循环语法结构</h4><p><strong>1.1 列表循环</strong></p><p>语法：用于将一组命令执行<strong>已知的次数</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> variable <span class="keyword">in</span> &#123;list&#125;</span><br><span class="line">     <span class="keyword">do</span></span><br><span class="line">          command </span><br><span class="line">          command</span><br><span class="line">          …</span><br><span class="line">     done</span><br><span class="line">或者</span><br><span class="line"><span class="keyword">for</span> variable <span class="keyword">in</span> a b c</span><br><span class="line">     <span class="keyword">do</span></span><br><span class="line">         command</span><br><span class="line">         command</span><br><span class="line">     done</span><br></pre></td></tr></table></figure><p>例子：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &#123;start，end，step&#125;</span></span><br><span class="line"><span class="number">1</span>.打印<span class="number">0</span><span class="literal">-50</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;<span class="number">0</span>..<span class="number">50</span>&#125;;<span class="keyword">do</span> <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$</span>&#123;i&#125;&quot;</span>;done</span><br><span class="line"><span class="number">2</span>.打印<span class="number">0</span><span class="literal">-50</span>的偶数</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;<span class="number">0</span>..<span class="number">50</span>..<span class="number">2</span>&#125;;<span class="keyword">do</span> <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$</span>&#123;i&#125;&quot;</span>;done</span><br><span class="line"><span class="number">3</span>.打印 <span class="number">10</span><span class="literal">-1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;<span class="number">10</span>..<span class="number">1</span>&#125;;<span class="keyword">do</span> <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$</span>&#123;i&#125;&quot;</span>;done</span><br><span class="line"></span><br><span class="line"><span class="comment"># $(seq start step end)</span></span><br><span class="line"><span class="number">4</span>.打印 <span class="number">1</span><span class="literal">-10</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$</span>(seq <span class="number">10</span>);<span class="keyword">do</span> <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$</span>&#123;i&#125;&quot;</span>;done</span><br><span class="line"><span class="number">5</span>.打印<span class="number">10</span><span class="literal">-1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$</span>(seq <span class="number">10</span> <span class="literal">-1</span> <span class="number">1</span>);<span class="keyword">do</span> <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$</span>&#123;i&#125;&quot;</span>;done</span><br></pre></td></tr></table></figure><p><strong>1.2 不带列表循环</strong></p><p>语法：不带列表的for循环执行时由 用户指定参数和参数的个数</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> variable</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">        command </span><br><span class="line">        command</span><br><span class="line">        …</span><br><span class="line">   done</span><br></pre></td></tr></table></figure><p>例子：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">vim demo.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/bin/env bash </span></span><br><span class="line"><span class="keyword">for</span> i</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$</span>&#123;i&#125;&quot;</span></span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># chmod +x demo.sh &amp;&amp; ./demo.sh a b c</span></span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># chmod +x demo.sh &amp;&amp; ./demo.sh abc</span></span><br><span class="line">abc</span><br><span class="line"></span><br><span class="line">解释：</span><br><span class="line">(base) [<span class="type">root</span>@<span class="type">master</span> <span class="type">shell_scripts</span>]<span class="comment"># bash -x demo.sh a b c</span></span><br><span class="line">+ <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;&quot;$@&quot;&#x27;</span>         <span class="keyword">for</span> i 是 <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;&quot;$@&quot;&#x27;</span>  的省略</span><br><span class="line">+ <span class="built_in">echo</span> a</span><br><span class="line">a</span><br><span class="line">+ <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;&quot;$@&quot;&#x27;</span></span><br><span class="line">+ <span class="built_in">echo</span> b</span><br><span class="line">b</span><br><span class="line">+ <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;&quot;$@&quot;&#x27;</span></span><br><span class="line">+ <span class="built_in">echo</span> c</span><br><span class="line">c</span><br></pre></td></tr></table></figure><p><strong>1.3 案例</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. <span class="number">1</span><span class="literal">-100</span> 的奇数和</span><br><span class="line">vim sum_odd_number.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/bin/env bash</span></span><br><span class="line"></span><br><span class="line">sum=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;<span class="number">1</span>..<span class="number">100</span>..<span class="number">2</span>&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">        sum=<span class="variable">$</span>[ <span class="variable">$sum</span>+<span class="variable">$i</span> ]</span><br><span class="line">done</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;1-100的奇数和是：<span class="variable">$</span>&#123;sum&#125;&quot;</span></span><br></pre></td></tr></table></figure><p><strong>1.4 循环控制语句</strong></p><p><strong>循环体：</strong> do….done之间的内容</p><ul><li>continue：继续；表示 循环体 内下面的代码不执行，重新开始下一次循环</li><li>break：打断；马上停止执行本次循环，执行 循环体 后面的代码</li><li>exit：表示直接跳出程序</li></ul><p>例子：</p><p>1.判断输入整数是否是质数(只能被1和它本身整除=的数叫质数。)</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env bash</span></span><br><span class="line"></span><br><span class="line">read <span class="literal">-p</span> <span class="string">&quot;Please Input A Int Number:&quot;</span> number</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1 &amp; 2 is a specil case</span></span><br><span class="line">[ <span class="variable">$number</span> -<span class="type">eq</span> <span class="number">1</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$number</span> neither prime number nor composite number&quot;</span> <span class="variable">$</span><span class="variable">$</span> <span class="keyword">exit</span></span><br><span class="line">[ <span class="variable">$number</span> -<span class="type">eq</span> <span class="number">2</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$number</span> is prime number &quot;</span> <span class="variable">$</span><span class="variable">$</span> <span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for loop 2 to the input number subtract 1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$</span>(seq <span class="number">2</span> <span class="variable">$</span>[<span class="variable">$number</span>-<span class="number">1</span>])</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="keyword">if</span> [[ <span class="variable">$number</span>%<span class="variable">$i</span> -<span class="type">eq</span> <span class="number">0</span> ]];then</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; <span class="variable">$number</span> is not a prime number!&quot;</span></span><br><span class="line">        <span class="keyword">exit</span></span><br><span class="line">    fi</span><br><span class="line">done</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot; <span class="variable">$number</span> is a prime number!&quot;</span></span><br></pre></td></tr></table></figure><ol><li><p>批量加5个新用户，以u1到u5命名，并统一加一个新组，组名为 class ,统一改密码为123</p></li><li><p>添加用户的命令 <code>useradd -G development</code></p></li><li>判断class组是否存在 <code>grep -w ^development /etc/group</code> 或者<code>groupadd development</code></li><li>根据题意，判断该脚本循环5次来添加用户 <code>for</code></li><li>给用户设置密码，应该放到循环体里面</li></ol><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env bash</span></span><br><span class="line"><span class="comment">########################################################</span></span><br><span class="line"><span class="comment"># Name    : creating_users.sh                            </span></span><br><span class="line"><span class="comment"># Desc    : 批量创建用户,归为统一组，统一密码为                   </span></span><br><span class="line"><span class="comment"># Path    : /root/test/shell_scripts/creating_users.sh                   </span></span><br><span class="line"><span class="comment"># Auther  : Jermyn                                   </span></span><br><span class="line"><span class="comment"># Date    : 2022-07-07                               </span></span><br><span class="line"><span class="comment"># Version : 1.0                                      </span></span><br><span class="line"><span class="comment">########################################################</span></span><br><span class="line">read <span class="literal">-p</span> <span class="string">&quot;请输入您创建的用户组:&quot;</span> <span class="built_in">group</span></span><br><span class="line">read <span class="literal">-p</span> <span class="string">&quot;请输入您创建的用户名：&quot;</span> user_name</span><br><span class="line">read <span class="literal">-s</span> <span class="literal">-p</span> <span class="string">&quot;请输入您统一的密码：&quot;</span> password </span><br><span class="line"></span><br><span class="line">grep <span class="literal">-w</span> <span class="string">&quot;^<span class="variable">$</span>&#123;group&#125;&quot;</span> /etc/<span class="built_in">group</span> &amp;&gt;/dev/null </span><br><span class="line">[ <span class="variable">$</span>? -<span class="type">ne</span> <span class="number">0</span> ] &amp;&amp; useradd  <span class="variable">$</span>&#123;<span class="built_in">group</span>&#125;   </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;<span class="number">1</span>..<span class="number">5</span>&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	useradd <span class="literal">-G</span> <span class="variable">$</span>&#123;<span class="built_in">group</span>&#125; <span class="variable">$</span>&#123;user_name&#125;<span class="variable">$</span>&#123;i&#125;</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$</span>&#123;password&#125;&quot;</span>|passwd <span class="literal">--stdin</span> <span class="variable">$</span>&#123;user_name&#125;<span class="variable">$</span>&#123;i&#125;</span><br><span class="line">done</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">结果测试：</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> ~]<span class="comment"># id employe1</span></span><br><span class="line">uid=<span class="number">1001</span>(employe1) gid=<span class="number">1001</span>(employe1) groups=<span class="number">1001</span>(employe1),<span class="number">1000</span>(development)</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> ~]<span class="comment"># su - employe1</span></span><br><span class="line">Last login: Thu Jul  <span class="number">7</span> <span class="number">20</span>:<span class="number">39</span>:<span class="number">30</span> CST <span class="number">2022</span> on pts/<span class="number">0</span></span><br><span class="line">[<span class="type">employe1</span>@<span class="type">Jermyn</span> ~]<span class="variable">$</span> su - employe2</span><br><span class="line">Password: </span><br><span class="line">Last login: Thu Jul  <span class="number">7</span> <span class="number">20</span>:<span class="number">39</span>:<span class="number">42</span> CST <span class="number">2022</span> on pts/<span class="number">0</span></span><br><span class="line">[<span class="type">employe2</span>@<span class="type">Jermyn</span> ~]<span class="variable">$</span> <span class="keyword">exit</span></span><br><span class="line">logout</span><br><span class="line">[<span class="type">employe1</span>@<span class="type">Jermyn</span> ~]<span class="variable">$</span> <span class="keyword">exit</span></span><br><span class="line">logout</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> ~]<span class="comment"># </span></span><br></pre></td></tr></table></figure><ol><li>写一个脚本，局域网内，把能ping通的IP和不能ping通的IP分类，并保存到两个文本文件里（以10.1.1.1~10.1.1.10 为例）</li></ol><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#！/bin/env bash</span></span><br><span class="line"><span class="comment">###########################################################################</span></span><br><span class="line"><span class="comment"># Name    : check_ping_network.sh                             </span></span><br><span class="line"><span class="comment"># Desc    : Check whether the PING succeeds and classification preservation</span></span><br><span class="line"><span class="comment"># Path    : /root/test/shell_scripts/check_ping_netowrk.sh                  </span></span><br><span class="line"><span class="comment"># Auther  : Jermyn                                   </span></span><br><span class="line"><span class="comment"># Date    : 2022-07-07                               </span></span><br><span class="line"><span class="comment"># Version : 1.0                                      </span></span><br><span class="line"><span class="comment">###########################################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#定义变量</span></span><br><span class="line">read <span class="literal">-p</span> <span class="string">&quot;请输入您需要PING的主机的主机位（如：10.1.1）：&quot;</span> ip</span><br><span class="line"><span class="comment">#循环去ping主机的IP</span></span><br><span class="line"><span class="keyword">for</span> ((i=<span class="number">1</span>;i&lt;=<span class="number">10</span>;i++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	ping <span class="literal">-c1</span> <span class="variable">$ip</span>.<span class="variable">$i</span> &amp;&gt;/dev/null</span><br><span class="line">	<span class="keyword">if</span> [ <span class="variable">$</span>? -<span class="type">eq</span> <span class="number">0</span> ];then</span><br><span class="line">		<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$ip</span>.<span class="variable">$i</span> is ok&quot;</span> &gt;&gt; /tmp/ip_up.txt</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$ip</span>.<span class="variable">$i</span> is down&quot;</span> &gt;&gt; /tmp/ip_down.txt</span><br><span class="line">	fi</span><br><span class="line">done</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">运行结果：</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># time ./check_ping_network.sh </span></span><br><span class="line">请输入您需要PING的主机的主机位（如：<span class="number">10.1</span>.<span class="number">1</span>）：<span class="number">192.168</span>.<span class="number">88</span></span><br><span class="line"></span><br><span class="line">real    <span class="number">0</span>m28.<span class="number">787</span>s</span><br><span class="line">user    <span class="number">0</span>m0.<span class="number">012</span>s</span><br><span class="line">sys     <span class="number">0</span>m0.<span class="number">080</span>s</span><br></pre></td></tr></table></figure><blockquote><p>因为上述的 检测方式 花费时间太长，所以提供一种并发机制</p><p>并行执行：<br><strong>{程序}&amp;表示将程序放到后台并行执行，如果需要等待程序执行完毕再进行下面内容，需要加wait</strong></p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#！/bin/env bash</span></span><br><span class="line"><span class="comment">###########################################################################</span></span><br><span class="line"><span class="comment"># Name    : check_ping_network.sh                             </span></span><br><span class="line"><span class="comment"># Desc    : Check whether the PING succeeds and classification preservation</span></span><br><span class="line"><span class="comment"># Path    : /root/test/shell_scripts/check_ping_netowrk.sh                  </span></span><br><span class="line"><span class="comment"># Auther  : Jermyn                                   </span></span><br><span class="line"><span class="comment"># Date    : 2022-07-07                               </span></span><br><span class="line"><span class="comment"># Version : 2.0                                      </span></span><br><span class="line"><span class="comment">###########################################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#定义变量</span></span><br><span class="line">read <span class="literal">-p</span> <span class="string">&quot;请输入您需要PING的主机的主机位（如：10.1.1）：&quot;</span> ip</span><br><span class="line"><span class="comment">#循环去ping主机的IP</span></span><br><span class="line"><span class="keyword">for</span> ((i=<span class="number">1</span>;i&lt;=<span class="number">10</span>;i++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">	ping <span class="literal">-c1</span> <span class="variable">$ip</span>.<span class="variable">$i</span> &amp;&gt;/dev/null</span><br><span class="line">	<span class="keyword">if</span> [ <span class="variable">$</span>? -<span class="type">eq</span> <span class="number">0</span> ];then</span><br><span class="line">		<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$ip</span>.<span class="variable">$i</span> is ok&quot;</span> &gt;&gt; /tmp/ip_up.txt</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$ip</span>.<span class="variable">$i</span> is down&quot;</span> &gt;&gt; /tmp/ip_down.txt</span><br><span class="line">	fi</span><br><span class="line">&#125;&amp;</span><br><span class="line">done</span><br><span class="line">wait</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;检测已经完成，可以PING通的主机存放在/tmp/ip_up.txt &quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;检测已经完成，不可以PING通的主机存放在/tmp/ip_down.txt &quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">结果显示：</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># time ./check_ping_network.sh </span></span><br><span class="line">请输入您需要PING的主机的主机位（如：<span class="number">10.1</span>.<span class="number">1</span>）：<span class="number">192.168</span>.<span class="number">88</span></span><br><span class="line">检测已经完成，可以PING通的主机存放在/tmp/ip_up.txt </span><br><span class="line">检测已经完成，不可以PING通的主机存放在/tmp/ip_down.txt </span><br><span class="line"></span><br><span class="line">real    <span class="number">0</span>m6.<span class="number">781</span>s</span><br><span class="line">user    <span class="number">0</span>m0.<span class="number">016</span>s</span><br><span class="line">sys     <span class="number">0</span>m0.<span class="number">030</span>s</span><br></pre></td></tr></table></figure><h2 id="条件判断语句（while…-amp-until）"><a href="#条件判断语句（while…-amp-until）" class="headerlink" title="条件判断语句（while…&amp;until）"></a>条件判断语句（while…&amp;until）</h2><h4 id="while循环"><a href="#while循环" class="headerlink" title="while循环"></a>while循环</h4><p>语法：不确定循环换次数；条件为真就进入循环；条件为假就退出循环</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> 表达式</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">		command...</span><br><span class="line">	done</span><br><span class="line">	</span><br><span class="line"><span class="keyword">while</span>  [ <span class="number">1</span> -<span class="type">eq</span> <span class="number">1</span> ] 或者 (( <span class="number">1</span> &gt; <span class="number">2</span> ))</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">     command</span><br><span class="line">     command</span><br><span class="line">     ...</span><br><span class="line"> done</span><br></pre></td></tr></table></figure><p>实例：</p><p><strong>1. 脚本同步系统时间</strong></p><h4 id="①-具体需求"><a href="#①-具体需求" class="headerlink" title="① 具体需求"></a>① 具体需求</h4><ol><li>写一个脚本，30秒 同步一次系统时间，时间同步服务器10.1.1.1</li><li>如果同步失败，则进行邮件报警,每次失败都报警</li><li>如果同步成功,也进行邮件通知,但是 成功100次 才通知一次</li></ol><h4 id="②-思路"><a href="#②-思路" class="headerlink" title="② 思路"></a>② 思路</h4><ol><li>每隔30s同步一次时间，该脚本是一个死循环 while 循环</li><li>同步失败发送邮件<ul><li>ntpdate 10.1.1.1</li><li>rdate -s 10.1.1.1</li></ul></li><li>同步成功100次发送邮件 定义变量保存成功次数</li></ol><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env bash</span></span><br><span class="line"><span class="comment"># 该脚本用于时间同步</span></span><br><span class="line">NTP=<span class="number">10.1</span>.<span class="number">1.1</span></span><br><span class="line">count=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> true</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	ntpdate <span class="variable">$NTP</span> &amp;&gt;/dev/null</span><br><span class="line">	<span class="keyword">if</span> [ <span class="variable">$</span>? -<span class="type">ne</span> <span class="number">0</span> ];then</span><br><span class="line">		<span class="built_in">echo</span> <span class="string">&quot;system date failed&quot;</span> |mail <span class="literal">-s</span> <span class="string">&quot;check system date&quot;</span>  root@localhost</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		let count++</span><br><span class="line">		<span class="keyword">if</span> [ <span class="variable">$count</span> -<span class="type">eq</span> <span class="number">100</span> ];then</span><br><span class="line">		<span class="built_in">echo</span> <span class="string">&quot;systemc date success&quot;</span> |mail <span class="literal">-s</span> <span class="string">&quot;check system date&quot;</span>  root@localhost &amp;&amp; count=<span class="number">0</span></span><br><span class="line">		fi</span><br><span class="line">	fi</span><br><span class="line"><span class="built_in">sleep</span> <span class="number">30</span></span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#定义变量</span></span><br><span class="line">count=<span class="number">0</span></span><br><span class="line">ntp_server=<span class="number">10.1</span>.<span class="number">1.1</span></span><br><span class="line"><span class="keyword">while</span> true</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	rdate <span class="literal">-s</span> <span class="variable">$ntp</span><span class="literal">-server</span> &amp;&gt;/dev/null</span><br><span class="line">	<span class="keyword">if</span> [ <span class="variable">$</span>? -<span class="type">ne</span> <span class="number">0</span> ];then</span><br><span class="line">		<span class="built_in">echo</span> <span class="string">&quot;system date failed&quot;</span> |mail <span class="literal">-s</span> <span class="string">&#x27;check system date&#x27;</span>  root@localhost	</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		let count++</span><br><span class="line">		<span class="keyword">if</span> [ <span class="variable">$</span>[<span class="variable">$count</span>%<span class="number">100</span>] -<span class="type">eq</span> <span class="number">0</span> ];then</span><br><span class="line">		dte successfull<span class="string">&quot; |mail -s &#x27;check system date&#x27;  root@localhost &amp;&amp; count=0</span></span><br><span class="line"><span class="string">		fi</span></span><br><span class="line"><span class="string">	fi</span></span><br><span class="line"><span class="string">sleep 3</span></span><br><span class="line"><span class="string">done</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">以上脚本还有更多的写法，课后自己完成</span></span><br></pre></td></tr></table></figure><h4 id="until-循环"><a href="#until-循环" class="headerlink" title="until 循环"></a>until 循环</h4><p>语法：条件为假就进入循环；条件为真就退出循环</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">until</span> expression   [ <span class="number">1</span> -<span class="type">eq</span> <span class="number">1</span> ]  (( <span class="number">1</span> &gt;= <span class="number">1</span> ))</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">		command</span><br><span class="line">		command</span><br><span class="line">		...</span><br><span class="line">	done</span><br></pre></td></tr></table></figure><p><strong>打印 1-5</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">i=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> [ <span class="variable">$i</span> -<span class="type">le</span> <span class="number">5</span> ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line">	let i++</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">i=<span class="number">1</span></span><br><span class="line"><span class="keyword">until</span> [ <span class="variable">$i</span> -<span class="type">gt</span> <span class="number">5</span> ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line">	let i++</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p><strong>实例</strong></p><ul><li>具体需求</li></ul><ol><li>使用until语句批量创建10个用户，要求stu1—stu5用户的UID分别为1001—1005；</li><li>stu6~stu10用户的家目录分别在/rhome/stu6—/rhome/stu10</li></ol><ul><li>思路</li></ul><ol><li>创建用户语句 <code>useradd -u|useradd -d</code></li><li>使用循环语句(until)批量创建用户 <code>until循环语句结构</code></li><li>判断用户前5个和后5个 <code>条件判断语句</code></li></ol><ul><li>落地实现</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#！/bin/env bash</span></span><br><span class="line"><span class="keyword">if</span> [ -<span class="type">d</span> /<span class="type">rhome</span> ];then</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;/rhome目录已存在&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    mkdir /rhome</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;/rhome不存在，已完成创建&quot;</span></span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">i=<span class="number">1</span></span><br><span class="line"><span class="keyword">until</span> [ <span class="variable">$i</span> -<span class="type">gt</span> <span class="number">10</span> ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">        <span class="keyword">if</span> [ <span class="variable">$i</span> -<span class="type">le</span> <span class="number">5</span> ];then</span><br><span class="line">                useradd <span class="literal">-u</span> <span class="variable">$</span>[<span class="number">1000</span>+<span class="variable">$i</span>] stu<span class="variable">$i</span></span><br><span class="line">                <span class="built_in">echo</span> <span class="number">123</span>|passwd <span class="literal">--stdin</span> stu<span class="variable">$i</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">                useradd <span class="literal">-d</span> /rhome/stu<span class="variable">$i</span> stu<span class="variable">$i</span></span><br><span class="line">                <span class="built_in">echo</span> <span class="number">123</span>|passwd <span class="literal">--stdin</span> stu<span class="variable">$i</span></span><br><span class="line">        fi</span><br><span class="line">let i++</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">==================================================</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">i=<span class="number">1</span></span><br><span class="line"><span class="keyword">until</span> [ <span class="variable">$i</span> -<span class="type">gt</span> <span class="number">10</span> ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="keyword">if</span> [ <span class="variable">$i</span> -<span class="type">le</span> <span class="number">5</span> ];then</span><br><span class="line">		useradd <span class="literal">-u</span> <span class="variable">$</span>[<span class="number">1000</span>+<span class="variable">$i</span>] stu<span class="variable">$i</span> &amp;&amp; <span class="built_in">echo</span> <span class="number">123</span>|passwd <span class="literal">--stdin</span> stu<span class="variable">$i</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		[ ! -<span class="type">d</span> /<span class="type">rhome</span> ] &amp;&amp; mkdir /rhome</span><br><span class="line">		useradd <span class="literal">-d</span> /rhome/stu<span class="variable">$i</span> stu<span class="variable">$i</span> &amp;&amp; <span class="built_in">echo</span> <span class="number">123</span>|passwd <span class="literal">--stdin</span> stu<span class="variable">$i</span>		</span><br><span class="line">	fi</span><br><span class="line">let i++</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h2 id="随机数"><a href="#随机数" class="headerlink" title="随机数"></a>随机数</h2><h4 id="生成随机数"><a href="#生成随机数" class="headerlink" title="生成随机数"></a>生成随机数</h4><p><strong>系统变量</strong>：RANDOM，默认会产生0~32767的随机整数</p><p><strong>前言：</strong>要想调用变量，必须加 $</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.随机产生 <span class="number">0</span><span class="literal">-32767</span> 之间的数字（注：RAMDOM必须大写）</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$RANDOM</span> </span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.随机产生 <span class="number">0</span><span class="literal">-2</span> 之间的数字（注：产生 <span class="number">0</span><span class="literal">-X</span> 之间的数字 宗旨就是随机数除以 X+<span class="number">1</span> 后取余数）</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$</span>[ <span class="variable">$</span>&#123;RANDOM&#125;%3 ]&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.随机产生 <span class="number">0</span><span class="literal">-99</span> 之间的数字 </span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$</span>[ <span class="variable">$</span>&#123;RANDOM&#125;%100 ]&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="number">4</span>.随机产生 <span class="number">50</span><span class="literal">-99</span> 之间的数字（注：产生 A<span class="literal">-B</span> 之间的数字，宗旨就是，产生随机数除以 A+<span class="number">1</span> 后加上 B<span class="literal">-A</span>）</span><br><span class="line">例如：随机数字为 <span class="number">756</span> 除以 <span class="number">51</span> 商 <span class="number">14</span> 余 <span class="number">42</span> 加上 <span class="number">49</span> 得 <span class="number">91</span>   </span><br><span class="line">例如：随机数字为 <span class="number">764</span> 除以 <span class="number">51</span> 商 <span class="number">14</span> 余 <span class="number">50</span> 加上 <span class="number">49</span> 得 <span class="number">99</span></span><br><span class="line">例如：随机数字为 <span class="number">52</span>  除以 <span class="number">51</span> 商 <span class="number">1</span>  余  <span class="number">1</span> 加上 <span class="number">49</span> 得 <span class="number">50</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$</span>[ <span class="variable">$</span>&#123;RANDOM&#125;%51+49 ]&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">5</span>.随机产生一个一位数</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$</span>[ <span class="variable">$</span>&#123;RANDOM&#125;%10 ]&quot;</span></span><br><span class="line"></span><br><span class="line">随机产生一个两位数</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$</span>[ <span class="variable">$</span>&#123;RANDOM&#125;%90+10 ]&quot;</span></span><br><span class="line"></span><br><span class="line">随机产生一个三位数字（注：三位数字 <span class="number">100</span><span class="literal">-999</span> ）</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$</span>[ <span class="variable">$</span>&#123;RANDOM&#125;%900+100 ]&quot;</span></span><br><span class="line"></span><br><span class="line">随机产生一个四位数字</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$</span>[ <span class="variable">$</span>&#123;RANDOM&#125;%9000+1000 ]&quot;</span></span><br></pre></td></tr></table></figure><h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><p><strong>2.1 具体需求</strong>：写一个脚本，产生一个phone_num.txt文件，随机产生以139开头的手机号1000个，每个一行。</p><blockquote><p>思路：可以每次产生四个，两次产生或者其他，但是如果每个数字单独产生的话，电话容易出现重复的</p></blockquote><ol><li>产生1000个电话号码，脚本需要循环1000次 <code>FOR WHILE UNTIL</code></li><li>139+8位,后8位随机产生，可以让每一位数字都随机产生 <code>echo $[$RANDOM%10]</code></li><li>将随机产生的数字分别保存到变量里，然后加上139保存到文件里</li></ol><p>1、for 循环</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env bash</span></span><br><span class="line">touch ./phone_number.txt</span><br><span class="line"><span class="keyword">for</span> ((i=<span class="number">0</span>;i&lt;=<span class="number">1000</span>;i++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    n4=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n5=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n6=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n7=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n8=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n9=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n3=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n11=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;139<span class="variable">$</span>&#123;n4&#125;<span class="variable">$</span>&#123;n5&#125;<span class="variable">$</span>&#123;n6&#125;<span class="variable">$</span>&#123;n7&#125;<span class="variable">$</span>&#123;n8&#125;<span class="variable">$</span>&#123;n9&#125;<span class="variable">$</span>&#123;n10&#125;<span class="variable">$</span>&#123;n11&#125;&quot;</span> &gt;&gt;./phone_number.txt</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>2、while 循环</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env bash</span></span><br><span class="line">touch ./phone_number.txt</span><br><span class="line">count=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> [ <span class="variable">$count</span> -<span class="type">lt</span> <span class="number">1000</span> ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    n4=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n5=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n6=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n7=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n8=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n9=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n3=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n11=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;139<span class="variable">$</span>&#123;n4&#125;<span class="variable">$</span>&#123;n5&#125;<span class="variable">$</span>&#123;n6&#125;<span class="variable">$</span>&#123;n7&#125;<span class="variable">$</span>&#123;n8&#125;<span class="variable">$</span>&#123;n9&#125;<span class="variable">$</span>&#123;n10&#125;<span class="variable">$</span>&#123;n11&#125;&quot;</span> &gt;&gt;./phone_number.txt</span><br><span class="line">    let count++</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>3、while 死循环</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env bash</span></span><br><span class="line">touch ./phone_number.txt</span><br><span class="line">count=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> true</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    n4=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n5=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n6=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n7=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n8=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n9=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n3=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n11=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;139<span class="variable">$</span>&#123;n4&#125;<span class="variable">$</span>&#123;n5&#125;<span class="variable">$</span>&#123;n6&#125;<span class="variable">$</span>&#123;n7&#125;<span class="variable">$</span>&#123;n8&#125;<span class="variable">$</span>&#123;n9&#125;<span class="variable">$</span>&#123;n10&#125;<span class="variable">$</span>&#123;n11&#125;&quot;</span> &gt;&gt;./phone_number.txt</span><br><span class="line">    let count++</span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$count</span> -<span class="type">eq</span> <span class="number">1000</span> ];then <span class="keyword">exit</span>;fi</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>4、until 循环</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env bash</span></span><br><span class="line">touch ./phone_number.txt</span><br><span class="line">count=<span class="number">1</span></span><br><span class="line"><span class="keyword">until</span> [ <span class="variable">$count</span> -<span class="type">gt</span> <span class="number">1000</span> ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    n4=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n5=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n6=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n7=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n8=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n9=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n3=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    n11=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">10</span> ]</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;139<span class="variable">$</span>&#123;n4&#125;<span class="variable">$</span>&#123;n5&#125;<span class="variable">$</span>&#123;n6&#125;<span class="variable">$</span>&#123;n7&#125;<span class="variable">$</span>&#123;n8&#125;<span class="variable">$</span>&#123;n9&#125;<span class="variable">$</span>&#123;n10&#125;<span class="variable">$</span>&#123;n11&#125;&quot;</span> &gt;&gt;./phone_number.txt</span><br><span class="line">    let count++</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p><strong>2.2 具体需求</strong>：随机抽出5位幸运观众</p><ul><li><p>具体需求：</p><ul><li>在上面的1000个手机号里抽奖 5个 幸运观众，显示出这5个幸运观众。</li><li>但只显示头3个数和尾号的4个数，中间的都用*代替</li></ul></li><li><p>思路：</p><ul><li><p>确定幸运观众所在的行 <code>0-1000 随机找出一个数字 $[$RANDOM%1000+1]</code></p></li><li><p>将电话号码提取出来 <code>head -随机产生行号 phonenum.txt |tail -1</code></p></li><li><p>显示 前3个和后4个数到屏幕 <code>echo 139****</code></p></li></ul></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env bash</span></span><br><span class="line">&gt;luck_phone_num.txt</span><br><span class="line"><span class="keyword">for</span> ((i=<span class="number">1</span>;i&lt;=<span class="number">5</span>;i++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    all_user=`wc <span class="literal">-l</span> phone_number.txt | cut <span class="literal">-d</span> <span class="string">&#x27; &#x27;</span> <span class="literal">-f1</span>`</span><br><span class="line">    random_num=<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="variable">$all_user</span>+<span class="number">1</span> ]</span><br><span class="line">    random_num_phone=<span class="variable">$</span>(head -<span class="variable">$random_num</span> phone_number.txt | tail <span class="literal">-1</span> |cut <span class="literal">-c</span> <span class="string">&#x27;7-&#x27;</span>)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;139****<span class="variable">$random_num_phone</span>&quot;</span> | <span class="built_in">tee</span> <span class="literal">-a</span> luck_phone_num.txt</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p><strong>2.3 批量创建用户(密码随机产生)</strong></p><p><strong>需求：</strong>批量创建5个用户，每个用户的密码为一个随机数</p><p><strong>思路：</strong>1.循环5次创建用户</p><p>​ 2.产生一个密码文件来保存用户的随机密码</p><p>​ 3.从密码文件中取出随机密码赋值给用户</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env bash</span></span><br><span class="line"><span class="comment">########################################################</span></span><br><span class="line"><span class="comment"># Name    : creating_users02.sh                            </span></span><br><span class="line"><span class="comment"># Desc    : 批量创建用户,批量创建5个用户，每个用户的密码为一个随机数                  </span></span><br><span class="line"><span class="comment"># Path    : /root/test/shell_scripts/creating_users02.sh                   </span></span><br><span class="line"><span class="comment"># Auther  : Jermyn                                   </span></span><br><span class="line"><span class="comment"># Date    : 2022-07-12                              </span></span><br><span class="line"><span class="comment"># Version : 2.0                                      </span></span><br><span class="line"><span class="comment">########################################################</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> user0&#123;<span class="number">1</span>..<span class="number">5</span>&#125;:jermyn<span class="variable">$</span>[ <span class="variable">$RANDOM</span>%<span class="number">9000</span>+<span class="number">1000</span> ]<span class="selector-tag">@</span>.. | tr <span class="string">&#x27; &#x27;</span> <span class="string">&#x27;\n&#x27;</span> | <span class="built_in">tee</span> <span class="literal">-a</span> user_passwd.txt</span><br><span class="line"><span class="keyword">for</span> ((i=<span class="number">1</span>;i&lt;=<span class="number">5</span>;i++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    user=`head -<span class="variable">$i</span> uesr_passwd.txt | tail <span class="literal">-1</span> | cut <span class="literal">-d</span> <span class="string">&#x27;:&#x27;</span> <span class="operator">-f</span> <span class="number">1</span> `</span><br><span class="line">    passwd=`head -<span class="variable">$i</span> uesr_passwd.txt | tail <span class="literal">-1</span> | cut <span class="literal">-d</span> <span class="string">&#x27;:&#x27;</span> <span class="operator">-f</span> <span class="number">2</span> `</span><br><span class="line">    useradd <span class="variable">$user</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="variable">$pass</span>|passwd <span class="literal">--stdin</span> <span class="variable">$user</span></span><br><span class="line">done</span><br></pre></td></tr></table></figure><h2 id="循环嵌套-shift-位移-补充expect"><a href="#循环嵌套-shift-位移-补充expect" class="headerlink" title="循环嵌套+shift 位移+补充expect"></a>循环嵌套+shift 位移+补充expect</h2><h4 id="语法："><a href="#语法：" class="headerlink" title="语法："></a>语法：</h4><ul><li><p>一个循环体内又包含另一个<strong>完整</strong>的循环结构，称为循环的嵌套。</p></li><li><p>每次外部循环都会触发内部循环，直至内部循环完成，才接着执行下一次的外部循环。</p></li><li><p>for循环、while循环和until循环可以<strong>相互</strong>嵌套。</p></li></ul><p><strong>1.1 打印九九乘法表</strong></p><ul><li>for 循环</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> ((i=<span class="number">1</span>;i&lt;=<span class="number">9</span>;i++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="keyword">for</span> ((j=<span class="number">1</span>;j&lt;=<span class="variable">$i</span>;j++))</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="operator">-ne</span> <span class="string">&quot;<span class="variable">$j</span>*<span class="variable">$i</span>=<span class="variable">$</span>[ <span class="variable">$i</span>*<span class="variable">$j</span> ]\t&quot;</span></span><br><span class="line">    done</span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line">done</span><br></pre></td></tr></table></figure><ul><li>while 循环</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">i=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> [ <span class="variable">$i</span> -<span class="type">le</span> <span class="number">9</span> ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    j=<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> [ <span class="variable">$j</span> -<span class="type">le</span> <span class="variable">$i</span> ]</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="operator">-ne</span> <span class="string">&quot;<span class="variable">$j</span>*<span class="variable">$i</span>=<span class="variable">$</span>[ <span class="variable">$i</span>*<span class="variable">$j</span> ]\t&quot;</span></span><br><span class="line">        let j++</span><br><span class="line">    done</span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line">let i++</span><br><span class="line">done</span><br></pre></td></tr></table></figure><ul><li>until 循环</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">i=<span class="number">1</span></span><br><span class="line"><span class="keyword">until</span> [ <span class="variable">$i</span> -<span class="type">gt</span> <span class="number">9</span> ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    j=<span class="number">1</span></span><br><span class="line">    <span class="keyword">until</span> [ <span class="variable">$j</span> -<span class="type">gt</span> <span class="variable">$i</span> ]</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="operator">-ne</span> <span class="string">&quot;<span class="variable">$j</span>*<span class="variable">$i</span>=<span class="variable">$</span>[ <span class="variable">$i</span>*<span class="variable">$j</span> ]\t&quot;</span></span><br><span class="line">        let j++</span><br><span class="line">    done</span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line">let i++</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h4 id="shift-位移的用法"><a href="#shift-位移的用法" class="headerlink" title="shift 位移的用法"></a>shift 位移的用法</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">exit</span>			退出整个程序</span><br><span class="line"><span class="keyword">break</span>		   结束当前循环，或跳出本层循环</span><br><span class="line"><span class="keyword">continue</span> 	忽略本次循环剩余的代码，直接进行下一次循环</span><br><span class="line">shift			使位置参数向左移动，默认移动<span class="number">1</span>位，可以使用shift <span class="number">2</span></span><br><span class="line"></span><br><span class="line">:</span><br><span class="line">true</span><br><span class="line">false</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>2.1 实现用户自定义输入数字，然后脚本计算和：</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.常规 <span class="keyword">for</span> 循环</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">sum=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	let sum=<span class="variable">$sum</span>+<span class="variable">$i</span></span><br><span class="line">done</span><br><span class="line"><span class="built_in">echo</span> sum=<span class="variable">$sum</span></span><br><span class="line"></span><br><span class="line">结果显示</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># bash -x demo.sh 1 2 3</span></span><br><span class="line">+ sum=<span class="number">0</span></span><br><span class="line">+ <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;&quot;$@&quot;&#x27;</span></span><br><span class="line">+ let sum=<span class="number">0</span>+<span class="number">1</span></span><br><span class="line">+ <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;&quot;$@&quot;&#x27;</span></span><br><span class="line">+ let sum=<span class="number">1</span>+<span class="number">2</span></span><br><span class="line">+ <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;&quot;$@&quot;&#x27;</span></span><br><span class="line">+ let sum=<span class="number">3</span>+<span class="number">3</span></span><br><span class="line">+ <span class="built_in">echo</span> sum=<span class="number">6</span></span><br><span class="line">sum=<span class="number">6</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.使用 shift</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">sum=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> [ <span class="variable">$</span><span class="comment"># -ne 0 ]</span></span><br><span class="line"><span class="type">do</span></span><br><span class="line">	<span class="type">let</span> <span class="type">sum</span>=<span class="variable">$sum</span>+<span class="variable">$1</span></span><br><span class="line">	<span class="type">shift</span></span><br><span class="line"><span class="type">done</span></span><br><span class="line"><span class="type">echo</span> <span class="type">sum</span>=<span class="variable">$sum</span></span><br><span class="line"></span><br><span class="line">结果显示：</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># bash -x demo.sh 1 2 3</span></span><br><span class="line">+ <span class="type">sum</span>=<span class="number">0</span></span><br><span class="line">+ <span class="string">&#x27;[&#x27;</span> <span class="number">3</span> -<span class="type">ne</span> <span class="number">0</span> <span class="string">&#x27;]&#x27;</span></span><br><span class="line">+ <span class="type">let</span> <span class="type">sum</span>=<span class="number">0</span>+<span class="number">1</span></span><br><span class="line">+ <span class="type">shift</span></span><br><span class="line">+ <span class="string">&#x27;[&#x27;</span> <span class="number">2</span> -<span class="type">ne</span> <span class="number">0</span> <span class="string">&#x27;]&#x27;</span></span><br><span class="line">+ <span class="type">let</span> <span class="type">sum</span>=<span class="number">1</span>+<span class="number">2</span></span><br><span class="line">+ <span class="type">shift</span></span><br><span class="line">+ <span class="string">&#x27;[&#x27;</span> <span class="number">1</span> -<span class="type">ne</span> <span class="number">0</span> <span class="string">&#x27;]&#x27;</span></span><br><span class="line">+ <span class="type">let</span> <span class="type">sum</span>=<span class="number">3</span>+<span class="number">3</span></span><br><span class="line">+ <span class="type">shift</span></span><br><span class="line">+ <span class="string">&#x27;[&#x27;</span> <span class="number">0</span> -<span class="type">ne</span> <span class="number">0</span> <span class="string">&#x27;]&#x27;</span></span><br><span class="line">+ <span class="type">echo</span> <span class="type">sum</span>=<span class="number">6</span></span><br><span class="line"><span class="type">sum</span>=<span class="number">6</span></span><br></pre></td></tr></table></figure><h4 id="补充扩展expect"><a href="#补充扩展expect" class="headerlink" title="补充扩展expect"></a>补充扩展expect</h4><p>语法：expect 自动应答 tcl语言</p><p><strong>3.1 需求：A远程登录到server上什么都不做</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/expect</span></span><br><span class="line"><span class="comment"># 开启一个程序</span></span><br><span class="line">spawn ssh root@<span class="number">192.168</span>.<span class="number">88.139</span></span><br><span class="line"><span class="comment"># 捕获相关内容</span></span><br><span class="line">expect &#123;</span><br><span class="line">        <span class="string">&quot;(yes/no)?&quot;</span> &#123; send <span class="string">&quot;yes\r&quot;</span>;exp_continue &#125;</span><br><span class="line">        <span class="string">&quot;password:&quot;</span> &#123; send <span class="string">&quot;123456\r&quot;</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line">interact   //交互</span><br><span class="line"></span><br><span class="line">脚本执行方式：</span><br><span class="line"><span class="comment"># ./expect1.sh</span></span><br><span class="line"><span class="comment"># /root/test/shell_scripts/expect1.sh</span></span><br><span class="line"><span class="comment"># expect -f expect1.sh</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span>）定义变量</span><br><span class="line"><span class="comment">#!/usr/bin/expect</span></span><br><span class="line"><span class="built_in">set</span> ip <span class="number">192.168</span>.<span class="number">88.139</span></span><br><span class="line"><span class="built_in">set</span> pass <span class="number">123456</span></span><br><span class="line"><span class="built_in">set</span> timeout <span class="number">5</span></span><br><span class="line">spawn ssh root<span class="selector-tag">@</span><span class="variable">$ip</span></span><br><span class="line">expect &#123;</span><br><span class="line">	<span class="string">&quot;yes/no&quot;</span> &#123; send <span class="string">&quot;yes\r&quot;</span>;exp_continue &#125;</span><br><span class="line">	<span class="string">&quot;password:&quot;</span> &#123; send <span class="string">&quot;<span class="variable">$pass</span>\r&quot;</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line">interact</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>）使用位置参数 类比 bash 的<span class="variable">$</span>* <span class="variable">$1</span> 等等</span><br><span class="line"><span class="comment">#!/usr/bin/expect</span></span><br><span class="line"><span class="built_in">set</span> ip [ <span class="type">lindex</span> <span class="variable">$argv</span> <span class="number">0</span> ]</span><br><span class="line"><span class="built_in">set</span> pass [ <span class="type">lindex</span> <span class="variable">$argv</span> <span class="number">1</span> ]</span><br><span class="line"><span class="built_in">set</span> timeout <span class="number">5</span></span><br><span class="line">spawn ssh root<span class="selector-tag">@</span><span class="variable">$ip</span></span><br><span class="line">expect &#123;</span><br><span class="line">	<span class="string">&quot;yes/no&quot;</span> &#123; send <span class="string">&quot;yes\r&quot;</span>;exp_continue &#125;</span><br><span class="line">	<span class="string">&quot;password:&quot;</span> &#123; send <span class="string">&quot;<span class="variable">$pass</span>\r&quot;</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line">interact</span><br></pre></td></tr></table></figure><p><strong>3.2 需求:A远程登录到server上操作</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/expect</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义变量 格式：set 变量名 变量值</span></span><br><span class="line"><span class="built_in">set</span> ip <span class="number">10.1</span>.<span class="number">1.1</span></span><br><span class="line"><span class="built_in">set</span> pass <span class="number">123456</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># timeout 时间间隔</span></span><br><span class="line"><span class="built_in">set</span> timeout <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行命令</span></span><br><span class="line">spawn ssh root<span class="selector-tag">@</span><span class="variable">$ip</span></span><br><span class="line">expect &#123;</span><br><span class="line">	<span class="comment"># 如果捕获到 &quot;yes/no&quot; 发送 yes回车 反之继续操作</span></span><br><span class="line">	<span class="string">&quot;yes/no&quot;</span> &#123; send <span class="string">&quot;yes\r&quot;</span>;exp_continue &#125;</span><br><span class="line">	<span class="comment"># 如果捕获到 &quot;password:&quot; 发送 $pass 回车</span></span><br><span class="line">	<span class="string">&quot;password:&quot;</span> &#123; send <span class="string">&quot;<span class="variable">$pass</span>\r&quot;</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行操作 捕获到 # </span></span><br><span class="line">expect <span class="string">&quot;#&quot;</span></span><br><span class="line">send <span class="string">&quot;rm -rf /tmp/*\r&quot;</span></span><br><span class="line">send <span class="string">&quot;touch /tmp/file&#123;1..3&#125;\r&quot;</span></span><br><span class="line">send <span class="string">&quot;date\r&quot;</span></span><br><span class="line">send <span class="string">&quot;exit\r&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 代表程序结束</span></span><br><span class="line">expect eof</span><br></pre></td></tr></table></figure><p><strong>3.3 shell 脚本和 expect 结合</strong></p><p><strong>需求：shell脚本和expect结合使用，在多台服务器上创建1个用户</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">server</span> <span class="type">shell04</span>]<span class="comment"># cat ip.txt </span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span> <span class="number">123456</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.2</span> <span class="number">123456</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">1</span>. 循环</span><br><span class="line"><span class="number">2</span>. 登录远程主机——&gt;ssh——&gt;从ip.txt文件里获取IP和密码分别赋值给两个变量</span><br><span class="line"><span class="number">3</span>. 使用expect程序来解决交互问题</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 循环在指定的服务器上创建用户和文件</span></span><br><span class="line"><span class="keyword">while</span> read ip pass</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	/usr/bin/expect &lt;&lt;<span class="literal">-END</span> &amp;&gt;/dev/null</span><br><span class="line">	spawn ssh root<span class="selector-tag">@</span><span class="variable">$ip</span></span><br><span class="line">	expect &#123;</span><br><span class="line">	<span class="string">&quot;yes/no&quot;</span> &#123; send <span class="string">&quot;yes\r&quot;</span>;exp_continue &#125;</span><br><span class="line">	<span class="string">&quot;password:&quot;</span> &#123; send <span class="string">&quot;<span class="variable">$pass</span>\r&quot;</span> &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	expect <span class="string">&quot;#&quot;</span> &#123; send <span class="string">&quot;useradd yy1;rm -rf /tmp/*;exit\r&quot;</span> &#125;</span><br><span class="line">	expect eof</span><br><span class="line">	<span class="keyword">END</span></span><br><span class="line">done &lt; ip.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="built_in">cat</span> ip.txt|<span class="keyword">while</span> read ip pass</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">        /usr/bin/expect &lt;&lt;<span class="literal">-EOF</span></span><br><span class="line">        spawn ssh root<span class="selector-tag">@</span><span class="variable">$ip</span></span><br><span class="line">        expect &#123;</span><br><span class="line">                <span class="string">&quot;yes/no&quot;</span> &#123; send <span class="string">&quot;yes\r&quot;</span>;exp_continue &#125;</span><br><span class="line">                <span class="string">&quot;password:&quot;</span> &#123; send <span class="string">&quot;<span class="variable">$pass</span>\r&quot;</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        expect <span class="string">&quot;#&quot;</span></span><br><span class="line">        send <span class="string">&quot;hostname\r&quot;</span></span><br><span class="line">        send <span class="string">&quot;exit\r&quot;</span></span><br><span class="line">        expect eof</span><br><span class="line">        EOF</span><br><span class="line">        &#125;&amp;</span><br><span class="line">done</span><br><span class="line">wait</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;user is ok....&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="keyword">while</span> read ip pass</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">        /usr/bin/expect &lt;&lt;<span class="literal">-EOF</span></span><br><span class="line">        spawn ssh root<span class="selector-tag">@</span><span class="variable">$ip</span></span><br><span class="line">        expect &#123;</span><br><span class="line">                <span class="string">&quot;yes/no&quot;</span> &#123; send <span class="string">&quot;yes\r&quot;</span>;exp_continue &#125;</span><br><span class="line">                <span class="string">&quot;password:&quot;</span> &#123; send <span class="string">&quot;<span class="variable">$pass</span>\r&quot;</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        expect <span class="string">&quot;#&quot;</span></span><br><span class="line">        send <span class="string">&quot;hostname\r&quot;</span></span><br><span class="line">        send <span class="string">&quot;exit\r&quot;</span></span><br><span class="line">        expect eof</span><br><span class="line">        EOF</span><br><span class="line"></span><br><span class="line">        &#125;&amp;</span><br><span class="line">done&lt;ip.txt</span><br><span class="line">wait</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;user is ok....&quot;</span></span><br></pre></td></tr></table></figure><h2 id="实战示例"><a href="#实战示例" class="headerlink" title="实战示例"></a>实战示例</h2><p><strong>1、写一个脚本，将跳板机上yunwei用户的公钥推送到局域网内可以ping通的所有机器上</strong></p><p>说明：主机和密码文件已经提供</p><p>10.1.1.1:123456</p><p>10.1.1.2:123456</p><p><strong>案例分析</strong></p><ul><li><strong>关闭防火墙和selinux</strong></li><li>判断ssh服务是否开启（默认ok）</li><li>循环判断给定密码文件里的哪些IP是可以ping通</li><li>判断IP是否可以ping通——&gt;$?—&gt;流程控制语句</li><li>密码文件里获取主机的IP和密码保存变量</li><li>判断公钥是否存在—&gt;不存在创建它</li><li>ssh-copy-id 将跳板机上的yunwei用户的公钥推送到远程主机—&gt;expect解决交互</li><li>将ping通的主机IP单独保存到一个文件</li><li>测试验证</li></ul><p><strong>落地实现</strong></p><p>代码拆分</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.判断yunwei用户的公钥是否存在</span><br><span class="line">[ ! -<span class="type">f</span> /<span class="type">hoem</span>/<span class="type">yunwei</span>/<span class="type">.ssh</span>/<span class="type">id_rsa</span> ] &amp;&amp; ssh<span class="literal">-keygen</span> <span class="literal">-P</span> <span class="string">&#x27;&#x27;</span> <span class="operator">-f</span> ./id_rsa</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.获取IP并且判断是否可以 ping 通</span><br><span class="line"><span class="number">2.1</span>主机密码文件 ip.txt</span><br><span class="line">	<span class="number">10.1</span>.<span class="number">1.1</span>:<span class="number">123456</span></span><br><span class="line">    <span class="number">10.1</span>.<span class="number">1.2</span>:<span class="number">123456</span></span><br><span class="line"><span class="number">2.2</span> 循环判断主机是否ping通</span><br><span class="line">	tr <span class="string">&#x27;:&#x27;</span> <span class="string">&#x27; &#x27;</span> &lt; ip.txt|<span class="keyword">while</span> read ip pass</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">		ping <span class="literal">-c1</span> <span class="variable">$ip</span> &amp;&gt;/dev/null</span><br><span class="line">      <span class="keyword">if</span> [ <span class="variable">$</span>? -<span class="type">eq</span> <span class="number">0</span> ];then</span><br><span class="line">      	推送公钥</span><br><span class="line">      fi</span><br><span class="line">	done</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.非交互式推送公钥</span><br><span class="line">/usr/bin/expect &lt;&lt;<span class="literal">-END</span> &amp;&gt;/dev/null</span><br><span class="line">        spawn ssh<span class="literal">-copy-id</span> root<span class="selector-tag">@</span><span class="variable">$ip</span></span><br><span class="line">        expect &#123;</span><br><span class="line">                <span class="string">&quot;yes/no&quot;</span> &#123; send <span class="string">&quot;yes\r&quot;</span>;exp_continue &#125;</span><br><span class="line">                <span class="string">&quot;password:&quot;</span> &#123; send <span class="string">&quot;<span class="variable">$pass</span>\r&quot;</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        expect eof</span><br><span class="line">	<span class="keyword">END</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>最终实现</strong></p><ol><li><strong>环境准备</strong></li></ol><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">jumper<span class="literal">-server</span>	有yunwei用户</span><br><span class="line"></span><br><span class="line">yunwei用户 sudo 授权：</span><br><span class="line">visudo</span><br><span class="line"><span class="comment">## Allow root to run any commands anywhere</span></span><br><span class="line">root    ALL=(ALL)       ALL</span><br><span class="line">yunwei  ALL=(root)      NOPASSWD:ALL,!/sbin/shutdown,!/sbin/init,!/bin/<span class="built_in">rm</span> <span class="literal">-rf</span> /</span><br><span class="line"></span><br><span class="line">解释说明：</span><br><span class="line"><span class="number">1</span>）第一个字段 yunwei 指定的是用户：可以是用户名，也可以是别名。每个用户设置一行，多个用户设置多行，也可以将多个用户设置成一个别名后再进行设置。</span><br><span class="line"><span class="number">2</span>）第二个字段ALL指定的是用户所在的主机：可以是ip,也可以是主机名，表示该sudo设置只在该主机上生效，ALL表示在所有主机上都生效！限制的一般都是本机，也就是限制使用这个文件的主机;一般都指定为<span class="string">&quot;ALL&quot;</span>表示所有的主机，不管文件拷到那里都可以用。比如：<span class="number">10.1</span>.<span class="number">1.1</span>=...则表示只在当前主机生效。</span><br><span class="line"><span class="number">3</span>）第三个字段（root）括号里指定的也是用户：指定以什么用户身份执行sudo，即使用sudo后可以享有所有root账号下的权限。如果要排除个别用户，可以在括号内设置，比如ALL=(ALL,!oracle,!pos)。</span><br><span class="line"><span class="number">4</span>）第四个字段ALL指定的是执行的命令：即使用sudo后可以执行所有的命令。除了关机和删除根内容以外；也可以设置别名。NOPASSWD: ALL表示使用sudo的不需要输入密码。</span><br><span class="line"><span class="number">5</span>）也可以授权给一个用户组</span><br><span class="line">	%admin ALL=(ALL) ALL	表示admin组里的所有成员可以在任何主机上以任何用户身份执行任何命令</span><br></pre></td></tr></table></figure><ol><li><strong>脚本实现</strong></li></ol><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#判断公钥是否存在</span></span><br><span class="line">[ ! -<span class="type">f</span> /<span class="type">home</span>/<span class="type">yunwei</span>/<span class="type">.ssh</span>/<span class="type">id_rsa</span> ] &amp;&amp; ssh<span class="literal">-keygen</span> <span class="literal">-P</span> <span class="string">&#x27;&#x27;</span> <span class="operator">-f</span> ~/.ssh/id_rsa</span><br><span class="line"></span><br><span class="line"><span class="comment">#循环判断主机是否ping通，如果ping通推送公钥</span></span><br><span class="line">tr <span class="string">&#x27;:&#x27;</span> <span class="string">&#x27; &#x27;</span> &lt; /shell04/ip.txt|<span class="keyword">while</span> read ip pass</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">        ping <span class="literal">-c1</span> <span class="variable">$ip</span> &amp;&gt;/dev/null</span><br><span class="line">        <span class="keyword">if</span> [ <span class="variable">$</span>? -<span class="type">eq</span> <span class="number">0</span> ];then</span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$ip</span> &gt;&gt; ~/ip_up.txt</span><br><span class="line">        /usr/bin/expect &lt;&lt;<span class="literal">-END</span> &amp;&gt;/dev/null</span><br><span class="line">         spawn ssh<span class="literal">-copy-id</span> root<span class="selector-tag">@</span><span class="variable">$ip</span></span><br><span class="line">         expect &#123;</span><br><span class="line">                <span class="string">&quot;yes/no&quot;</span> &#123; send <span class="string">&quot;yes\r&quot;</span>;exp_continue &#125;</span><br><span class="line">                <span class="string">&quot;password:&quot;</span> &#123; send <span class="string">&quot;<span class="variable">$pass</span>\r&quot;</span> &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        expect eof</span><br><span class="line">        <span class="keyword">END</span></span><br><span class="line">        fi</span><br><span class="line">&#125;&amp;</span><br><span class="line">done</span><br><span class="line">wait</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;公钥已经推送完毕，正在测试....&quot;</span></span><br><span class="line"><span class="comment">#测试验证</span></span><br><span class="line">remote_ip=`tail <span class="literal">-1</span> ~/ip_up.txt`</span><br><span class="line">ssh root<span class="selector-tag">@</span><span class="variable">$remote_ip</span> hostname &amp;&gt;/dev/null</span><br><span class="line">test <span class="variable">$</span>? <span class="operator">-eq</span> <span class="number">0</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;公钥成功推送完毕&quot;</span></span><br></pre></td></tr></table></figure><h4 id="写一个脚本，统计web服务的不同连接状态个数"><a href="#写一个脚本，统计web服务的不同连接状态个数" class="headerlink" title="写一个脚本，统计web服务的不同连接状态个数"></a>写一个脚本，统计web服务的不同连接状态个数</h4><ol><li>找出查看网站连接状态的命令 <code>ss -natp|grep :22</code></li><li>如何统计==不同的==状态 循环去统计，需要计算</li></ol><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#count_http_22_state</span></span><br><span class="line"><span class="comment">#统计每个状态的个数</span></span><br><span class="line"></span><br><span class="line">declare <span class="literal">-A</span> array1</span><br><span class="line">states=`ss <span class="literal">-ant</span>|grep <span class="number">22</span>|cut <span class="literal">-d</span><span class="string">&#x27; &#x27;</span> <span class="literal">-f1</span>`</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$states</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">        let array1[<span class="variable">$i</span>]++</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"><span class="comment">#通过遍历数组里的索引和元素打印出来</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="variable">$</span>&#123;!array1[<span class="selector-tag">@</span>]&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$j:</span><span class="variable">$</span>&#123;array1[<span class="variable">$j</span>]&#125;</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h2 id="case语句-函数"><a href="#case语句-函数" class="headerlink" title="case语句+函数"></a>case语句+函数</h2><h4 id="case语句"><a href="#case语句" class="headerlink" title="case语句"></a>case语句</h4><p>语法：case语句为多重匹配语句；如果匹配成功，执行相匹配的命令。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">说明：pattern表示需要匹配的模式</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">case var <span class="keyword">in</span>             定义变量;var代表是变量名</span><br><span class="line">pattern <span class="number">1</span>)              模式<span class="number">1</span>;用 | 分割多个模式，相当于or</span><br><span class="line">    command1            需要执行的语句</span><br><span class="line">    ;;                  两个分号代表命令结束</span><br><span class="line">pattern <span class="number">2</span>)</span><br><span class="line">    command2</span><br><span class="line">    ;;</span><br><span class="line">pattern <span class="number">3</span>)</span><br><span class="line">    command3</span><br><span class="line">    ;;</span><br><span class="line">		  *)              default，不满足以上模式，默认执行*)下面的语句</span><br><span class="line">    command4</span><br><span class="line">    ;;</span><br><span class="line">esac							esac表示case语句结束</span><br></pre></td></tr></table></figure><p>需求：</p><p><strong>1.1当给程序传入start、stop、restart三个不同参数时分别执行相应命令</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env bash</span></span><br><span class="line">case <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">        <span class="built_in">start</span>|S)</span><br><span class="line">        service apache <span class="built_in">start</span> &amp;&gt;/dev/null &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;apache 启动成功&quot;</span> || <span class="built_in">echo</span> <span class="string">&quot;apache 启动失败&quot;</span></span><br><span class="line">        ;;</span><br><span class="line">        stop|T)</span><br><span class="line">        service apache stop &amp;&gt;/dev/null &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;apache 停止成功&quot;</span> || <span class="built_in">echo</span> <span class="string">&quot;apache 停止失败&quot;</span></span><br><span class="line">        ;;</span><br><span class="line">        restart|<span class="built_in">R</span>)</span><br><span class="line">        service apache restart &amp;&gt;/dev/null &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;apache 重启完毕&quot;</span> || <span class="built_in">echo</span> <span class="string">&quot;apache 重启失败&quot;</span></span><br><span class="line">        ;;</span><br><span class="line">        *)</span><br><span class="line">        <span class="built_in">echo</span> <span class="literal">-e</span> <span class="string">&quot;\033[31m 此脚本需要传入位置参数 \033[0m&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="literal">-e</span> <span class="string">&quot;\033[41;30m 请选择 start|S || stop|T || restart|R\033[0m&quot;</span> </span><br><span class="line">        ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure><p><strong>1.2 脚本提示让用户输入需要管理的服务名，然后提示用户需要对服务做什么操作，如启动，关闭等操作</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env bash</span></span><br><span class="line">read <span class="literal">-p</span> <span class="string">&quot;请输入你要管理的服务名称(vsftpd):&quot;</span> service</span><br><span class="line">case <span class="variable">$service</span> <span class="keyword">in</span></span><br><span class="line">        vsftpd|ftp)</span><br><span class="line">        read <span class="literal">-p</span> <span class="string">&quot;请选择你需要做的事情(restart|stop):&quot;</span> action</span><br><span class="line">        case <span class="variable">$action</span> <span class="keyword">in</span></span><br><span class="line">                stop|S)</span><br><span class="line">                service vsftpd stop &amp;&gt;/dev/null &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;该<span class="variable">$serivce</span>服务已经停止成功&quot;</span></span><br><span class="line">                ;;</span><br><span class="line">                <span class="built_in">start</span>)</span><br><span class="line">                service vsftpd <span class="built_in">start</span> &amp;&gt;/dev/null &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;该<span class="variable">$serivce</span>服务已经成功启动&quot;</span></span><br><span class="line">                ;;</span><br><span class="line">        esac</span><br><span class="line">        ;;</span><br><span class="line">        httpd|apache)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;apache hello world&quot;</span></span><br><span class="line">        ;;</span><br><span class="line">        *)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;请输入你要管理的服务名称(vsftpd):&quot;</span></span><br><span class="line">        ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure><p><strong>1.3 菜单打印出来；交互式让用户输入操作编号，然后做出相应处理</strong></p><p><strong>落地实现：</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env bash</span></span><br><span class="line">meue()&#123;</span><br><span class="line"><span class="built_in">echo</span> <span class="literal">-e</span> <span class="string">&quot;\033[32m</span></span><br><span class="line"><span class="string">################## 菜单栏 #########################</span></span><br><span class="line"><span class="string">#            f   显示磁盘分区                     #</span></span><br><span class="line"><span class="string">#            d   显示磁盘挂载                     #</span></span><br><span class="line"><span class="string">#            m   查看内存使用                     #</span></span><br><span class="line"><span class="string">#            u   查看系统负载                     #</span></span><br><span class="line"><span class="string">#            q   退出程序                         #</span></span><br><span class="line"><span class="string">###################################################</span></span><br><span class="line"><span class="string">\033[0m&quot;</span></span><br><span class="line">&#125; </span><br><span class="line">meue</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> true</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">read <span class="literal">-p</span> <span class="string">&quot;请选择您需要查询的内容：&quot;</span> action</span><br><span class="line">case <span class="variable">$action</span> <span class="keyword">in</span></span><br><span class="line">	f)</span><br><span class="line">	<span class="built_in">clear</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="literal">-e</span> <span class="string">&quot;\033[36m########################### 显示分区 ######################\033[0m&quot;</span> </span><br><span class="line">	fdisk <span class="literal">-l</span></span><br><span class="line">	meue</span><br><span class="line">	;;</span><br><span class="line">	d)</span><br><span class="line">	<span class="built_in">clear</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="literal">-e</span> <span class="string">&quot;\033[36m########################### 显示磁盘挂载 ######################\033[0m&quot;</span> </span><br><span class="line">	df <span class="literal">-h</span></span><br><span class="line">	meue</span><br><span class="line">	;;</span><br><span class="line">	m)</span><br><span class="line">	<span class="built_in">clear</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="literal">-e</span> <span class="string">&quot;\033[36m########################### 查看内存使用 ######################\033[0m&quot;</span> </span><br><span class="line">	free <span class="literal">-m</span></span><br><span class="line">	meue</span><br><span class="line">	;;</span><br><span class="line">	u)</span><br><span class="line">	<span class="built_in">clear</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="literal">-e</span> <span class="string">&quot;\033[36m########################### 查看系统负载区 ######################\033[0m&quot;</span> </span><br><span class="line">	uptime</span><br><span class="line">	meue</span><br><span class="line">	;;</span><br><span class="line">	q)</span><br><span class="line">	<span class="built_in">echo</span> <span class="literal">-e</span> <span class="string">&quot;\033[36m########################### 退出程序 ######################\033[0m&quot;</span> </span><br><span class="line">	<span class="keyword">exit</span></span><br><span class="line">	;;</span><br><span class="line">esac</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><p>语法 :</p><ul><li><p>shell中允许将<strong>一组命令集合</strong>或<strong>语句</strong>形成一段<strong>可用代码</strong></p></li><li><p>这些代码块称为shell函数给这段代码起个名字称为函数名，后续可以直接调用该段代码的功能</p></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">方法一：</span><br><span class="line"></span><br><span class="line">函数名()</span><br><span class="line">&#123;</span><br><span class="line">  函数体（一堆命令的集合，来实现某个功能）   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">方法二：</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> 函数名<span class="params">()</span></span></span><br><span class="line">&#123;</span><br><span class="line">   函数体（一堆命令的集合，来实现某个功能）</span><br><span class="line">   <span class="built_in">echo</span> hello</span><br><span class="line">   <span class="built_in">echo</span> world</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>函数中return说明:</strong></p><ol><li>return可以结束一个函数。类似于循环控制语句break(结束当前循环，执行循环体后面的代码)。</li><li>return默认返回函数中最后一个命令状态值，也可以给定参数值，范围是0-256之间。</li><li>如果没有return命令，函数将返回最后一个指令的退出状态值。</li></ol></blockquote><p><strong>2.1 当前命令行调用</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">fun_1()&#123;</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;调用fun_1函数就打印了我！！！&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun_2()&#123;</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;调用fun_2函数就打印了我！！！&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># cat demo.sh </span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">fun_1()&#123;</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;调用fun_1函数就打印了我！！！&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun_2()&#123;</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;调用fun_2函数就打印了我！！！&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># source demo.sh </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># fun_1</span></span><br><span class="line">调用fun_1函数就打印了我！！！</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># fun_2</span></span><br><span class="line">调用fun_2函数就打印了我！！！</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># </span></span><br></pre></td></tr></table></figure><p><strong>2.2 定义到用户的环境变量中</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.bashrc </span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">添加编写的函数：</span><br><span class="line"></span><br><span class="line">fun_1()&#123;</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;调用fun_1函数就打印了我！！！&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun_2()&#123;</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;调用fun_2函数就打印了我！！！&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">注：当用户打开 bash 的时候会读取该文件</span><br></pre></td></tr></table></figure><p><strong>2.3 脚本中调用</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env bash</span></span><br><span class="line">meue()&#123;</span><br><span class="line"><span class="built_in">echo</span> <span class="literal">-e</span> <span class="string">&quot;\033[32m</span></span><br><span class="line"><span class="string">################## 菜单栏 #########################</span></span><br><span class="line"><span class="string">#            f   显示磁盘分区                     #</span></span><br><span class="line"><span class="string">#            d   显示磁盘挂载                     #</span></span><br><span class="line"><span class="string">#            m   查看内存使用                     #</span></span><br><span class="line"><span class="string">#            u   查看系统负载                     #</span></span><br><span class="line"><span class="string">#            q   退出程序                         #</span></span><br><span class="line"><span class="string">###################################################</span></span><br><span class="line"><span class="string">\033[0m&quot;</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment"># 调用函数</span></span><br><span class="line">meue</span><br></pre></td></tr></table></figure><p><strong>2.4 需求</strong></p><ol><li>写一个脚本收集用户输入的基本信息(姓名，性别，年龄)，如不输入一直提示输入</li><li>最后根据用户的信息输出相对应的内容</li></ol><p><strong>思路：</strong></p><ol><li>交互式定义多个变量来保存用户信息 姓名、性别、年龄</li><li><p>如果不输一直提示输入</p><ul><li>循环==直到输入字符串不为空 while 判断输入字符串是否为空</li><li>每个信息都必须不能为空，该功能可以定义为一个函数，方便下面脚本调用</li></ul></li><li><p>根据用户输入信息做出匹配判断</p></li></ol><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env bash</span></span><br><span class="line">input_fun()</span><br><span class="line">&#123;</span><br><span class="line">	input_info=<span class="string">&quot;&quot;</span></span><br><span class="line">	output_info=<span class="variable">$1</span></span><br><span class="line">	<span class="keyword">while</span> [ -<span class="type">z</span> <span class="variable">$input_info</span> ]</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">		read <span class="literal">-p</span> <span class="string">&quot;<span class="variable">$output_info</span>&quot;</span> input_info</span><br><span class="line">	done</span><br><span class="line">	<span class="built_in">echo</span> <span class="variable">$input_info</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> true</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	name=<span class="variable">$</span>(input_fun 请输入您的姓名：)</span><br><span class="line">	<span class="keyword">if</span> [[ <span class="variable">$name</span> = <span class="string">&quot;exit&quot;</span> ]] ; then</span><br><span class="line">		<span class="keyword">exit</span></span><br><span class="line">	fi</span><br><span class="line">	gender=<span class="variable">$</span>(input_fun 请输入您的性别：)</span><br><span class="line">	age=<span class="variable">$</span>(input_fun 请输入您的年龄：)</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;name <span class="variable">$name</span> gender <span class="variable">$gender</span> age <span class="variable">$age</span>&quot;</span> | <span class="built_in">tee</span> <span class="literal">-a</span> stu_info.txt</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p><strong>2.5 需求</strong></p><ol><li>只允许yunwei用户通过跳板机远程连接后台的应用服务器做一些维护操作</li><li>公司运维人员远程通过yunwei用户连接跳板机时，跳出以下菜单供选择：</li></ol><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">欢迎使用 Jumper<span class="literal">-server</span> ，请选择你要操作的主机：</span><br><span class="line"><span class="number">1</span>. DB1<span class="literal">-Master</span></span><br><span class="line"><span class="number">2</span>. DB2<span class="literal">-Slave</span></span><br><span class="line"><span class="number">3</span>. Web1</span><br><span class="line"><span class="number">4</span>. Web2</span><br><span class="line"><span class="built_in">h</span>. help</span><br><span class="line">q. <span class="keyword">exit</span></span><br></pre></td></tr></table></figure><ol><li>当用户选择相应主机后，直接<strong>免密码登录</strong>成功</li><li>如果用户不输入一直提示用户输入，直到用户选择退出</li></ol><p><strong>综合分析</strong></p><ol><li>将脚本放到 yunwei 用户家目录里的.bashrc文件里（/root/yunwei/jump_server.sh）</li><li>将菜单定义为一个函数[打印菜单]，方便后面调用</li><li>用case语句来实现用户的选择【交互式定义变量】</li><li>当用户选择了某一台服务器后，进一步询问用户需要做的事情 case…esac 交互式定义变量</li><li>使用循环来实现用户不选择一直让其选择</li><li>限制用户退出后直接关闭终端 exit</li></ol><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment"># jumper-server</span></span><br><span class="line"><span class="comment"># 定义菜单打印功能的函数</span></span><br><span class="line">menu()</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="literal">-EOF</span></span><br><span class="line">欢迎使用Jumper<span class="literal">-server</span>，请选择你要操作的主机：</span><br><span class="line"><span class="number">1</span>. DB1<span class="literal">-Master</span></span><br><span class="line"><span class="number">2</span>. DB2<span class="literal">-Slave</span></span><br><span class="line"><span class="number">3</span>. Web1</span><br><span class="line"><span class="number">4</span>. Web2</span><br><span class="line"><span class="built_in">h</span>. help</span><br><span class="line">q. <span class="keyword">exit</span></span><br><span class="line">	EOF</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 屏蔽以下信号</span></span><br><span class="line"><span class="keyword">trap</span> <span class="string">&#x27;&#x27;</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">19</span></span><br><span class="line"><span class="comment"># 调用函数来打印菜单</span></span><br><span class="line">menu</span><br><span class="line"><span class="comment">#循环等待用户选择</span></span><br><span class="line"><span class="keyword">while</span> true</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="comment"># 菜单选择，case...esac语句</span></span><br><span class="line">read <span class="literal">-p</span> <span class="string">&quot;请选择你要访问的主机:&quot;</span> host</span><br><span class="line">case <span class="variable">$host</span> <span class="keyword">in</span></span><br><span class="line">	<span class="number">1</span>)</span><br><span class="line">	ssh root@<span class="number">10.1</span>.<span class="number">1.1</span></span><br><span class="line">	;;</span><br><span class="line">	<span class="number">2</span>)</span><br><span class="line">	ssh root@<span class="number">10.1</span>.<span class="number">1.2</span></span><br><span class="line">	;;</span><br><span class="line">	<span class="number">3</span>)</span><br><span class="line">	ssh root@<span class="number">10.1</span>.<span class="number">1.3</span></span><br><span class="line">	;;</span><br><span class="line">	<span class="built_in">h</span>)</span><br><span class="line">	<span class="built_in">clear</span>;menu</span><br><span class="line">	;;</span><br><span class="line">	q)</span><br><span class="line">	<span class="keyword">exit</span></span><br><span class="line">	;;</span><br><span class="line">esac</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">将脚本放到yunwei 用户家目录里的.bashrc里执行：每次启动体跳板机即运行脚本</span><br><span class="line">bash ~/jumper<span class="literal">-server</span>.sh</span><br><span class="line"><span class="keyword">exit</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>进一步完善需求</strong></p><p>为了进一步增强跳板机的安全性，工作人员通过跳板机访问生产环境，但是不能在跳板机上停留。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#公钥推送成功</span></span><br><span class="line"><span class="keyword">trap</span> <span class="string">&#x27;&#x27;</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">19</span></span><br><span class="line"><span class="comment">#打印菜单用户选择</span></span><br><span class="line">menu()&#123;</span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="literal">-EOF</span></span><br><span class="line">欢迎使用Jumper<span class="literal">-server</span>，请选择你要操作的主机：</span><br><span class="line"><span class="number">1</span>. DB1<span class="literal">-Master</span></span><br><span class="line"><span class="number">2</span>. DB2<span class="literal">-Slave</span></span><br><span class="line"><span class="number">3</span>. Web1</span><br><span class="line"><span class="number">4</span>. Web2</span><br><span class="line"><span class="built_in">h</span>. help</span><br><span class="line">q. <span class="keyword">exit</span></span><br><span class="line">EOF</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#调用函数来打印菜单</span></span><br><span class="line">menu</span><br><span class="line"><span class="keyword">while</span> true</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">read <span class="literal">-p</span> <span class="string">&quot;请输入你要选择的主机[h for help]：&quot;</span> host</span><br><span class="line"></span><br><span class="line"><span class="comment">#通过case语句来匹配用户所输入的主机</span></span><br><span class="line">case <span class="variable">$host</span> <span class="keyword">in</span></span><br><span class="line">	<span class="number">1</span>|DB1)</span><br><span class="line">	ssh root@<span class="number">10.1</span>.<span class="number">1.1</span></span><br><span class="line">	;;</span><br><span class="line">	<span class="number">2</span>|DB2)</span><br><span class="line">	ssh root@<span class="number">10.1</span>.<span class="number">1.2</span></span><br><span class="line">	;;</span><br><span class="line">	<span class="number">3</span>|web1)</span><br><span class="line">	ssh root@<span class="number">10.1</span>.<span class="number">1.250</span></span><br><span class="line">	;;</span><br><span class="line">	<span class="built_in">h</span>|help)</span><br><span class="line">	<span class="built_in">clear</span>;menu</span><br><span class="line">	;;</span><br><span class="line">	q|quit)</span><br><span class="line">	<span class="keyword">exit</span></span><br><span class="line">	;;</span><br><span class="line">esac</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">自己完善功能：</span><br><span class="line"><span class="number">1</span>. 用户选择主机后，需要事先推送公钥；如何判断公钥是否已推</span><br><span class="line"><span class="number">2</span>. 比如选择web1时，再次提示需要做的操作，比如：</span><br><span class="line">clean log</span><br><span class="line">重启服务</span><br><span class="line"><span class="built_in">kill</span>某个进程</span><br></pre></td></tr></table></figure><p><strong>回顾信号：</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>) SIGHUP 			重新加载配置    </span><br><span class="line"><span class="number">2</span>) SIGINT			键盘中断^C</span><br><span class="line"><span class="number">3</span>) SIGQUIT      	键盘退出</span><br><span class="line"><span class="number">9</span>) SIGKILL		 	强制终止</span><br><span class="line"><span class="number">15</span>) SIGTERM	    	终止（正常结束），缺省信号</span><br><span class="line"><span class="number">18</span>) SIGCONT	   	    继续</span><br><span class="line"><span class="number">19</span>) SIGSTOP	   	    停止</span><br><span class="line"><span class="number">20</span>) SIGTSTP     	暂停^Z</span><br></pre></td></tr></table></figure><h2 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h2><p><strong>语法</strong>：正则表达式（Regular Expression、regex 或 regexp，缩写为RE），也译为正规表示法、常规表示法，是一种字符模式，用于在查找过程中匹配指定的字符。许多程序设计语言都支持利用正则表达式进行字符串操作。例如，在Perl中就内建了一个功能强大的正则表达式引擎。正则表达式这个概念最初是由Unix中的工具软件（例如sed和grep）普及开的。支持正则表达式的程序如：locate |find| vim| grep| sed |awk</p><p><strong>作用：</strong>匹配邮箱、匹配身份证号码、手机号、银行卡号等匹配某些特定字符串，做特定处理等等</p><p><strong>正则当中名词解释</strong>：</p><ul><li><p><strong>元字符</strong></p><p>指那些在正则表达式中具有<strong>特殊意义的==专用字符==</strong>,如:点(.) 星(*) 问号(?)等</p></li><li><p><strong>前导字符</strong></p><p>位于<strong>元字符</strong>前面的字符. ab<strong>c*</strong> aoo<strong>o.</strong></p></li></ul><h4 id="1-1-正则中普通常用的元字符"><a href="#1-1-正则中普通常用的元字符" class="headerlink" title="1.1  正则中普通常用的元字符"></a>1.1 正则中普通常用的元字符</h4><div class="table-container"><table><thead><tr><th>元字符</th><th>功能</th><th>备注</th></tr></thead><tbody><tr><td>.</td><td>匹配除了换行符以外的任意单个字符</td><td></td></tr><tr><td>*</td><td>前导字符出现0次或连续多次</td><td></td></tr><tr><td>.*</td><td>任意长度字符</td><td>ab.*</td></tr><tr><td>^</td><td>行首(以…开头)</td><td>^root</td></tr><tr><td>$</td><td>行尾(以…结尾)</td><td>bash$</td></tr><tr><td>^$</td><td>空行</td><td></td></tr><tr><td>[]</td><td>匹配括号里任意单个字符或一组单个字符</td><td>[abc]</td></tr><tr><td><sup><a href="#fn_" id="reffn_"></a></sup></td><td>匹配不包含括号里任一单个字符或一组单个字符</td><td><sup><a href="#fn_abc" id="reffn_abc">abc</a></sup></td></tr><tr><td>^[]</td><td>匹配以括号里任意单个字符或一组单个字符开头</td><td>^[abc]</td></tr><tr><td>\^[\^]</td><td>匹配不以括号里任意单个字符或一组单个字符开头</td><td>\^[^abc]</td></tr></tbody></table></div><p>示例：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cat RegExpTest_02.txt</span></span><br><span class="line">ggle</span><br><span class="line">gogle</span><br><span class="line">google</span><br><span class="line">gooogle</span><br><span class="line">goooooogle</span><br><span class="line">gooooooogle</span><br><span class="line">taobao.com</span><br><span class="line">taotaobaobao.com</span><br><span class="line"></span><br><span class="line">jingdong.com</span><br><span class="line">dingdingdongdong.com</span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br><span class="line">Adfjd8789JHfdsdf/</span><br><span class="line">a87fdjfkdLKJK</span><br><span class="line"><span class="number">7</span>kdjfd989KJK;</span><br><span class="line">bSKJjkksdjf878.</span><br><span class="line">cidufKJHJ6576,</span><br><span class="line"></span><br><span class="line">hello world</span><br><span class="line">helloworld yourself</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.前导字符 g 后面任意字符出现</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep &quot;g.&quot; RegExpTest_02.txt</span></span><br><span class="line">ggle						<span class="comment"># 前导字符 g 后面任意字符出现一次   gg ...</span></span><br><span class="line">gogle						<span class="comment"># gogl ...</span></span><br><span class="line">google						<span class="comment"># go ... gl</span></span><br><span class="line">gooogle						<span class="comment"># go ... gl</span></span><br><span class="line">goooooogle					<span class="comment"># go ... gl</span></span><br><span class="line">gooooooogle					<span class="comment"># go ... gl</span></span><br><span class="line">jingdong.com				<span class="comment"># gd ... g.</span></span><br><span class="line">dingdingdongdong.com		<span class="comment"># gd ... gd ... gd ... g.</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>.前导字符 g 出现零次或多次</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep &quot;g*&quot; RegExpTest_02.txt</span></span><br><span class="line">ggle							<span class="comment"># 前导字符 g 出现 两次</span></span><br><span class="line">gogle							<span class="comment"># 前导字符 g 出现 一次</span></span><br><span class="line">google							<span class="comment"># ........</span></span><br><span class="line">gooogle</span><br><span class="line">goooooogle</span><br><span class="line">gooooooogle						<span class="comment"># .........</span></span><br><span class="line">taobao.com						<span class="comment"># 前导字符 g 出现 零次 未出现 g 即出现0次 符合</span></span><br><span class="line">taotaobaobao.com				<span class="comment"># 前导字符 g 出现 零次</span></span><br><span class="line">								<span class="comment"># 前导字符 g 出现 零次</span></span><br><span class="line">jingdong.com</span><br><span class="line">dingdingdongdong.com			<span class="comment"># 前导字符 g 出现 一次</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br><span class="line">Adfjd8789JHfdsdf/</span><br><span class="line">a87fdjfkdLKJK</span><br><span class="line"><span class="number">7</span>kdjfd989KJK;</span><br><span class="line">bSKJjkksdjf878.</span><br><span class="line">cidufKJHJ6576,</span><br><span class="line"></span><br><span class="line">hello world</span><br><span class="line">helloworld yourself</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>.  g 确定 前导字符 o 出现零次或多次</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep &quot;go*&quot; RegExpTest_02.txt </span></span><br><span class="line">ggle							<span class="comment"># g 确定 前导字符 o 出现零次</span></span><br><span class="line">gogle							<span class="comment"># g 确定 前导字符 o 出现一次；g 确定 前导字符 o 出现零次</span></span><br><span class="line">google							<span class="comment"># g 确定 前导字符 o 出现两次；g 确定 前导字符 o 出现零次</span></span><br><span class="line">gooogle							<span class="comment"># g 确定 前导字符 o 出现三次；g 确定 前导字符 o 出现零次</span></span><br><span class="line">goooooogle						<span class="comment"># g 确定 前导字符 o 出现六次；g 确定 前导字符 o 出现零次</span></span><br><span class="line">gooooooogle						<span class="comment"># g 确定 前导字符 o 出现八次；g 确定 前导字符 o 出现零次</span></span><br><span class="line">jingdong.com					<span class="comment"># g 确定 前导字符 o 出现零次</span></span><br><span class="line">dingdingdongdong.com			<span class="comment"># g 确定 前导字符 o 出现零次</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span>. 以 g 开头的行</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep &quot;^g&quot; RegExpTest_02.txt</span></span><br><span class="line">ggle						<span class="comment"># 以 g 开头的行</span></span><br><span class="line">gogle						<span class="comment"># 以 g 开头的行					</span></span><br><span class="line">google						</span><br><span class="line">gooogle						<span class="comment"># 以 g 开头的行</span></span><br><span class="line">goooooogle</span><br><span class="line">gooooooogle</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span>. 以 g 开头的后面的有一个字符</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep &quot;^g.&quot; RegExpTest_02.txt</span></span><br><span class="line">ggle</span><br><span class="line">gogle</span><br><span class="line">google</span><br><span class="line">gooogle</span><br><span class="line">goooooogle</span><br><span class="line">gooooooogle</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6</span>.以 g 开头的字符 前导字符是任意的后面一个字符 任意字符 出现一次或者多次</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep &quot;^g.*&quot; RegExpTest_02.txt </span></span><br><span class="line">ggle</span><br><span class="line">gogle</span><br><span class="line">google</span><br><span class="line">gooogle</span><br><span class="line">goooooogle</span><br><span class="line">gooooooogle</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">7</span>.前导字符为 空 后面有任意字符，这个任意字符出现一次或者多次，以 gle 结尾</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep &quot;.*gle$&quot; RegExpTest_02.txt </span></span><br><span class="line">ggle</span><br><span class="line">gogle</span><br><span class="line">google</span><br><span class="line">gooogle</span><br><span class="line">goooooogle</span><br><span class="line">gooooooogle</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">8</span>.查看空行</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep -n &quot;^$&quot; RegExpTest_02.txt </span></span><br><span class="line"><span class="number">11</span>:</span><br><span class="line"><span class="number">20</span>:</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">9</span>.匹配 [<span class="type">ogl</span>] 中的 o 或 g 或 l</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep &quot;[ogl]&quot; RegExpTest_02.txt </span></span><br><span class="line">g</span><br><span class="line">gle</span><br><span class="line">ggle</span><br><span class="line">gogle</span><br><span class="line">google</span><br><span class="line">gooogle</span><br><span class="line">goooooogle</span><br><span class="line">gooooooogle</span><br><span class="line">taobao.com</span><br><span class="line">taotaobaobao.com</span><br><span class="line">jingdong.com</span><br><span class="line">dingdingdongdong.com</span><br><span class="line">hello world</span><br><span class="line">helloworld yourself</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">10</span>.匹配除了 o g l 以外的字符 不包含 空</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep &quot;[^ogl]&quot; RegExpTest_02.txt </span></span><br><span class="line">gle</span><br><span class="line">ggle</span><br><span class="line">gogle</span><br><span class="line">google</span><br><span class="line">gooogle</span><br><span class="line">goooooogle</span><br><span class="line">gooooooogle</span><br><span class="line">taobao.com</span><br><span class="line">taotaobaobao.com</span><br><span class="line">jingdong.com</span><br><span class="line">dingdingdongdong.com</span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br><span class="line">Adfjd8789JHfdsdf/</span><br><span class="line">a87fdjfkdLKJK</span><br><span class="line"><span class="number">7</span>kdjfd989KJK;</span><br><span class="line">bSKJjkksdjf878.</span><br><span class="line">cidufKJHJ6576,</span><br><span class="line">hello world</span><br><span class="line">helloworld yourself</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">11</span>.匹配 [<span class="type">gh</span>] 任意单个字符开头的</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep &quot;^[gh]&quot; RegExpTest_02.txt </span></span><br><span class="line">g</span><br><span class="line">gle</span><br><span class="line">ggle</span><br><span class="line">gogle</span><br><span class="line">google</span><br><span class="line">gooogle</span><br><span class="line">goooooogle</span><br><span class="line">gooooooogle</span><br><span class="line">hello world</span><br><span class="line">helloworld yourself</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">12</span>.查看 profile 的前<span class="number">20</span>行，行过滤 不以 <span class="comment"># 开头的</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># head -20 /etc/profile | grep &quot;^[^#]&quot;</span></span><br><span class="line">pathmunge () &#123;</span><br><span class="line">    case <span class="string">&quot;:<span class="variable">$</span>&#123;PATH&#125;:&quot;</span> <span class="keyword">in</span></span><br><span class="line">        *:<span class="string">&quot;<span class="variable">$1</span>&quot;</span>:*)</span><br><span class="line">            ;;</span><br><span class="line">        *)</span><br><span class="line">            <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$2</span>&quot;</span> = <span class="string">&quot;after&quot;</span> ] ; then</span><br><span class="line">                PATH=<span class="variable">$PATH:</span><span class="variable">$1</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                PATH=<span class="variable">$1:</span><span class="variable">$PATH</span></span><br><span class="line">            fi</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">13</span>.查看 RegExpTest_02.txt 的前 <span class="number">10</span> 行 行过滤不以 go 开头的</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># head -10 RegExpTest_02.txt | grep -v  &quot;^go&quot;  </span></span><br><span class="line">g</span><br><span class="line">gle</span><br><span class="line">ggle</span><br><span class="line">taobao.com</span><br><span class="line">taotaobaobao.com</span><br></pre></td></tr></table></figure><h4 id="1-2-正则中其他常用元字符"><a href="#1-2-正则中其他常用元字符" class="headerlink" title="1.2  正则中其他常用元字符"></a>1.2 正则中其他常用元字符</h4><div class="table-container"><table><thead><tr><th>元字符</th><th>功能</th><th>备注</th></tr></thead><tbody><tr><td>\&lt;</td><td>取单词的头</td><td></td></tr><tr><td>\&gt;</td><td>取单词的尾</td><td></td></tr><tr><td>\&lt; \&gt;</td><td>精确匹配</td><td></td></tr><tr><td>\{n\}</td><td>匹配前导字符 连续出现n次</td><td></td></tr><tr><td>\{n,\}</td><td>匹配前导字符 至少出现n次</td><td></td></tr><tr><td>\{n,m\}</td><td>匹配前导字符出现 n次与m次之间</td><td></td></tr><tr><td>\( \)</td><td>保存被匹配的字符</td><td></td></tr><tr><td>\d</td><td>匹配数字（<strong>grep -P</strong>）</td><td>[0-9]</td></tr><tr><td>\w</td><td>匹配字母数字下划线（<strong>grep -P</strong>）</td><td>[a-zA-Z0-9_]</td></tr><tr><td>\s</td><td>匹配空格、制表符、换页符（<strong>grep -P</strong>）</td><td>[\t\r\n]</td></tr></tbody></table></div><p><strong>举例说明：</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.匹配单词的头以 hel 开头的</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep &quot;\&lt;hel&quot; RegExpTest_02.txt </span></span><br><span class="line"><span class="comment"># helloworld yourself01</span></span><br><span class="line">hello world</span><br><span class="line">helloworld yourself</span><br><span class="line"><span class="comment"># helloworld yourself02</span></span><br><span class="line"><span class="comment"># helloworld yourself03</span></span><br><span class="line"><span class="comment"># helloworld yourself04</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>.精确匹配文件中 只是 g 的行</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep &quot;\&lt;g\&gt;&quot; RegExpTest_02.txt </span></span><br><span class="line">g</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>. g 确定，前导字符 o 出现两次</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep &quot;go\&#123;2\&#125;&quot; RegExpTest_02.txt </span></span><br><span class="line">google</span><br><span class="line">gooogle</span><br><span class="line">goooooogle</span><br><span class="line">gooooooogle</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span>.前导字符 o 出现两次</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep &quot;o\&#123;2\&#125;&quot; RegExpTest_02.txt </span></span><br><span class="line">google</span><br><span class="line">gooogle</span><br><span class="line">goooooogle</span><br><span class="line">gooooooogle</span><br><span class="line"></span><br><span class="line">注：此语法可看作 oo 作为整体出现的次数，gogle 则匹配不到，gooole 则只有前两个oo 高亮</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span>. 前导字符 o 出现至少 <span class="number">2</span> 次</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep &quot;o\&#123;2,\&#125;&quot; RegExpTest_02.txt </span></span><br><span class="line">google</span><br><span class="line">gooogle</span><br><span class="line">goooooogle</span><br><span class="line">gooooooogle</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6</span>.匹配 ip <span class="number">10</span>即[<span class="number">0</span>-<span class="number">9</span>]出现两次； . 需要转义；<span class="number">1</span> 即[<span class="number">0</span>-<span class="number">9</span>] 出现一次</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep &quot;[0-9]\&#123;2\&#125;\.[0-9]\&#123;1\&#125;.[0-9]\&#123;1\&#125;.[0-9]\&#123;1\&#125;&quot; RegExpTest_02.txt </span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">7</span>.改<span class="number">10.1</span>.<span class="number">1.1</span> 为<span class="number">10.1</span>.<span class="number">1.254</span></span><br><span class="line">vim 的末行模式 输入 :%s/\(<span class="number">10.1</span>.<span class="number">1</span>\).<span class="number">1</span>/\<span class="number">1.254</span>/g</span><br><span class="line">解释：%s 全局搜索</span><br><span class="line">	 （<span class="number">10.1</span>.<span class="number">1</span>）将此打包起来</span><br><span class="line">	  <span class="number">1.254</span>  <span class="number">1</span> 是标签名</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed/f495/20230523184823.png" alt=""><br><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed/f495/20230523185723.png" alt=""><br></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">8</span>.修改 helloworld yourself 为 hiworld myself</span><br><span class="line"></span><br><span class="line">vim 的末行模式</span><br><span class="line">:%s/hello\(world \)your\(self\)/hi\<span class="number">1</span>my\<span class="number">2</span>/g</span><br></pre></td></tr></table></figure><br><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed/f495/20230523190437.png" alt=""><p></p><h4 id="1-3-扩展类正则常用元字符"><a href="#1-3-扩展类正则常用元字符" class="headerlink" title="1.3 扩展类正则常用元字符"></a>1.3 扩展类正则常用元字符</h4><p><strong>语法：</strong></p><ul><li>grep你要用我，必须加 <code>grep -E</code>或者 让使用<code>egrep</code></li><li>sed你要用我，必须加 <code>sed -r</code></li></ul><div class="table-container"><table><thead><tr><th>扩展元字符</th><th>功能</th><th>备注</th></tr></thead><tbody><tr><td>+</td><td>匹配一个或多个前导字符</td><td>bo+ 匹配boo、 bo</td></tr><tr><td>?</td><td>匹配零个或一个前导字符</td><td>bo? 匹配b、 bo</td></tr><tr><td>\</td><td></td><td>或</td><td>匹配a或b</td></tr><tr><td>()</td><td>组字符（看成整体）</td><td>(my\</td><td>your)self：表示匹配myself或匹配yourself</td></tr><tr><td>{n}</td><td>前导字符重复n次</td><td></td></tr><tr><td>{n,}</td><td>前导字符重复至少n次</td><td></td></tr><tr><td>{n,m}</td><td>前导字符重复n到m次</td></tr></tbody></table></div><p><strong>举例说明：</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. g 固定，前导字符 o 出现一次或者多次，和 go* 区别 后者可以出现零次</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep -E &quot;go+&quot; RegExpTest_02.txt</span></span><br><span class="line">gogle</span><br><span class="line">google</span><br><span class="line">gooogle</span><br><span class="line">goooooogle</span><br><span class="line">gooooooogle</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>. g 固定，前导字符 o 出现零次或者一次</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep -E &quot;go?&quot; RegExpTest_02.txt</span></span><br><span class="line">g</span><br><span class="line">gle</span><br><span class="line">ggle</span><br><span class="line">gogle</span><br><span class="line">google</span><br><span class="line">gooogle</span><br><span class="line">goooooogle</span><br><span class="line">gooooooogle</span><br><span class="line">jingdong.com</span><br><span class="line">dingdingdongdong.com</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>. g  是固定的，前导字符是后面任意一个字符 出现零次或者一次（注：就是匹配 g 后面是任意一个字符，如 go 和 <span class="built_in">gl</span> 是相同的）</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep -E &quot;g.?&quot; RegExpTest_02.txt</span></span><br><span class="line">g								<span class="comment"># 前导字符 g 后空字符出现零次</span></span><br><span class="line">gle								<span class="comment"># 前导字符 g 后面字符 l 出现一次</span></span><br><span class="line">ggle							</span><br><span class="line">gogle</span><br><span class="line">google</span><br><span class="line">gooogle</span><br><span class="line">goooooogle</span><br><span class="line">gooooooogle</span><br><span class="line">jingdong.com</span><br><span class="line">dingdingdongdong.com</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span>.匹配以 a 或者 以 b 的行 </span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep -E &quot;^a|^b&quot; RegExpTest_02.txt</span></span><br><span class="line">a87fdjfkdLKJK</span><br><span class="line">bSKJjkksdjf878.</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span>.匹配以 a 开头的 或者 含有 b 的行</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep -E &quot;^a|b&quot; RegExpTest_02.txt</span></span><br><span class="line">taobao.com</span><br><span class="line">taotaobaobao.com</span><br><span class="line">a87fdjfkdLKJK</span><br><span class="line">bSKJjkksdjf878.</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6</span>.过滤 ao 或者 bo</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep -E &quot;(a|b)o&quot; RegExpTest_02.txt</span></span><br><span class="line">taobao.com</span><br><span class="line">taotaobaobao.com</span><br><span class="line">ao87fdjfkdLKJK</span><br><span class="line"><span class="number">7</span>kdjafd9bo89aoKJK;</span><br><span class="line">boSKaJjkksdajf878.</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">7</span>.作用与 不加 \ 的效果相同</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep  &quot;go\&#123;2\&#125;&quot; RegExpTest_02.txt</span></span><br><span class="line">google</span><br><span class="line">gooogle</span><br><span class="line">goooooogle</span><br><span class="line">gooooooogle</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep -E &quot;go&#123;2&#125;&quot; RegExpTest_02.txt</span></span><br><span class="line">google</span><br><span class="line">gooogle</span><br><span class="line">goooooogle</span><br><span class="line">gooooooogle</span><br></pre></td></tr></table></figure><h4 id="1-4-第二类正则"><a href="#1-4-第二类正则" class="headerlink" title="1.4 第二类正则"></a>1.4 第二类正则</h4><div class="table-container"><table><thead><tr><th>表达式</th><th>功能</th><th>示例</th></tr></thead><tbody><tr><td>[:alnum:]</td><td>字母与数字字符</td><td>[[:alnum:]]+</td></tr><tr><td>[:alpha:]</td><td>字母字符(包括大小写字母)</td><td>[[:alpha:]]{4}</td></tr><tr><td>[:blank:]</td><td>空格与制表符</td><td>[[:blank:]]*</td></tr><tr><td>[:digit:]</td><td>数字</td><td>[[:digit:]]?</td></tr><tr><td>[:lower:]</td><td>小写字母</td><td>[[:lower:]]{4,}</td></tr><tr><td>[:upper:]</td><td>大写字母</td><td>[[:upper:]]+</td></tr><tr><td>[:punct:]</td><td>标点符号</td><td>[[:punct:]]</td></tr><tr><td>[:space:]</td><td>包括换行符，回车等在内的所有空白</td><td>[[:space:]]+</td></tr></tbody></table></div><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.数字连续出现<span class="number">4</span>次 （注：[:<span class="type">lower</span>:] 不可以有空格）</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># grep -E &quot;[[:digit:]]&#123;4&#125;&quot; RegExpTest_02.txt</span></span><br><span class="line">Adfjd8789JHfdsdf/</span><br><span class="line">cidufaKoJHJ6576,</span><br></pre></td></tr></table></figure><h2 id="正则字符一览表"><a href="#正则字符一览表" class="headerlink" title="正则字符一览表"></a>正则字符一览表</h2><p><strong>元字符</strong>：在正则中，具有特殊意义的专用字符，如: 星号(*)、加号(+)等</p><p><strong>前导字符</strong>：元字符前面的字符叫前导字符</p><div class="table-container"><table><thead><tr><th>元字符</th><th>功能</th><th>示例</th></tr></thead><tbody><tr><td>*</td><td>前导字符出现0次或者连续多次</td><td>ab* abbbb</td></tr><tr><td>.</td><td>除了换行符以外，任意单个字符</td><td>ab. ab8 abu</td></tr><tr><td>.*</td><td>任意长度的字符</td><td>ab.* adfdfdf</td></tr><tr><td>[]</td><td>括号里的任意单个字符或一组单个字符</td><td>[abc][0-9][a-z]</td></tr><tr><td><sup><a href="#fn_" id="reffn_"></a></sup></td><td>不匹配括号里的任意单个字符或一组单个字符</td><td><sup><a href="#fn_abc" id="reffn_abc">abc</a></sup></td></tr><tr><td>^[]</td><td>匹配以括号里的任意单个字符开头</td><td>^[abc]</td></tr><tr><td>\^<sup><a href="#fn_" id="reffn_"></a></sup></td><td>不匹配以括号里的任意单个字符开头</td><td></td></tr><tr><td>^</td><td>行的开头</td><td>^root</td></tr><tr><td>$</td><td>行的结尾</td><td>bash$</td></tr><tr><td>^$</td><td>空行</td><td></td></tr><tr><td>\{n\}和{n}</td><td>前导字符连续出现n次</td><td>[0-9]\{3\}</td></tr><tr><td>\{n,\}和{n,}</td><td>前导字符至少出现n次</td><td>[a-z]{4,}</td></tr><tr><td>\{n,m\}和{n,m}</td><td>前导字符连续出现n-m次</td><td>go{2,4}</td></tr><tr><td>\&lt;\&gt;</td><td>精确匹配单词</td><td>\<hello \\></hello></td></tr><tr><td>\(\)</td><td>保留匹配到的字符</td><td>\(hello\)</td></tr><tr><td>+</td><td>前导字符出现1次或者多次</td><td>[0-9]+</td></tr><tr><td>?</td><td>前导字符出现0次或者1次</td><td>go?</td></tr><tr><td>\</td><td></td><td>或</td><td>\^root\</td><td>\^ftp</td></tr><tr><td>()</td><td>组字符</td><td>(hello\</td><td>world)123</td></tr><tr><td>\d</td><td>perl内置正则</td><td>grep -P \d+</td></tr><tr><td>\w</td><td>匹配字母数字下划线</td></tr></tbody></table></div><h4 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">文件准备：</span><br><span class="line">vim test.txt</span><br><span class="line"></span><br><span class="line">Aieur45869Root0000</span><br><span class="line"><span class="number">9</span>h847RkjfkIIIhello</span><br><span class="line">rootHllow88000dfjj</span><br><span class="line"><span class="number">8</span>ikuioerhfhupliooking</span><br><span class="line">hello world</span><br><span class="line"><span class="number">192.168</span>.<span class="number">0.254</span></span><br><span class="line">welcome to uplooking.</span><br><span class="line">abcderfkdjfkdtest</span><br><span class="line">rlllA899kdfkdfj</span><br><span class="line">iiiA848890ldkfjdkfj</span><br><span class="line">abc</span><br><span class="line"><span class="number">12345678908374</span></span><br><span class="line"><span class="number">123456</span>@qq.com</span><br><span class="line"><span class="number">123456</span>@<span class="number">163</span>.com</span><br><span class="line">abcdefg@itcast.com23ed</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、查找不以大写字母开头的行（三种写法）。</span><br><span class="line">grep <span class="string">&#x27;^[^A-Z]&#x27;</span> RegExpTest_01.txt </span><br><span class="line">grep <span class="literal">-v</span> <span class="string">&quot;^[A-Z]&quot;</span> RegExpTest_01.txt </span><br><span class="line">grep <span class="literal">-v</span> <span class="string">&quot;\&lt;[A-Z]&quot;</span> RegExpTest_01.txt </span><br><span class="line">grep <span class="literal">-E</span> <span class="literal">-v</span> <span class="string">&quot;^[[:upper:]]&quot;</span> RegExpTest_01.txt    &lt;<span class="literal">---</span>&gt;   <span class="string">&#x27;^[^[:upper:]]&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、查找有数字的行（两种写法）</span><br><span class="line">grep <span class="string">&#x27;[0-9]&#x27;</span> RegExpTest_01.txt </span><br><span class="line">grep <span class="literal">-P</span>  <span class="string">&quot;\d&quot;</span> RegExpTest_01.txt </span><br><span class="line">grep <span class="literal">-E</span> <span class="string">&quot;[[:digit:]]&quot;</span> RegExpTest_01.txt</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、查找一个数字和一个字母连起来的</span><br><span class="line">grep <span class="literal">-E</span> <span class="string">&#x27;[0-9][a-zA-Z]|[a-zA-Z][0-9]&#x27;</span> RegExpTest_01.txt </span><br><span class="line"></span><br><span class="line"><span class="number">4</span>、查找不以<span class="built_in">r</span>开头的行</span><br><span class="line">grep <span class="literal">-v</span> <span class="string">&#x27;^r&#x27;</span> RegExpTest_01.txt </span><br><span class="line">grep <span class="string">&#x27;^[^r]&#x27;</span> RegExpTest_01.txt </span><br><span class="line"></span><br><span class="line"><span class="number">5</span>、查找以数字开头的</span><br><span class="line">grep <span class="string">&#x27;^[0-9]&#x27;</span> RegExpTest_01.txt </span><br><span class="line">grep <span class="literal">-E</span> <span class="string">&#x27;^[[:digit:]]&#x27;</span> RegExpTest_01.txt </span><br><span class="line"></span><br><span class="line"><span class="number">6</span>、查找以大写字母开头的</span><br><span class="line">grep <span class="string">&#x27;^[A-Z]&#x27;</span> RegExpTest_01.txt </span><br><span class="line">grep <span class="literal">-E</span> <span class="string">&quot;^[[:upper:]]&quot;</span> RegExpTest_01.txt </span><br><span class="line"></span><br><span class="line"><span class="number">7</span>、查找以小写字母开头的</span><br><span class="line">grep <span class="string">&#x27;^[a-z]&#x27;</span> RegExpTest_01.txt </span><br><span class="line">grep <span class="literal">-E</span> <span class="string">&quot;^[[:lower:]]&quot;</span> RegExpTest_01.txt </span><br><span class="line"></span><br><span class="line"><span class="number">8</span>、查找以点结束的</span><br><span class="line">grep <span class="string">&#x27;\.$&#x27;</span> RegExpTest_01.txt </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">9</span>、去掉空行</span><br><span class="line">grep <span class="string">&#x27;^[^$]&#x27;</span> RegExpTest_01.txt </span><br><span class="line"></span><br><span class="line"><span class="number">10</span>、查找完全匹配abc的行</span><br><span class="line">grep <span class="string">&#x27;\&lt;abc\&gt;&#x27;</span> RegExpTest_01.txt </span><br><span class="line">grep <span class="literal">-w</span> <span class="string">&#x27;abc&#x27;</span> RegExpTest_01.txt </span><br><span class="line"></span><br><span class="line"><span class="number">11</span>、查找A后有三个数字的行</span><br><span class="line">grep <span class="string">&#x27;A[0-9][0-9][0-9]&#x27;</span> RegExpTest_01.txt </span><br><span class="line">grep  <span class="string">&#x27;A[0-9]\&#123;3\&#125;&#x27;</span> RegExpTest_01.txt </span><br><span class="line">grep <span class="literal">-E</span> <span class="string">&#x27;A([0-9])&#123;3&#125;&#x27;</span> RegExpTest_01.txt </span><br><span class="line"></span><br><span class="line"><span class="number">12</span>、统计root在/etc/passwd里出现了几次</span><br><span class="line">grep <span class="literal">-o</span> <span class="string">&#x27;root&#x27;</span> /etc/passwd | wc <span class="literal">-l</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">13</span>、用正则表达式找出自己的IP地址、广播地址、子网掩码</span><br><span class="line">ifconfig ens33 | grep <span class="literal">-o</span> <span class="string">&#x27;[0-9]\&#123;1,3\&#125;\.[0-9]\&#123;1,3\&#125;\.[0-9]\&#123;1,3\&#125;\.[0-9]\&#123;1,3\&#125;&#x27;</span></span><br><span class="line">ifconfig | grep <span class="string">&quot;broadcast&quot;</span> | grep <span class="literal">-o</span> <span class="literal">-E</span> <span class="string">&#x27;([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;&#x27;</span></span><br><span class="line">ifconfig ens33 | grep <span class="literal">-o</span> <span class="literal">-P</span> <span class="string">&#x27;(\d&#123;1,3&#125;\.)&#123;3&#125;\d&#123;1,3&#125;&#x27;</span></span><br><span class="line">ifconfig ens33 | grep <span class="literal">-o</span> <span class="literal">-P</span> <span class="string">&#x27;\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">14</span>、找出文件中的ip地址</span><br><span class="line"><span class="built_in">cat</span> /etc/sysconfig/network<span class="literal">-scripts</span>/ifcfg<span class="literal">-ens33</span> | grep <span class="string">&quot;IPADDR&quot;</span> | cut <span class="literal">-d</span> <span class="string">&quot;=&quot;</span> <span class="literal">-f2</span> </span><br><span class="line"></span><br><span class="line"><span class="number">15</span>、找出全部是数字的行</span><br><span class="line">grep <span class="literal">-E</span> <span class="string">&#x27;^[0-9]+$&#x27;</span> RegExpTest_01.txt </span><br><span class="line">grep <span class="literal">-E</span> <span class="literal">-v</span>  <span class="string">&quot;[[:alpha:]|[:punct:]|[:space:]]&quot;</span> RegExpTest_01.txt  | grep <span class="literal">-v</span> <span class="string">&quot;^<span class="variable">$</span>&quot;</span></span><br><span class="line">grep <span class="literal">-E</span> <span class="literal">-v</span>  <span class="string">&quot;[[:alpha:]|[:punct:]|[:space:]]&quot;</span> RegExpTest_01.txt  | grep <span class="string">&quot;[0-9].&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">16</span>、找出邮箱地址</span><br><span class="line">grep <span class="literal">-E</span> <span class="string">&#x27;^([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]&#123;2,5&#125;)$&#x27;</span> RegExpTest_01.txt</span><br><span class="line">grep <span class="literal">-E</span>  <span class="string">&quot;([0-9]|[A-Z]|[a-z]|[._-])+@([0-9]|[A-Z]|[a-z]|[._-])+\.([A-Z]|[a-z])+<span class="variable">$</span>&quot;</span> RegExpTest_01.txt</span><br><span class="line"></span><br><span class="line">grep <span class="literal">--help</span>:</span><br><span class="line">匹配模式选择：</span><br><span class="line">Regexp selection and interpretation:</span><br><span class="line">  <span class="literal">-E</span>, <span class="literal">--extended-regexp</span>     扩展正则</span><br><span class="line">  <span class="literal">-G</span>, <span class="literal">--basic-regexp</span>        基本正则</span><br><span class="line">  <span class="literal">-P</span>, <span class="literal">--perl-regexp</span>         调用perl的正则</span><br><span class="line">  <span class="literal">-e</span>, <span class="literal">--regexp</span>=PATTERN      use PATTERN <span class="keyword">for</span> matching</span><br><span class="line">  <span class="operator">-f</span>, <span class="literal">--file</span>=FILE           obtain PATTERN from FILE</span><br><span class="line">  <span class="literal">-i</span>, <span class="literal">--ignore-case</span>         忽略大小写</span><br><span class="line">  <span class="literal">-w</span>, <span class="literal">--word-regexp</span>         匹配整个单词</span><br></pre></td></tr></table></figure><h2 id="脚本搭建Web服务"><a href="#脚本搭建Web服务" class="headerlink" title="脚本搭建Web服务"></a>脚本搭建Web服务</h2><h4 id="脚本搭建web服务"><a href="#脚本搭建web服务" class="headerlink" title="脚本搭建web服务"></a>脚本搭建web服务</h4><p><strong>要求如下</strong>：</p><ol><li>用户输入web服务器的IP、域名以及数据根目录</li><li>如果用户不输入则一直提示输入，直到输入为止</li><li>当访问www.test.cc时可以访问到数据根目录里的首页文件“this is test page”</li></ol><p><strong>参考脚本：</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">参考：</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">conf=/etc/httpd/conf/httpd.conf</span><br><span class="line">input_fun()</span><br><span class="line">&#123;</span><br><span class="line">  input_var=<span class="string">&quot;&quot;</span></span><br><span class="line">  output_var=<span class="variable">$1</span></span><br><span class="line">  <span class="keyword">while</span> [ -<span class="type">z</span> <span class="variable">$input_var</span> ]</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">	read <span class="literal">-p</span> <span class="string">&quot;<span class="variable">$output_var</span>&quot;</span> input_var</span><br><span class="line">	done</span><br><span class="line">	<span class="built_in">echo</span> <span class="variable">$input_var</span></span><br><span class="line">&#125;</span><br><span class="line">ipaddr=<span class="variable">$</span>(input_fun <span class="string">&quot;Input Host ip[192.168.0.1]:&quot;</span>)</span><br><span class="line">web_host_name=<span class="variable">$</span>(input_fun <span class="string">&quot;Input VirtualHostName [www.test.cc]:&quot;</span>)</span><br><span class="line">root_dir=<span class="variable">$</span>(input_fun <span class="string">&quot;Input host Documentroot dir:[/var/www/html]:&quot;</span>)</span><br><span class="line"></span><br><span class="line">[ ! -<span class="type">d</span> <span class="variable">$root_dir</span> ] &amp;&amp; mkdir <span class="literal">-p</span> <span class="variable">$root_dir</span></span><br><span class="line">chown apache.apache <span class="variable">$root_dir</span> &amp;&amp; chmod <span class="number">755</span> <span class="variable">$root_dir</span></span><br><span class="line"><span class="built_in">echo</span> this is <span class="variable">$web_host_name</span> &gt; <span class="variable">$root_dir</span>/index.html</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$ipaddr</span> <span class="variable">$web_host_name</span>&quot;</span> &gt;&gt; /etc/hosts</span><br><span class="line"></span><br><span class="line">[ -<span class="type">f</span> <span class="variable">$conf</span> ] &amp;&amp; <span class="built_in">cat</span> &gt;&gt; <span class="variable">$conf</span> &lt;&lt;<span class="keyword">end</span></span><br><span class="line">NameVirtualHost <span class="variable">$ipaddr:80</span></span><br><span class="line">&lt;VirtualHost <span class="variable">$ipaddr:80</span>&gt;</span><br><span class="line">	ServerAdmin webmaster<span class="selector-tag">@</span><span class="variable">$web_host_name</span></span><br><span class="line">	DocumentRoot <span class="variable">$root_dir</span></span><br><span class="line">	ServerName <span class="variable">$web_host_name</span></span><br><span class="line">	ErrorLog logs/<span class="variable">$web_host_name</span><span class="literal">-error_log</span></span><br><span class="line">	CustomLog logs/<span class="variable">$web_host_name</span><span class="literal">-access_loh</span> common</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h2 id="sed-用法"><a href="#sed-用法" class="headerlink" title="sed 用法"></a>sed 用法</h2><blockquote><p>sed 是 Stream Editor（流编辑器）的缩写，简称流编辑器；用来 处理文件 的。</p><p>sed 是一行一行读取文件内容并按照要求进行处理，把处理后的结果输出到屏幕。</p></blockquote><ul><li><p>首先sed读取文件中的一行内容，把其保存在一个临时缓存区中（也称为模式空间）</p></li><li><p>然后根据需求处理临时缓冲区中的行，完成后把该行发送到屏幕上</p></li></ul><p><strong>总结：</strong></p><ol><li>由于sed把每一行都存在临时缓冲区中，对这个<strong>副本</strong>进行编辑，所以不会直接修改原文件</li><li>Sed主要用来自动编辑一个或多个文件；简化对文件的反复操作,对文件进行过滤和转换操作</li></ol><h4 id="命令行格式"><a href="#命令行格式" class="headerlink" title="命令行格式"></a>命令行格式</h4><p>语法：sed [options] <strong>‘</strong>处理动作<strong>‘</strong> 文件名 (注：一定是单引号 )</p><p>sed [options] <strong>‘处理动作’</strong> 文件名</p><ul><li><strong>常用选项</strong></li></ul><div class="table-container"><table><thead><tr><th>选项</th><th>说明</th><th>备注</th></tr></thead><tbody><tr><td>-e</td><td>进行多项(多次)编辑</td><td></td></tr><tr><td>-n</td><td>取消默认输出</td><td>不自动打印模式空间</td></tr><tr><td>-r</td><td>使用扩展正则表达式</td><td></td></tr><tr><td>-i</td><td>原地编辑（修改源文件）</td><td></td></tr><tr><td>-f</td><td>指定sed脚本的文件名</td><td>sed [options] ==<strong>‘</strong>==处理动作<strong>==’==</strong> 文件名</td></tr></tbody></table></div><ul><li><strong>常见处理动作</strong></li></ul><blockquote><p>以下所有的动作都要在<strong>单引号</strong>里</p></blockquote><div class="table-container"><table><thead><tr><th>动作</th><th>说明</th><th>备注</th></tr></thead><tbody><tr><td>‘p’</td><td>打印</td><td></td></tr><tr><td>‘i’</td><td>在指定行之前插入内容</td><td>类似vim里的大写O</td></tr><tr><td>‘a’</td><td>在指定行之后插入内容</td><td>类似vim里的小写o</td></tr><tr><td>‘c’</td><td>替换指定行所有内容</td><td></td></tr><tr><td>‘d’</td><td>删除指定行</td></tr></tbody></table></div><p><strong>1.1 例子</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">vim sed_test.txt</span><br><span class="line"></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line"><span class="number">298374837483</span></span><br><span class="line"><span class="number">172.16</span>.<span class="number">0.254</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br></pre></td></tr></table></figure><p><strong>1.1.1 对文件进行增、删、改、查操作</strong></p><blockquote><p>语法：sed 选项 <strong>‘定位+命令’</strong> 需要处理的文件</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. 不加处理动作，打印文件的内容</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed &#x27;&#x27; sed_test.txt</span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line"><span class="number">298374837483</span></span><br><span class="line"><span class="number">172.16</span>.<span class="number">0.254</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>.按照处理流程，会一行一行执行代码，第一次的打印指运行此行时打印出来与代码要求无关，第二次打印指代码此行要求打印（注：简单理解为第一行时sed处理的内容，第二行为处理的结果）</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed &#x27;p&#x27; demo.txt</span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line"><span class="number">298374837483</span></span><br><span class="line"><span class="number">298374837483</span></span><br><span class="line"><span class="number">172.16</span>.<span class="number">0.254</span></span><br><span class="line"><span class="number">172.16</span>.<span class="number">0.254</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>. <span class="literal">-n</span> 指的是取消默认输出，可以理解为，每次 sed 处理文件的某行时都会打印一次此行的内容，<span class="literal">-n</span> 就取消了这次打印，而下面的结果就是，sed 对文件的处理的结果 （注： <span class="literal">-n</span> 和 <span class="string">&#x27;p&#x27;</span> 经常一起使用）</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed -n &#x27;p&#x27; sed_test.txt</span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line"><span class="number">298374837483</span></span><br><span class="line"><span class="number">172.16</span>.<span class="number">0.254</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span>.此部分可以理解为，对第二行进行 sed 打印的操作，其他行都是默认打印的内容，第二行第一遍就是默认打印的结果</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed &#x27;2p&#x27; sed_test.txt</span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line"><span class="number">298374837483</span></span><br><span class="line"><span class="number">172.16</span>.<span class="number">0.254</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span>.此部分理解为，sed 只对第二行进行了打印的操作，<span class="literal">-n</span> 值得默认打印内容都不输出</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed -n &#x27;2p&#x27; sed_test.txt</span></span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6</span>.打印 <span class="number">1</span><span class="literal">-5</span>行 理解上方几点，此无特别之处</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed -n &#x27;1,5p&#x27; sed_test.txt</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">7</span>. <span class="variable">$p</span> 指打印最后一行 无 ^p 用法，打印第一行 <span class="number">1</span>p</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed -n &#x27;$p&#x27; sed_test.txt</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br></pre></td></tr></table></figure><p><strong>1.1.2 增加文件内容</strong></p><blockquote><p>i 定位符上一行插入内容</p><p>a 定位符下一行插入内容</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. 在文件的第二行插入 hello world</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed -n &#x27;2i hello world&#x27; sed_test.txt</span></span><br><span class="line">hello world</span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed  &#x27;2i hello world&#x27; sed_test.txt</span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">hello world</span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line"><span class="number">298374837483</span></span><br><span class="line"><span class="number">172.16</span>.<span class="number">0.254</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>.不加定位符的话，就是每行的上一行都插入 hello world ，可以理解为 sed  对每行进行传入的操作，命令的结果就是内容 hello world 命令执行的对象就是每一行，所以每一行都会打印一次</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed  &#x27;i hello world&#x27; sed_test.txt</span></span><br><span class="line">hello world</span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">hello world</span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">hello world</span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">hello world</span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line">hello world</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line">hello world</span><br><span class="line"><span class="number">298374837483</span></span><br><span class="line">hello world</span><br><span class="line"><span class="number">172.16</span>.<span class="number">0.254</span></span><br><span class="line">hello world</span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>.文件的第二行的上一行插入 hello 换行 world 。</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed &#x27;2i hello\nworld&#x27; sed_test.txt</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span>.先输入左侧单引号，添加的内容添加完成后在输入右侧的单引号。第一行输入 sed <span class="string">&#x27;3i\ 后敲击回车，第二行 \ 后敲击回车</span></span><br><span class="line"><span class="string">[root@Jermyn shell_scripts]# sed &#x27;</span><span class="number">3</span>i\</span><br><span class="line">&gt; hello\</span><br><span class="line">&gt; world<span class="string">&#x27; sed_test.txt</span></span><br><span class="line"><span class="string">root:x:0:0:root:/root:/bin/bash</span></span><br><span class="line"><span class="string">bin:x:1:1:bin:/bin:/sbin/nologin</span></span><br><span class="line"><span class="string">hello</span></span><br><span class="line"><span class="string">world</span></span><br><span class="line"><span class="string">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span></span><br><span class="line"><span class="string">adm:x:3:4:adm:/var/adm:/sbin/nologin</span></span><br><span class="line"><span class="string">lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span></span><br><span class="line"><span class="string">298374837483</span></span><br><span class="line"><span class="string">172.16.0.254</span></span><br><span class="line"><span class="string">10.1.1.1</span></span><br></pre></td></tr></table></figure><blockquote><p>注：示例 3 和 4 示例 3 更好操作些，示例4更直观些</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span>. a 类比 i </span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed &#x27;1,3a 111&#x27; sed_test.txt[root@Jermyn shell_scripts]# sed &#x27;1,3a 111&#x27; sed_test.txt</span></span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed &#x27;$a 111&#x27; sed_test.txt</span></span><br></pre></td></tr></table></figure><p><strong>1.1.3 修改文件的内容</strong></p><blockquote><p>c 替换指定的整行内容</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.将以 adm 开头的行替换为 hello world</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed &#x27;/^adm/c hello world&#x27; sed_test.txt</span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">hello world</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line"><span class="number">298374837483</span></span><br><span class="line"><span class="number">172.16</span>.<span class="number">0.254</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>.每一行都替换为 hello world</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed &#x27;c hello world&#x27; sed_test.txt</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>.此命令较之前特殊，是将 <span class="number">1</span><span class="literal">-5</span>总共<span class="number">5</span>行 替换为一行 hello world</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed &#x27;1,5c hello world&#x27; sed_test.txt</span></span><br><span class="line">hello world</span><br><span class="line"><span class="number">298374837483</span></span><br><span class="line"><span class="number">172.16</span>.<span class="number">0.254</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br></pre></td></tr></table></figure><p><strong>1.1.4 删除文件的内容</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.删除文件的某行</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed &#x27;1d&#x27; sed_test.txt</span></span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line"><span class="number">298374837483</span></span><br><span class="line"><span class="number">172.16</span>.<span class="number">0.254</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># cat -n sed_test.txt</span></span><br><span class="line">     <span class="number">1</span>  root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>.删除文件的 <span class="number">1</span><span class="literal">-3</span> 行</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># cat -n sed_test.txt</span></span><br><span class="line">     <span class="number">1</span>  root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">     <span class="number">2</span>  bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">     <span class="number">3</span>  daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">     <span class="number">4</span>  adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line">     <span class="number">5</span>  <span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line">     <span class="number">6</span>  <span class="number">298374837483</span></span><br><span class="line">     <span class="number">7</span>  <span class="number">172.16</span>.<span class="number">0.254</span></span><br><span class="line">     <span class="number">8</span>  <span class="number">10.1</span>.<span class="number">1.1</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed &#x27;1,3d&#x27; sed_test.txt</span></span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line"><span class="number">298374837483</span></span><br><span class="line"><span class="number">172.16</span>.<span class="number">0.254</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>.删除文件的最后一行</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed &#x27;$d&#x27; sed_test.txt</span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line"><span class="number">298374837483</span></span><br><span class="line"><span class="number">172.16</span>.<span class="number">0.254</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment">#</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span>.不加定位就是全删</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed &#x27;d&#x27; sed_test.txt</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment">#</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span>.正则删除文件中含有数字的，结果就是全删除了，每行都带有数字</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed &#x27;/[0-9]/d&#x27; sed_test.txt</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment">#</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6</span>.只删除 ip 地址的</span><br><span class="line">sed  <span class="string">&#x27;/[0-9]\&#123;1,3\&#125;\.[0-9]\&#123;1,3\&#125;\.[0-9]\&#123;1,3\&#125;\.[0-9]\&#123;1,3\&#125;/d&#x27;</span> sed_test.txt</span><br><span class="line">sed <span class="literal">-r</span> <span class="string">&#x27;([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;&#x27;</span> sed_test.txt</span><br></pre></td></tr></table></figure><p><strong>1.2 其他命令</strong></p><div class="table-container"><table><thead><tr><th>命令</th><th>解释</th><th>备注</th></tr></thead><tbody><tr><td>r</td><td>从另外文件中读取内容</td><td></td></tr><tr><td>w</td><td>内容另存为</td><td></td></tr><tr><td>&amp;</td><td>保存查找串以便在替换串中引用</td><td>和\(\)相同</td></tr><tr><td>=</td><td>打印行号</td><td></td></tr><tr><td>！</td><td>对所选行以外的所有行应用命令，放到行数之后</td><td>‘1,5!’</td></tr><tr><td>q</td><td>退出</td></tr></tbody></table></div><p><strong>示例：</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">r</span>	从文件中读取输入行</span><br><span class="line">w	将所选的行写入文件</span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed &#x27;3r /etc/hosts&#x27; 2.txt </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed &#x27;$r /etc/hosts&#x27; 2.txt</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed &#x27;/root/w a.txt&#x27; 2.txt </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed &#x27;/[0-9]&#123;4&#125;/w a.txt&#x27; 2.txt</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed  -r &#x27;/([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;/w b.txt&#x27; 2.txt</span></span><br><span class="line"></span><br><span class="line">!	对所选行以外的所有行应用命令，放到行数之后</span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -n &#x27;1!p&#x27; 1.txt </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -n &#x27;4p&#x27; 1.txt </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -n &#x27;4!p&#x27; 1.txt </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># cat -n 1.txt </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -n &#x27;1,17p&#x27; 1.txt </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -n &#x27;1,17!p&#x27; 1.txt </span></span><br><span class="line"></span><br><span class="line">&amp;   保存查找串以便在替换串中引用   \(\)</span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -n &#x27;/root/p&#x27; a.txt </span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -n &#x27;s/root/#&amp;/p&#x27; a.txt </span></span><br><span class="line"><span class="comment">#root:x:0:0:root:/root:/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sed -n &#x27;s/^root/#&amp;/p&#x27; passwd   注释掉以root开头的行</span></span><br><span class="line"><span class="comment"># sed -n -r &#x27;s/^root|^stu/#&amp;/p&#x27; /etc/passwd	注释掉以root开头或者以stu开头的行</span></span><br><span class="line"><span class="comment"># sed -n &#x27;1,5s/^[a-z].*/#&amp;/p&#x27; passwd  注释掉1~5行中以任意小写字母开头的行</span></span><br><span class="line"><span class="comment"># sed -n &#x27;1,5s/^/#/p&#x27; /etc/passwd  注释1~5行</span></span><br><span class="line">或者</span><br><span class="line">sed <span class="literal">-n</span> <span class="string">&#x27;1,5s/^/#/p&#x27;</span> passwd 以空开头的加上<span class="comment">#</span></span><br><span class="line">sed <span class="literal">-n</span> <span class="string">&#x27;1,5s/^#//p&#x27;</span> passwd 以<span class="comment">#开头的替换成空</span></span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -n &#x27;/^root/p&#x27; 1.txt </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -n &#x27;s/^root/#&amp;/p&#x27; 1.txt </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -n &#x27;s/\(^root\)/#\1/p&#x27; 1.txt </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -nr &#x27;/^root|^stu/p&#x27; 1.txt </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -nr &#x27;s/^root|^stu/#&amp;/p&#x27; 1.txt </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">= 	打印行号</span><br><span class="line"><span class="comment"># sed -n &#x27;/bash$/=&#x27; passwd    打印以bash结尾的行的行号</span></span><br><span class="line"><span class="comment"># sed -ne &#x27;/root/=&#x27; -ne &#x27;/root/p&#x27; passwd </span></span><br><span class="line"><span class="comment"># sed -n &#x27;/nologin$/=;/nologin$/p&#x27; 1.txt</span></span><br><span class="line"><span class="comment"># sed -ne &#x27;/nologin$/=&#x27; -ne &#x27;/nologin$/p&#x27; 1.txt</span></span><br><span class="line"></span><br><span class="line">q	退出</span><br><span class="line"><span class="comment"># sed &#x27;5q&#x27; 1.txt</span></span><br><span class="line"><span class="comment"># sed &#x27;/mail/q&#x27; 1.txt</span></span><br><span class="line"><span class="comment"># sed -r &#x27;/^yunwei|^mail/q&#x27; 1.txt</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -n &#x27;/bash$/p;10q&#x27; 1.txt</span></span><br><span class="line">ROOT:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">综合运用：</span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -n &#x27;1,5s/^/#&amp;/p&#x27; 1.txt </span></span><br><span class="line"><span class="comment">#root:x:0:0:root:/root:/bin/bash</span></span><br><span class="line"><span class="comment">#bin:x:1:1:bin:/bin:/sbin/nologin</span></span><br><span class="line"><span class="comment">#daemon:x:2:2:daemon:/sbin:/sbin/nologin</span></span><br><span class="line"><span class="comment">#adm:x:3:4:adm:/var/adm:/sbin/nologin</span></span><br><span class="line"><span class="comment">#lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span></span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -n &#x27;1,5s/\(^\)/#\1/p&#x27; 1.txt </span></span><br><span class="line"><span class="comment">#root:x:0:0:root:/root:/bin/bash</span></span><br><span class="line"><span class="comment">#bin:x:1:1:bin:/bin:/sbin/nologin</span></span><br><span class="line"><span class="comment">#daemon:x:2:2:daemon:/sbin:/sbin/nologin</span></span><br><span class="line"><span class="comment">#adm:x:3:4:adm:/var/adm:/sbin/nologin</span></span><br><span class="line"><span class="comment">#lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span></span><br></pre></td></tr></table></figure><p><strong>1.3 其他选项</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">-e</span> 多项编辑</span><br><span class="line"><span class="literal">-r</span>	扩展正则</span><br><span class="line"><span class="literal">-i</span> 修改原文件</span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -ne &#x27;/root/p&#x27; 1.txt -ne &#x27;/root/=&#x27;</span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line"><span class="number">1</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -ne &#x27;/root/=&#x27; -ne &#x27;/root/p&#x27; 1.txt </span></span><br><span class="line"><span class="number">1</span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在1.txt文件中的第5行的前面插入“hello world”;在1.txt文件的第8行下面插入“哈哈哈哈”</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -e &#x27;5ihello world&#x27; -e &#x27;8a哈哈哈哈哈&#x27; 1.txt  -e &#x27;5=;8=&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印第 1 和第 5 行</span></span><br><span class="line">sed <span class="literal">-n</span> <span class="string">&#x27;1,5p&#x27;</span> <span class="number">1</span>.txt</span><br><span class="line">sed <span class="operator">-ne</span> <span class="string">&#x27;1p&#x27;</span> <span class="operator">-ne</span> <span class="string">&#x27;5p&#x27;</span> <span class="number">1</span>.txt</span><br><span class="line">sed <span class="operator">-ne</span> <span class="string">&#x27;1p;5p&#x27;</span> <span class="number">1</span>.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 过滤vsftpd.conf文件中以#开头和空行：</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># grep -Ev &#x27;^#|^$&#x27; /etc/vsftpd/vsftpd.conf</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -e &#x27;/^#/d&#x27; -e &#x27;/^$/d&#x27; /etc/vsftpd/vsftpd.conf</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed &#x27;/^#/d;/^$/d&#x27; /etc/vsftpd/vsftpd.conf</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -r &#x27;/^#|^$/d&#x27; /etc/vsftpd/vsftpd.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 过滤smb.conf文件中生效的行：</span></span><br><span class="line">sed <span class="literal">-e</span> <span class="string">&#x27;/^#/d&#x27;</span> <span class="literal">-e</span> <span class="string">&#x27;/^;/d&#x27;</span> <span class="literal">-e</span> <span class="string">&#x27;/^$/d&#x27;</span> <span class="literal">-e</span> <span class="string">&#x27;/^\t$/d&#x27;</span> <span class="literal">-e</span> <span class="string">&#x27;/^\t#/d&#x27;</span> smb.conf</span><br><span class="line">sed <span class="literal">-r</span> <span class="string">&#x27;/^(#|$|;|\t#|\t$)/d&#x27;</span> smb.conf </span><br><span class="line">sed <span class="literal">-e</span> <span class="string">&#x27;/^#/d&#x27;</span> <span class="literal">-e</span> <span class="string">&#x27;/^;/d&#x27;</span> <span class="literal">-e</span> <span class="string">&#x27;/^$/d&#x27;</span> <span class="literal">-e</span> <span class="string">&#x27;/^\t$/d&#x27;</span> <span class="literal">-e</span> <span class="string">&#x27;/^\t#/&#x27;</span> smb.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印文件中不以字母开头的行</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># grep &#x27;^[^a-z]&#x27; 1.txt</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -n &#x27;/^[^a-z]/p&#x27; 1.txt</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 过滤出文件中的IP地址：</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># grep -E &#x27;([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;&#x27; 1.txt </span></span><br><span class="line"><span class="number">192.168</span>.<span class="number">0.254</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -nr &#x27;/([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;/p&#x27; 1.txt </span></span><br><span class="line"><span class="number">192.168</span>.<span class="number">0.254</span></span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># grep -o -E &#x27;([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;&#x27; 2.txt </span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.255</span></span><br><span class="line"><span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> ~]<span class="comment"># sed -nr &#x27;/([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;/p&#x27; 2.txt</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.255</span></span><br><span class="line"><span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 过滤出ifcfg-eth0文件中的IP、子网掩码、广播地址</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> <span class="type">shell06</span>]<span class="comment"># grep -Eo &#x27;([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;&#x27; ifcfg-eth0 </span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br><span class="line"><span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.254</span></span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> <span class="type">shell06</span>]<span class="comment"># sed -nr &#x27;/([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;/p&#x27; ifcfg-eth0|cut -d&#x27;=&#x27; -f2</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br><span class="line"><span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.254</span></span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> <span class="type">shell06</span>]<span class="comment"># sed -nr &#x27;/([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;/p&#x27; ifcfg-eth0|sed -n &#x27;s/[A-Z=]//gp&#x27;</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br><span class="line"><span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.254</span></span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> <span class="type">shell06</span>]<span class="comment"># ifconfig eth0|sed -n &#x27;2p&#x27;|sed -n &#x27;s/[:a-Z]//gp&#x27;|sed -n &#x27;s/ /\n/gp&#x27;|sed &#x27;/^$/d&#x27;</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.255</span></span><br><span class="line"><span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> <span class="type">shell06</span>]<span class="comment"># ifconfig | sed -nr &#x27;/([0-9]&#123;1,3&#125;\.)[0-9]&#123;1,3&#125;/p&#x27; | head -1|sed -r &#x27;s/([a-z:]|[A-Z/t])//g&#x27;|sed &#x27;s/ /\n/g&#x27;|sed  &#x27;/^$/d&#x27;</span></span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">server</span> <span class="type">shell06</span>]<span class="comment"># ifconfig eth0|sed -n &#x27;2p&#x27;|sed -n &#x27;s/.*addr:\(.*\) Bcast:\(.*\) Mask:\(.*\)/\1\n\2\n\3/p&#x27;</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span> </span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.255</span> </span><br><span class="line"><span class="number">255.255</span>.<span class="number">255.0</span></span><br></pre></td></tr></table></figure><blockquote><p><strong>-i 选项 直接修改原文件</strong></p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sed -i &#x27;s/root/ROOT/;s/stu/STU/&#x27; 11.txt</span></span><br><span class="line"><span class="comment"># sed -i &#x27;17&#123;s/YUNWEI/yunwei/;s#/bin/bash#/sbin/nologin#&#125;&#x27; 1.txt</span></span><br><span class="line"><span class="comment"># sed -i &#x27;1,5s/^/#&amp;/&#x27; a.txt</span></span><br></pre></td></tr></table></figure><blockquote><p>注意：<br>-ni 不要一起使用<br>p 命令 不要再使用 -i 时使用</p></blockquote><p><strong>1.4 sed 结合正则使用</strong></p><blockquote><p>sed 选项 <strong>‘sed命令 或者 正则表达式 或者 地址定位’</strong> 文件名</p></blockquote><ol><li>定址用于决定对哪些行进行编辑。地址的形式可以是数字、正则表达式、或二者的结合。</li><li>如果没有指定地址，sed将处理输入文件的所有行。</li></ol><div class="table-container"><table><thead><tr><th>正则</th><th>说明</th><th>备注</th></tr></thead><tbody><tr><td>/key/</td><td>查询包含关键字的行</td><td>sed -n ‘/root/p’ 1.txt</td></tr><tr><td>/key1/,/key2/</td><td>匹配包含两个关键字之间的行</td><td>sed -n ‘/\^adm/,/^mysql/p’ 1.txt</td></tr><tr><td>/key/,x</td><td>从匹配关键字的行开始到==文件第x行==之间的行（包含关键字所在行）</td><td>sed -n ‘/^ftp/,7p’</td></tr><tr><td>x,/key/</td><td>从文件的第x行开始到与关键字的匹配行之间的行</td><td></td></tr><tr><td>x,y!</td><td>不包含x到y行</td><td></td></tr><tr><td>/key/!</td><td>不包括关键字的行</td><td>sed -n ‘/bash$/!p’ 1.txt</td></tr></tbody></table></div><p><strong>示例：</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.匹配 bin 到 lpd 之间的行</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed -n &#x27;/bin/,/lpd/p&#x27; sed_test.txt </span></span><br><span class="line">ROOT:x:<span class="number">0</span>:<span class="number">0</span>:ROOT:/ROOT:/bin/bash</span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>.匹配 adm 开头的行或者 <span class="built_in">lp</span> 开头的行</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed -nr &#x27;/^adm|lp/p&#x27; sed_test.txt </span></span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>.匹配以 <span class="built_in">lp</span> 开头的行到 第 <span class="number">8</span> 行</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed -n &#x27;/^lp/,8p&#x27; sed_test.txt </span></span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line"><span class="number">298374837483</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 192.168.445.2522</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span>.匹配第 <span class="number">8</span> 行到以 <span class="number">10</span> 开头的行</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed -n &#x27;8,/^10/p&#x27; sed_test.txt </span></span><br><span class="line"><span class="comment"># 192.168.445.2522</span></span><br><span class="line"><span class="number">172.16</span>.<span class="number">0.254</span></span><br><span class="line"><span class="number">10.1</span>.<span class="number">1.1</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span>.匹配从第 <span class="number">2</span> 行开始 到以 adm 或者 <span class="built_in">lp</span> 开头的行</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># sed -nr &#x27;2,/^adm|^lp/p&#x27; sed_test.txt </span></span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br></pre></td></tr></table></figure><h4 id="脚本模式"><a href="#脚本模式" class="headerlink" title="脚本模式"></a>脚本模式</h4><p><strong>用法：</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sed -f scripts.sh  file		//使用脚本处理文件</span></span><br><span class="line">建议使用   ./sed.sh   file</span><br><span class="line"></span><br><span class="line">脚本的第一行写上</span><br><span class="line"><span class="comment">#!/bin/sed -f</span></span><br><span class="line"><span class="number">1</span>,<span class="number">5</span>d</span><br><span class="line">s/root/hello/g</span><br><span class="line"><span class="number">3</span>i777</span><br><span class="line"><span class="number">5</span>i888</span><br><span class="line">a999</span><br><span class="line">p</span><br></pre></td></tr></table></figure><p><strong>注意事项：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 脚本文件是一个sed的命令行清单。<span class="string">&#x27;commands&#x27;</span></span><br><span class="line">2. 在每行的末尾不能有任何空格、制表符（tab）或其它文本。</span><br><span class="line">3. 如果在一行中有多个命令，应该用分号分隔。</span><br><span class="line">4. 不需要且不可用引号保护命令</span><br><span class="line">5. <span class="comment">#号开头的行为注释</span></span><br></pre></td></tr></table></figure><h2 id="awk用法"><a href="#awk用法" class="headerlink" title="awk用法"></a>awk用法</h2><h4 id="awk-介绍"><a href="#awk-介绍" class="headerlink" title="awk 介绍"></a>awk 介绍</h4><p><strong>1.1 awk 概述</strong></p><ul><li>awk是一种==编程语言==，主要用于在linux/unix下对==文本和数据==进行处理，是linux/unix下的一个工具。数据可以来自标准输入、一个或多个文件，或其它命令的输出。</li><li>awk的处理文本和数据的方式：<strong>逐行扫描文件</strong>，默认从第一行到最后一行，寻找匹配的特定模式的行，并在这些行上进行你想要的操作。</li><li>awk分别代表其作者姓氏的第一个字母。因为它的作者是三个人，分别是Alfred Aho、Brian Kernighan、Peter Weinberger。</li><li>gawk是awk的GNU版本，它提供了Bell实验室和GNU的一些扩展。</li></ul><ul><li>下面介绍的awk是以GNU的gawk为例的，在linux系统中已把awk链接到gawk，所以下面全部以awk进行介绍。</li></ul><p><strong>1.2 awk 作用</strong></p><ol><li>awk用来处理文件和数据的，是类unix下的一个工具，也是一种编程语言</li><li>可以用来统计数据，比如网站的访问量，访问的IP量等等</li><li>支持条件判断，支持for和while循环</li></ol><h4 id="awk-使用方式"><a href="#awk-使用方式" class="headerlink" title="awk 使用方式"></a>awk 使用方式</h4><p><strong>2.1 命令行模式的使用</strong></p><p><strong>语法：</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">awk 选项 <span class="string">&#x27;命令部分&#x27;</span> 文件名</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">特别说明：</span><br><span class="line">引用shell变量需用双引号引起</span><br></pre></td></tr></table></figure><blockquote><p><strong>命名部分说明：</strong></p><ul><li>正则表达式，地址定位</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;/root/&#123;awk语句&#125;&#x27;</span>					sed中： <span class="string">&#x27;/root/p&#x27;</span></span><br><span class="line"><span class="string">&#x27;NR==1,NR==5&#123;awk语句&#125;&#x27;</span>			sed中： <span class="string">&#x27;1,5p&#x27;</span></span><br><span class="line"><span class="string">&#x27;/^root/,/^ftp/&#123;awk语句&#125;&#x27;</span>  		sed中：<span class="string">&#x27;/^root/,/^ftp/p&#x27;</span></span><br></pre></td></tr></table></figure><ul><li>{awk语句1<strong>;</strong>awk语句2<strong>;</strong>…}</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#123;print $0;print $1&#125;&#x27;</span>			sed中：<span class="string">&#x27;p&#x27;</span></span><br><span class="line"><span class="string">&#x27;NR==5&#123;print $0&#125;&#x27;</span>				sed中：<span class="string">&#x27;5p&#x27;</span></span><br><span class="line">注：awk命令语句间用分号间隔</span><br></pre></td></tr></table></figure><ul><li>BEGIN…END….</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;BEGIN&#123;awk语句&#125;;&#123;处理中&#125;;END&#123;awk语句&#125;&#x27;</span></span><br><span class="line"><span class="string">&#x27;BEGIN&#123;awk语句&#125;;&#123;处理中&#125;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#123;处理中&#125;;END&#123;awk语句&#125;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p><strong>2.2 常用选项介绍</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">-F</span>  定义字段分割符号，默认的分隔符是 空格</span><br><span class="line"><span class="literal">-v</span>  定义变量并赋值</span><br></pre></td></tr></table></figure><h4 id="脚本模式使用"><a href="#脚本模式使用" class="headerlink" title="脚本模式使用"></a>脚本模式使用</h4><p><strong>3.1 脚本编写</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/awk -f 		定义魔法字符</span></span><br><span class="line">以下是awk引号里的命令清单，不要用引号保护命令，多个命令用分号间隔</span><br><span class="line"><span class="keyword">BEGIN</span>&#123;FS=<span class="string">&quot;:&quot;</span>&#125;</span><br><span class="line">NR==<span class="number">1</span>,NR==<span class="number">3</span>&#123;print <span class="variable">$1</span><span class="string">&quot;\t&quot;</span><span class="variable">$NF</span>&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><strong>3.2 脚本执行</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">方法<span class="number">1</span>：</span><br><span class="line">awk 选项 <span class="operator">-f</span> awk的脚本文件  要处理的文本文件</span><br><span class="line">awk <span class="operator">-f</span> awk.sh filename</span><br><span class="line"></span><br><span class="line">sed <span class="operator">-f</span> sed.sh <span class="literal">-i</span> filename</span><br><span class="line"></span><br><span class="line">方法<span class="number">2</span>：</span><br><span class="line">./awk的脚本文件(或者绝对路径)	要处理的文本文件</span><br><span class="line">./awk.sh filename</span><br><span class="line"></span><br><span class="line">./sed.sh filename方法<span class="number">1</span>：</span><br><span class="line">awk 选项 <span class="operator">-f</span> awk的脚本文件  要处理的文本文件</span><br><span class="line">awk <span class="operator">-f</span> awk.sh filename</span><br><span class="line"></span><br><span class="line">sed <span class="operator">-f</span> sed.sh <span class="literal">-i</span> filename</span><br><span class="line"></span><br><span class="line">方法<span class="number">2</span>：</span><br><span class="line">./awk的脚本文件(或者绝对路径)	要处理的文本文件</span><br><span class="line">./awk.sh filename</span><br><span class="line"></span><br><span class="line">./sed.sh filename</span><br></pre></td></tr></table></figure><p><strong>3.3 awk内部相关变量</strong></p><div class="table-container"><table><thead><tr><th>变量</th><th>变量说明</th><th>备注</th></tr></thead><tbody><tr><td>$0</td><td>当前处理行的所有记录</td><td></td></tr><tr><td>$1,$2,$3…$n</td><td>文件中每行以间隔符号分割的不同字段</td><td>awk -F: ‘{print $1,$3}’</td></tr><tr><td>NF</td><td>当前记录的字段数（列数）</td><td>awk -F: ‘{print NF}’</td></tr><tr><td>$NF</td><td>最后一列</td><td>$(NF-1)表示倒数第二列</td></tr><tr><td>FNR/NR</td><td>行号</td><td></td></tr><tr><td>FS</td><td>定义间隔符</td><td>‘BEGIN{FS=”:”};{print $1,$3}’</td></tr><tr><td>OFS</td><td>定义输出字段分隔符，默认空格</td><td>‘BEGIN{OFS=”\t”};{print $1,$3}’</td></tr><tr><td>RS</td><td>输入记录分割符，默认换行</td><td>‘BEGIN{RS=”\t”};{print $0}’</td></tr><tr><td>ORS</td><td>输出记录分割符，默认换行</td><td>‘BEGI N{ORS=”\n\n”};{print $1,$3}’</td></tr><tr><td>FILENAME</td><td>当前输入的文件名</td></tr></tbody></table></div><p><strong>实例：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">vim awk_test.txt</span><br><span class="line">...</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:3:4:adm:/var/adm:/sbin/nologin</span><br><span class="line">lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span><br><span class="line">sync:x:5:0:sync:/sbin:/bin/sync</span><br><span class="line">shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br><span class="line">halt:x:7:0:halt:/sbin:/sbin/halt</span><br><span class="line">mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span><br><span class="line">operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="line">games:x:12:100:games:/usr/games:/sbin/nologin</span><br><span class="line">ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</span><br><span class="line">nobody:x:99:99:Nobody:/:/sbin/nologin</span><br><span class="line">systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin</span><br><span class="line">dbus:x:81:81:System message bus:/:/sbin/nologin</span><br><span class="line">polkitd:x:999:998:User for polkitd:/:/sbin/nologin</span><br><span class="line">tss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin</span><br><span class="line">sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</span><br><span class="line">postfix:x:89:89::/var/spool/postfix:/sbin/nologin</span><br><span class="line">chrony:x:998:996::/var/lib/chrony:/sbin/nologin</span><br><span class="line">ntp:x:38:38::/etc/ntp:/sbin/nologin</span><br><span class="line">Jermyn:x:1000:1000::/home/Jermyn:/bin/bash</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.awk 执行方式与 sed 类似，即一行一行执行，此命令打印当前处理的行，即打印文件的每行内容</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk &#x27;&#123;print $0&#125;&#x27; awk_test.txt 、</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk &#x27;&#123;print $0&#125;&#x27; awk_test.txt </span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">........</span><br><span class="line">ntp:x:<span class="number">38</span>:<span class="number">38</span>::/etc/ntp:/sbin/nologin</span><br><span class="line">Jermyn:x:<span class="number">1000</span>:<span class="number">1000</span>::/home/Jermyn:/bin/bash</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>.打印 <span class="number">1</span><span class="literal">-5</span> 行的内容，定位即是 NR==<span class="number">1</span>,NR==<span class="number">5</span> </span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk -F: &#x27;NR==1,NR==5&#123;print $0&#125;&#x27; awk_test.txt </span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>.打印第一行和第五行，此处 || 为逻辑运算符，并非正则， | 为正则</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk  &#x27;NR==1 || NR==5&#123;print $0&#125;&#x27; awk_test.txt </span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span>.打印 <span class="number">3</span><span class="literal">-5</span> 行，第二格命令是 NR 大于等于 <span class="number">3</span> 并且 NR 小于等于 <span class="number">5</span> 的行</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk  &#x27;NR==3,NR==5&#123;print $0&#125;&#x27; awk_test.txt </span></span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk  &#x27;NR&gt;=3 &amp;&amp; NR&lt;=5&#123;print $0&#125;&#x27; awk_test.txt </span></span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span>.打印以冒号 ： 分割的第一列和最后一列以及倒数第二列</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk -F : &#x27;&#123;print $1,$NF,$(NF-1)&#125;&#x27; awk_test.txt </span></span><br><span class="line">root /bin/bash /root</span><br><span class="line">bin /sbin/nologin /bin</span><br><span class="line">.......</span><br><span class="line">ntp /sbin/nologin /etc/ntp</span><br><span class="line">Jermyn /bin/bash /home/Jermyn</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6</span>.两个命令区别就是 <span class="variable">$NF</span> 和 NF ,后者可以理解为 NF 为变量值为 NR=<span class="number">7</span> 即直接 print <span class="number">7</span> ，前者可以理解为是打印第 <span class="variable">$7</span> 列</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment">#  awk -F : &#x27;&#123;print $NF&#125;&#x27; awk_test.txt </span></span><br><span class="line">/bin/bash</span><br><span class="line">/sbin/nologin</span><br><span class="line">.....</span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment">#  awk -F : &#x27;&#123;print NF&#125;&#x27; awk_test.txt </span></span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line">.......</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">7</span>.打印出包含 root 的行，/root/ 为地址定位</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk  &#x27;/root/&#123;print $0&#125;&#x27; awk_test.txt </span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">operator:x:<span class="number">11</span>:<span class="number">0</span>:operator:/root:/sbin/nologin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 不加动作默认是打印</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk  &#x27;/root/&#x27; awk_test.txt </span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">operator:x:<span class="number">11</span>:<span class="number">0</span>:operator:/root:/sbin/nologin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以理解为 匹配关键字 root 出现的行，过滤此行 以冒号 ：分割的第一列和最后一列</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk -F : &#x27;/root/&#123;print $1,$NF&#125;&#x27; awk_test.txt </span></span><br><span class="line">root /bin/bash</span><br><span class="line">operator /sbin/nologin</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">8</span>.打印 <span class="number">1</span><span class="literal">-5</span> 行和以 root 开头的行</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk  &#x27;NR==1,NR==5;/^root/&#123;print $0&#125;&#x27; awk_test.txt </span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash					<span class="comment"># 地址定位1-5行的时候打印一次</span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash					<span class="comment"># 地址定位以root 开头的时候打印一次</span></span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin				<span class="comment"># 地址定位1-5行的时候打印一次</span></span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin			<span class="comment"># 地址定位1-5行的时候打印一次</span></span><br><span class="line">adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin			<span class="comment"># 地址定位1-5行的时候打印一次</span></span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin		<span class="comment"># 地址定位1-5行的时候打印一次</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">9</span>.以冒号 ：为分隔符取出第一行和最后一行，取出内容以 <span class="selector-tag">@</span> 隔开（注：OFS=<span class="string">&quot; &quot;</span> 为双引号，不可为单引号）</span><br><span class="line">下面两条命令效果相同，如果不定义分隔符的话，可以直接在打印的时候以 定义<span class="string">&quot;分隔符&quot;</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk -F : &#x27;BEGIN&#123;OFS=&quot;@&quot;&#125;;&#123;print $1,$NF&#125;&#x27; awk_test.txt </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment">#  awk -F : &#x27;&#123;print $1&quot;@&quot;$NF&#125;&#x27; awk_test.txt </span></span><br><span class="line">root<span class="selector-tag">@</span>/bin/bash</span><br><span class="line">bin<span class="selector-tag">@</span>/sbin/nologin</span><br><span class="line">........ </span><br><span class="line">ntp<span class="selector-tag">@</span>/sbin/nologin</span><br><span class="line">Jermyn<span class="selector-tag">@</span>/bin/bash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 其他方式</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk -F : &#x27;&#123;print &quot;用户名：&quot;$1&quot;\tSHELL解释器：&quot;$NF&#125;&#x27; awk_test.txt </span></span><br><span class="line">用户名：root    SHELL解释器：/bin/bash</span><br><span class="line">用户名：bin     SHELL解释器：/sbin/nologin</span><br><span class="line">用户名：daemon  SHELL解释器：/sbin/nologin</span><br><span class="line">用户名：adm     SHELL解释器：/sbin/nologin</span><br><span class="line">用户名：<span class="built_in">lp</span>      SHELL解释器：/sbin/nologin</span><br><span class="line">用户名：sync    SHELL解释器：/bin/sync</span><br><span class="line">.......</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">10</span>.下面两条命令效果相同</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk  &#x27;BEGIN&#123;FS=&quot;:&quot;;OFS=&quot;@&quot;&#125;;&#123;print $1,$NF&#125;&#x27; awk_test.txt </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk -F : &#x27;BEGIN&#123;OFS=&quot;@&quot;&#125;;&#123;print $1,$NF&#125;&#x27; awk_test.txt </span></span><br></pre></td></tr></table></figure><h4 id="awk工作原理"><a href="#awk工作原理" class="headerlink" title="awk工作原理"></a>awk工作原理</h4><p><code>awk -F: &#39;&#123;print $1,$3&#125;&#39; /etc/passwd</code></p><ol><li><p>awk使用一行作为输入，并将这一行赋给内部变量$0，每一行也可称为一个记录，以换行符(RS)结束</p></li><li><p>每行被间隔符 <strong>：</strong> (默认为空格或制表符)分解成字段(或域)，每个字段存储在已编号的变量中，从$1开始</p><p>问：awk如何知道用空格来分隔字段的呢？</p><p>答：因为有一个内部变量 FS 来确定字段分隔符。初始时，FS赋为空格</p></li><li><p>awk使用print函数打印字段，打印出来的字段会以空格分隔，因为$1,$3之间有一个逗号。逗号比较特殊，它映射为另一个内部变量，称为 输出字段分隔符OFS，OFS默认为空格</p></li><li><p>awk处理完一行后，将从文件中获取另一行，并将其存储在$0中，覆盖原来的内容，然后将新的字符串分隔成字段并进行处理。该过程将持续到所有行处理完毕</p></li></ol><h4 id="awk使用进阶"><a href="#awk使用进阶" class="headerlink" title="awk使用进阶"></a>awk使用进阶</h4><p><strong>5.1 格式化输出<code>print</code>和<code>printf</code></strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">print函数		类似<span class="built_in">echo</span> <span class="string">&quot;hello world&quot;</span></span><br><span class="line"><span class="comment"># date |awk &#x27;&#123;print &quot;Month: &quot;$2 &quot;\nYear: &quot;$NF&#125;&#x27;</span></span><br><span class="line"><span class="comment"># awk -F: &#x27;&#123;print &quot;username is: &quot; $1 &quot;\t uid is: &quot;$3&#125;&#x27; /etc/passwd</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">printf函数		类似<span class="built_in">echo</span> <span class="literal">-n</span></span><br><span class="line"><span class="comment"># awk -F: &#x27;&#123;printf &quot;%-15s %-10s %-15s\n&quot;, $1,$2,$3&#125;&#x27;  /etc/passwd</span></span><br><span class="line"><span class="comment"># awk -F: &#x27;&#123;printf &quot;|%15s| %10s| %15s|\n&quot;, $1,$2,$3&#125;&#x27; /etc/passwd</span></span><br><span class="line"><span class="comment"># awk -F: &#x27;&#123;printf &quot;|%-15s| %-10s| %-15s|\n&quot;, $1,$2,$3&#125;&#x27; /etc/passwd</span></span><br><span class="line"></span><br><span class="line">awk <span class="string">&#x27;BEGIN&#123;FS=&quot;:&quot;&#125;;&#123;printf &quot;%-15s %-15s %-15s\n&quot;,$1,$6,$NF&#125;&#x27;</span> a.txt</span><br><span class="line"></span><br><span class="line">%s 字符类型  strings			%<span class="literal">-20s</span></span><br><span class="line">%d 数值类型	</span><br><span class="line">占<span class="number">15</span>字符</span><br><span class="line">- 表示左对齐，默认是右对齐</span><br><span class="line">printf默认不会在行尾自动换行，加\n</span><br></pre></td></tr></table></figure><p><strong>5.2 定义变量</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># awk -v NUM=3 -F: &#x27;&#123; print $NUM &#125;&#x27; /etc/passwd</span></span><br><span class="line"><span class="comment"># awk -v NUM=3 -F: &#x27;&#123; print NUM &#125;&#x27; /etc/passwd</span></span><br><span class="line"><span class="comment"># awk -v num=1 &#x27;BEGIN&#123;print num&#125;&#x27; </span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="comment"># awk -v num=1 &#x27;BEGIN&#123;print $num&#125;&#x27; </span></span><br><span class="line">注意：</span><br><span class="line">awk中调用定义的变量不需要加<span class="variable">$</span></span><br></pre></td></tr></table></figure><p><strong>5.3 awk中BEGIN…END使用</strong></p><p>①BEGIN：表示在程序开始前执行</p><p>②END ：表示所有文件处理完后执行</p><p>③用法：<code>&#39;BEGIN&#123;开始处理之前&#125;;&#123;处理中&#125;;END&#123;处理结束后&#125;&#39;</code></p><p><strong>实例：</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. 打印最后一列和倒数第二列（登录shell和家目录）</span><br><span class="line">awk <span class="operator">-F</span>: <span class="string">&#x27;BEGIN&#123; print &quot;Login_shell\t\tLogin_home\n***************************************&quot;&#125;;&#123;print $NF&quot;\t\t&quot;$(NF-1)&#125;;END&#123;print &quot;***************************************&quot;&#125;&#x27;</span> awk_test.txt </span><br><span class="line"></span><br><span class="line">awk <span class="string">&#x27;BEGIN&#123; FS=&quot;:&quot;;print &quot;Login_shell\tLogin_home\n***************************************&quot;&#125;;&#123;print $NF&quot;\t&quot;$(NF-1)&#125;;END&#123;print &quot;***************************************&quot;&#125;&#x27;</span> awk_test.txt </span><br><span class="line"></span><br><span class="line">结果显示：</span><br><span class="line">Login_shell             Login_home</span><br><span class="line">***************************************</span><br><span class="line">/bin/bash               /root</span><br><span class="line">/sbin/nologin           /bin</span><br><span class="line">/sbin/nologin           /sbin</span><br><span class="line">/sbin/nologin           /var/adm</span><br><span class="line">............</span><br><span class="line">/sbin/nologin           /dev/null</span><br><span class="line">/sbin/nologin           /var/empty/sshd</span><br><span class="line">/sbin/nologin           /var/spool/postfix</span><br><span class="line">/sbin/nologin           /var/lib/chrony</span><br><span class="line">/sbin/nologin           /etc/ntp</span><br><span class="line">/bin/bash               /home/Jermyn</span><br><span class="line">***************************************</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>.打印/etc/passwd里的用户名、家目录及登录shell</span><br><span class="line">awk <span class="operator">-F</span> <span class="string">&#x27;:&#x27;</span> <span class="string">&#x27;BEGIN&#123;print &quot;U_NAME\t\tH_DIR\t\t\tSHELL\n&quot;  &quot;*********************************************&quot;&#125;</span></span><br><span class="line"><span class="string">&#123;printf &quot;%-15s %-20s %-10s \n&quot;,$1,$(NF-1),$NF&#125;END&#123;print &quot;*********************************************&quot;&#125;&#x27;</span> awk_test.txt </span><br><span class="line"></span><br><span class="line">awk <span class="operator">-F</span>: <span class="string">&#x27;BEGIN&#123;OFS=&quot;\t\t&quot;;print&quot;u_name\t\th_dir\t\t\tshell\n</span></span><br><span class="line"><span class="string">*********************************************&quot;&#125;;</span></span><br><span class="line"><span class="string">&#123;printf &quot;%-15s %-20s %-10s\n&quot;,$1,$(NF-1),$NF&#125;;</span></span><br><span class="line"><span class="string">END&#123;print &quot;**********************************************&quot;&#125;&#x27;</span> awk_test.txt </span><br><span class="line"></span><br><span class="line">结果显示：</span><br><span class="line">U_NAME          H_DIR                   SHELL</span><br><span class="line">*********************************************</span><br><span class="line">root            /root                /bin/bash  </span><br><span class="line">bin             /bin                 /sbin/nologin </span><br><span class="line">.........</span><br><span class="line">chrony          /var/lib/chrony      /sbin/nologin </span><br><span class="line">ntp             /etc/ntp             /sbin/nologin </span><br><span class="line">Jermyn          /home/Jermyn         /bin/bash  </span><br><span class="line">*********************************************</span><br></pre></td></tr></table></figure><p><strong>5.4 awk和正则的综合运用</strong></p><div class="table-container"><table><thead><tr><th>运算符</th><th>说明</th></tr></thead><tbody><tr><td>==</td><td>等于</td></tr><tr><td>!=</td><td>不等于</td></tr><tr><td>&gt;</td><td>大于</td></tr><tr><td>&lt;</td><td>小于</td></tr><tr><td>&gt;=</td><td>大于等于</td></tr><tr><td>&lt;=</td><td>小于等于</td></tr><tr><td>~</td><td>匹配</td></tr><tr><td>!~</td><td>不匹配</td></tr><tr><td>!</td><td>逻辑非</td></tr><tr><td>&amp;&amp;</td><td>逻辑与</td></tr><tr><td>\</td><td>\</td><td></td><td>逻辑或</td></tr></tbody></table></div><p><strong>实例：</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.从第一行匹配到以 daemon 开头的行</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk -F &#x27;:&#x27; &#x27;NR==1,/^daemon/&#123;print $0&#125;&#x27; awk_test.txt </span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>.从第一行到第<span class="number">3</span>行 </span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk -F &#x27;:&#x27; &#x27;NR==1,NR==3&#123;print $0&#125;&#x27; awk_test.txt </span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>.从以<span class="built_in">lp</span>开头的行匹配到第<span class="number">7</span>行</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk -F &#x27;:&#x27; &#x27;/^lp/,NR==7&#123;print $0&#125;&#x27; awk_test.txt </span></span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line">sync:x:<span class="number">5</span>:<span class="number">0</span>:sync:/sbin:/bin/sync</span><br><span class="line">shutdown:x:<span class="number">6</span>:<span class="number">0</span>:shutdown:/sbin:/sbin/shutdown</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span>.打印以root开头或者以<span class="built_in">lp</span>开头的行 </span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk -F &#x27;:&#x27; &#x27;/^lp|^root/&#123;print $0&#125;&#x27; awk_test.txt </span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk -F &#x27;:&#x27; &#x27;/^lp/||/^root/&#123;print $0&#125;&#x27; awk_test.txt </span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span>.显示<span class="number">5</span><span class="literal">-10</span>行  </span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk -F &#x27;:&#x27; &#x27;NR&gt;=5 &amp;&amp; NR&lt;=10&#123;print $0&#125;&#x27; awk_test.txt </span></span><br><span class="line"><span class="built_in">lp</span>:x:<span class="number">4</span>:<span class="number">7</span>:<span class="built_in">lp</span>:/var/spool/lpd:/sbin/nologin</span><br><span class="line">sync:x:<span class="number">5</span>:<span class="number">0</span>:sync:/sbin:/bin/sync</span><br><span class="line">shutdown:x:<span class="number">6</span>:<span class="number">0</span>:shutdown:/sbin:/sbin/shutdown</span><br><span class="line">halt:x:<span class="number">7</span>:<span class="number">0</span>:halt:/sbin:/sbin/halt</span><br><span class="line">mail:x:<span class="number">8</span>:<span class="number">12</span>:mail:/var/spool/mail:/sbin/nologin</span><br><span class="line">operator:x:<span class="number">11</span>:<span class="number">0</span>:operator:/root:/sbin/nologin</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6</span>.打印<span class="number">5</span><span class="literal">-10</span>行以shutdown结尾的内容：</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk  &#x27;NR&gt;=5 &amp;&amp; NR&lt;=10 &amp;&amp; $0~ /shutdown$/&#123;print $0&#125;&#x27; awk_test.txt </span></span><br><span class="line">shutdown:x:<span class="number">6</span>:<span class="number">0</span>:shutdown:/sbin:/sbin/shutdown</span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk  &#x27;NR&gt;=5 &amp;&amp; NR&lt;=10 &amp;&amp; $0~ /shutdown$/&#x27; awk_test.txt</span></span><br><span class="line">shutdown:x:<span class="number">6</span>:<span class="number">0</span>:shutdown:/sbin:/sbin/shutdown</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">7</span>.awk 截取IP</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># ifconfig ens33 | awk -F &#x27; &#x27; &#x27;/netmask/&#123;print $2&#125;&#x27;</span></span><br><span class="line"><span class="number">192.168</span>.<span class="number">88.139</span></span><br><span class="line"></span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># ifconfig ens33 | awk -F &quot; &quot; &#x27;/netmask/&#123;print $2RS$4RS$6&#125;&#x27;</span></span><br><span class="line"><span class="number">192.168</span>.<span class="number">88.139</span></span><br><span class="line"><span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line"><span class="number">192.168</span>.<span class="number">88.255</span></span><br></pre></td></tr></table></figure><h4 id="awk的脚本编程"><a href="#awk的脚本编程" class="headerlink" title="awk的脚本编程"></a>awk的脚本编程</h4><p><strong>6.1 流程控制语句</strong></p><p><strong>6.1.1 if 结构</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>语句：</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="type">xxx</span> ];then</span><br><span class="line">xxx</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">格式：</span><br><span class="line">awk 选项 <span class="string">&#x27;正则，地址定位&#123;awk语句&#125;&#x27;</span>  文件名</span><br><span class="line">&#123; <span class="keyword">if</span>(表达式)｛语句<span class="number">1</span>;语句<span class="number">2</span>;...｝&#125;</span><br><span class="line"></span><br><span class="line">例子：</span><br><span class="line"><span class="number">1</span>.UID &gt;=<span class="number">500</span> &amp;&amp; UID &lt;=<span class="number">60000</span> </span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk -F &#x27;:&#x27; &#x27;&#123; if($3&gt;=500 &amp;&amp; $3&lt;=60000) &#123;print $1,$3&#125;&#125;&#x27; awk_test.txt </span></span><br><span class="line">polkitd <span class="number">999</span></span><br><span class="line">chrony <span class="number">998</span></span><br><span class="line">Jermyn <span class="number">1000</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.格式打印</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk -F &#x27;:&#x27; &#x27;&#123; if($3==0) &#123;print $1&quot; IS ADMIN&quot;&#125;&#125;&#x27; awk_test.txt </span></span><br><span class="line">root IS ADMIN</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.执行命令作为判断条件</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk &#x27;BEGIN&#123; if ( &#x27;$(id -u)&#x27; == 0) &#123;print &quot;THIS USER IS ADMIN&quot;&#125;&#125;&#x27;</span></span><br><span class="line">THIS USER IS ADMIN</span><br></pre></td></tr></table></figure><p><strong>6.1.2 if…else 结构</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">if...else语句:</span><br><span class="line"><span class="keyword">if</span> [ <span class="type">xxx</span> ];then</span><br><span class="line">	xxxxx</span><br><span class="line">	</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	xxx</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">格式：</span><br><span class="line">&#123;<span class="keyword">if</span>(表达式)｛语句;语句;...｝<span class="keyword">else</span>｛语句;语句;...&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>.执行命令作为判断条件 if...else...结构</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk &#x27;BEGIN&#123; if ( &#x27;$[ id -u ]&#x27; != 0) &#123;print &quot;THIS USER IS NOT  ADMIN&quot;&#125; else &#123;print &quot;THIS USER IS ADMIN&quot;&#125; &#125;&#x27;</span></span><br><span class="line">THIS USER IS ADMIN</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">2.如果 if($3&gt;=500 &amp;&amp; $3 !=65534 是普通用户 否则不是普通用户</span><br><span class="line">[root@Jermyn shell_scripts]# awk -F &#x27;:&#x27; &#x27;&#123; if($3&gt;=500 &amp;&amp; $3 !=65534 )  &#123;print $1&quot; Is a common user&quot;&#125; else &#123;print $1 &quot; Not ordinary users&quot;&#125;&#125;&#x27; awk_test.txt | tail</span><br><span class="line">nobody Not ordinary users</span><br><span class="line">systemd-network Not ordinary users</span><br><span class="line">dbus Not ordinary users</span><br><span class="line">polkitd Is a common user</span><br><span class="line">tss Not ordinary users</span><br><span class="line">sshd Not ordinary users</span><br><span class="line">postfix Not ordinary users</span><br><span class="line">chrony Is a common user</span><br><span class="line">ntp Not ordinary users</span><br><span class="line">Jermyn Is a common user</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#上面例子可以规范格式，更加直观</span></span><br><span class="line">awk <span class="operator">-F</span> <span class="string">&#x27;:&#x27;</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#123; </span></span><br><span class="line"><span class="string">	if($3&gt;=500 &amp;&amp; $3 !=65534 )  </span></span><br><span class="line"><span class="string">		&#123;print $1&quot; Is a common user&quot;&#125; </span></span><br><span class="line"><span class="string">	else &#123;print $1 &quot; Not ordinary users&quot;&#125;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span> awk_test.txt | tail</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>.if( <span class="string">&#x27;$(id -u)&#x27;</span>&gt;=<span class="number">500</span> &amp;&amp; <span class="string">&#x27;$(id -u)&#x27;</span> !=<span class="number">65534</span> ) </span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk &#x27;BEGIN&#123;if( &#x27;$(id -u)&#x27;&gt;=500 &amp;&amp; &#x27;$(id -u)&#x27; !=65534 ) &#123;print &quot;是普通用户&quot;&#125; else &#123;print &quot;不是普通用户&quot;&#125;&#125;&#x27;</span></span><br><span class="line">不是普通用户</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#上面例子可以规范格式，更加直观</span></span><br><span class="line">awk <span class="string">&#x27;BEGIN&#123;</span></span><br><span class="line"><span class="string">	if( &#x27;</span><span class="variable">$</span>(id <span class="literal">-u</span>)<span class="string">&#x27;&gt;=500 &amp;&amp; &#x27;</span><span class="variable">$</span>(id <span class="literal">-u</span>)<span class="string">&#x27; !=65534 ) </span></span><br><span class="line"><span class="string">		&#123;print &quot;是普通用户&quot;&#125; </span></span><br><span class="line"><span class="string">	else &#123;print &quot;不是普通用户&quot;&#125;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>6.1.3 if…elif…else结构</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [<span class="type">xxxx</span>];then</span><br><span class="line">	xxxx</span><br><span class="line">elif [<span class="type">xxx</span>];then</span><br><span class="line">	xxx</span><br><span class="line">....</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">...</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if...else if...else语句：</span><br><span class="line"></span><br><span class="line">格式：</span><br><span class="line">&#123; <span class="keyword">if</span>(表达式<span class="number">1</span>)｛语句;语句；...｝<span class="keyword">else</span> <span class="keyword">if</span>(表达式<span class="number">2</span>)｛语句;语句；...｝<span class="keyword">else</span> <span class="keyword">if</span>(表达式<span class="number">3</span>)｛语句;语句；...｝<span class="keyword">else</span>｛语句;语句；...｝&#125;</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.判断用户是 管理员 还是 系统用户，还是 普通用户</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk -F: &#x27;&#123; if($3==0) &#123;print $1,&quot;:是管理员&quot;&#125; else if($3&gt;=1 &amp;&amp; $3&lt;=499 || $3==65534 ) &#123;print $1,&quot;:是系统用户&quot;&#125; else &#123;print $1,&quot;:是普通用户&quot;&#125;&#125;&#x27; awk_test.txt </span></span><br><span class="line">root :是管理员</span><br><span class="line">bin :是系统用户</span><br><span class="line">.......</span><br><span class="line">chrony :是普通用户</span><br><span class="line">ntp :是系统用户</span><br><span class="line">Jermyn :是普通用户</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="operator">-F</span> <span class="string">&#x27;:&#x27;</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#123; </span></span><br><span class="line"><span class="string">	if($3==0) </span></span><br><span class="line"><span class="string">		&#123;print $1,&quot;:是管理员&quot;&#125; </span></span><br><span class="line"><span class="string">	else if($3&gt;=1 &amp;&amp; $3&lt;=499 || $3==65534 ) </span></span><br><span class="line"><span class="string">		&#123;print $1,&quot;:是系统用户&quot;&#125; </span></span><br><span class="line"><span class="string">	else </span></span><br><span class="line"><span class="string">		&#123;print $1,&quot;:是普通用户&quot;&#125;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span> awk_test.txt </span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>.判断管理员 和 系统用户以及普通用户的个数</span><br><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk -F &#x27;:&#x27; &#x27;&#123;if ($3==0) &#123;i++&#125; else if ( $3&gt;=1 &amp;&amp; $3&lt;=499 || $3==65534 ) &#123;j++&#125; else &#123;k++&#125;&#125;;END&#123;print &quot;管理员个数为:&quot;i &quot;\n系统用户个数为:&quot;j&quot;\n普通用 户的个数为:&quot;k&#125;&#x27; awk_test.txt </span></span><br><span class="line">管理员个数为:<span class="number">1</span></span><br><span class="line">系统用户个数为:<span class="number">18</span></span><br><span class="line">普通用户的个数为:<span class="number">3</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#上面例子可以规范格式，更加直观</span></span><br><span class="line">awk <span class="operator">-F</span> <span class="string">&#x27;:&#x27;</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">	if ($3==0) </span></span><br><span class="line"><span class="string">		&#123;i++&#125; </span></span><br><span class="line"><span class="string">	else if ( $3&gt;=1 &amp;&amp; $3&lt;=499 || $3==65534 ) </span></span><br><span class="line"><span class="string">		&#123;j++&#125; </span></span><br><span class="line"><span class="string">	else </span></span><br><span class="line"><span class="string">		&#123;k++&#125;</span></span><br><span class="line"><span class="string">&#125;;</span></span><br><span class="line"><span class="string">END&#123;print &quot;管理员个数为:&quot;i &quot;\n系统用户个数为:&quot;j&quot;\n普通用户的个数为:&quot;k&#125;&#x27;</span> awk_test.txt</span><br></pre></td></tr></table></figure><p><strong>6.2 循环语句</strong></p><p><strong>6.2.1 for循环</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打印1~5</span></span><br><span class="line"><span class="keyword">for</span> ((i=<span class="number">1</span>;i&lt;=<span class="number">5</span>;i++));<span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$i</span>;done</span><br><span class="line"></span><br><span class="line"><span class="comment"># awk 打印 1-5</span></span><br><span class="line">awk <span class="string">&#x27;BEGIN &#123; for(i=1;i&lt;=5;i++) &#123;print i&#125; &#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印1~10中的奇数</span></span><br><span class="line"><span class="keyword">for</span> ((i=<span class="number">1</span>;i&lt;=<span class="number">10</span>;i+=<span class="number">2</span>));<span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$i</span>;done|awk <span class="string">&#x27;&#123;sum+=$0&#125;;END&#123;print sum&#125;&#x27;</span></span><br><span class="line">awk <span class="string">&#x27;BEGIN&#123; for(i=1;i&lt;=10;i+=2) &#123;print i&#125; &#125;&#x27;</span></span><br><span class="line">awk <span class="string">&#x27;BEGIN&#123; for(i=1;i&lt;=10;i+=2) print i &#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算1-5的和</span></span><br><span class="line">awk <span class="string">&#x27;BEGIN&#123;sum=0;for(i=1;i&lt;=5;i++) sum+=i;print sum&#125;&#x27;</span></span><br><span class="line">awk <span class="string">&#x27;BEGIN&#123;for(i=1;i&lt;=5;i++) (sum+=i);&#123;print sum&#125;&#125;&#x27;</span></span><br><span class="line">awk <span class="string">&#x27;BEGIN&#123;for(i=1;i&lt;=5;i++) (sum+=i);print sum&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>6.2.2 while 循环</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打印1-5</span></span><br><span class="line">i=<span class="number">1</span>;<span class="keyword">while</span> ((<span class="variable">$i</span>&lt;=<span class="number">5</span>));<span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$i</span>;let i++;done</span><br><span class="line"></span><br><span class="line"><span class="comment"># awk while 循环打印 1-5</span></span><br><span class="line">awk <span class="string">&#x27;BEGIN &#123; i=1;while(i&lt;=5) &#123;print i;i++&#125; &#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印1~10中的奇数</span></span><br><span class="line">awk <span class="string">&#x27;BEGIN&#123;i=1;while(i&lt;=10) &#123;print i;i+=2&#125; &#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算1-5的和</span></span><br><span class="line">awk <span class="string">&#x27;BEGIN&#123;i=1;sum=0;while(i&lt;=5) &#123;sum+=i;i++&#125;; print sum &#125;&#x27;</span></span><br><span class="line">awk <span class="string">&#x27;BEGIN &#123;i=1;while(i&lt;=5) &#123;(sum+=i) i++&#125;;print sum &#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>6.2.3 嵌套循环</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">嵌套循环：</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> ((y=<span class="number">1</span>;y&lt;=<span class="number">5</span>;y++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="keyword">for</span> ((x=<span class="number">1</span>;x&lt;=<span class="variable">$y</span>;x++))</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="literal">-n</span> <span class="variable">$x</span>	</span><br><span class="line">	done</span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">awk <span class="string">&#x27;BEGIN&#123; for(y=1;y&lt;=5;y++) &#123;for(x=1;x&lt;=y;x++) &#123;printf x&#125; ;print &#125; &#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># awk &#x27;BEGIN &#123; for(y=1;y&lt;=5;y++) &#123; for(x=1;x&lt;=y;x++) &#123;printf x&#125;;print&#125; &#125;&#x27;</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">12</span></span><br><span class="line"><span class="number">123</span></span><br><span class="line"><span class="number">1234</span></span><br><span class="line"><span class="number">12345</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># awk &#x27;BEGIN&#123; y=1;while(y&lt;=5) &#123; for(x=1;x&lt;=y;x++) &#123;printf x&#125;;y++;print&#125;&#125;&#x27;</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">12</span></span><br><span class="line"><span class="number">123</span></span><br><span class="line"><span class="number">1234</span></span><br><span class="line"><span class="number">12345</span></span><br><span class="line"></span><br><span class="line">尝试用三种方法打印<span class="number">99</span>口诀表：</span><br><span class="line"><span class="comment">#awk &#x27;BEGIN&#123;for(y=1;y&lt;=9;y++) &#123; for(x=1;x&lt;=y;x++) &#123;printf x&quot;*&quot;y&quot;=&quot;x*y&quot;\t&quot;&#125;;print&#125; &#125;&#x27;</span></span><br><span class="line"><span class="comment">#awk &#x27;BEGIN&#123;for(y=1;y&lt;=9;y++) &#123; for(x=1;x&lt;=y;x++) printf x&quot;*&quot;y&quot;=&quot;x*y&quot;\t&quot;;print&#125; &#125;&#x27;</span></span><br><span class="line"><span class="comment">#awk &#x27;BEGIN&#123;i=1;while(i&lt;=9)&#123;for(j=1;j&lt;=i;j++) &#123;printf j&quot;*&quot;i&quot;=&quot;j*i&quot;\t&quot;&#125;;print;i++ &#125;&#125;&#x27;</span></span><br><span class="line"><span class="comment">#awk &#x27;BEGIN&#123;for(i=1;i&lt;=9;i++)&#123;j=1;while(j&lt;=i) &#123;printf j&quot;*&quot;i&quot;=&quot;i*j&quot;\t&quot;;j++&#125;;print&#125;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">循环的控制：</span><br><span class="line"><span class="keyword">break</span>		条件满足的时候中断循环</span><br><span class="line"><span class="keyword">continue</span>	条件满足的时候跳过循环</span><br><span class="line"><span class="comment"># awk &#x27;BEGIN&#123;for(i=1;i&lt;=5;i++) &#123;if(i==3) break;print i&#125; &#125;&#x27;</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="comment"># awk &#x27;BEGIN&#123;for(i=1;i&lt;=5;i++)&#123;if(i==3) continue;print i&#125;&#125;&#x27;</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br></pre></td></tr></table></figure><p><strong>6.3 awk算数运算</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+ - * / %(模) ^(幂<span class="number">2</span>^<span class="number">3</span>)</span><br><span class="line">可以在模式中执行计算，awk都将按浮点数方式执行算术运算</span><br><span class="line"><span class="comment"># awk &#x27;BEGIN&#123;print 1+1&#125;&#x27;</span></span><br><span class="line"><span class="comment"># awk &#x27;BEGIN&#123;print 1**1&#125;&#x27;</span></span><br><span class="line"><span class="comment"># awk &#x27;BEGIN&#123;print 2**3&#125;&#x27;</span></span><br><span class="line"><span class="comment"># awk &#x27;BEGIN&#123;print 2/3&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="统计案例"><a href="#统计案例" class="headerlink" title="统计案例"></a>统计案例</h4><p><strong>7.1 统计系统中各种类型的shell</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># awk -F: &#x27;&#123; shells[$NF]++ &#125;;END&#123;for (i in shells) &#123;print i,shells[i]&#125; &#125;&#x27; /etc/passwd</span></span><br><span class="line">/bin/sync <span class="number">1</span></span><br><span class="line">/bin/bash <span class="number">2</span></span><br><span class="line">/sbin/nologin <span class="number">17</span></span><br><span class="line">/sbin/halt <span class="number">1</span></span><br><span class="line">/sbin/shutdown <span class="number">1</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">解释：此命令目的是打印出 shell 解释器的数量</span><br><span class="line">关键在于创建一个关联数组 shells</span><br><span class="line"><span class="variable">$NF</span> 是每行的最后一列即是 shell 解释器</span><br><span class="line">shells[<span class="variable">$NF</span>] 中 <span class="variable">$NF</span> 可以理解为下标，也可以理解为是 KEY 值 </span><br><span class="line">每行在执行的时候就是 shells[/<span class="type">bin</span>/<span class="type">sync</span>]  ........</span><br><span class="line">++ 可以理解为是 KEY 对应的 VALUE 值，每次相同的时候就 ++ 即对相同的解释器进行累加</span><br><span class="line">后面的 <span class="keyword">for</span> 循环可以理解为 <span class="keyword">for</span> i <span class="keyword">in</span> shells.KEY</span><br><span class="line">循环遍历数组内的下标</span><br><span class="line">所以 i 就是下标或者理解为 KEY</span><br><span class="line">所以 shells[<span class="type">i</span>] 就是 shells[<span class="type">KEY</span>] 可以理解为 KEY.VALUE</span><br></pre></td></tr></table></figure><p><strong>7.2 统计网站访问状态</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">Jermyn</span> <span class="type">shell_scripts</span>]<span class="comment"># ss -antp | grep 22 | awk &#x27;&#123;states[$1]++&#125;;END&#123;for (i in states) &#123;print i,states[i]&#125;&#125;&#x27; | sort -nr -t &#x27; &#x27; -k 2</span></span><br><span class="line">LISTEN <span class="number">2</span></span><br><span class="line">ESTAB <span class="number">2</span></span><br></pre></td></tr></table></figure><p><strong>7.3 统计访问网站的每个IP的数量</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># netstat -ant |grep :80 |awk -F: &#x27;&#123;ip_count[$8]++&#125;;END&#123;for(i in ip_count)&#123;print i,ip_count[i]&#125; &#125;&#x27; |sort</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ss -an |grep :80 | awk -F&quot;:&quot; &#x27;!/LISTEN/&#123;ip_count[$(NF-1)]++&#125;;END&#123;for(i in ip_count)&#123;print i,ip_count[i]&#125;&#125;&#x27; |sort -k2 -rn |head</span></span><br></pre></td></tr></table></figure><p><strong>7.4 统计网站日志中PV量</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">统计Apache/Nginx日志中某一天的PV量 　&lt;统计日志&gt;</span><br><span class="line"><span class="comment"># grep &#x27;27/Jul/2017&#x27; mysqladmin.cc-access_log |wc -l</span></span><br><span class="line"><span class="number">14519</span></span><br><span class="line"></span><br><span class="line">统计Apache/Nginx日志中某一天不同IP的访问量　&lt;统计日志&gt;</span><br><span class="line"><span class="comment"># grep &#x27;27/Jul/2017&#x27; mysqladmin.cc-access_log |awk &#x27;&#123;ips[$1]++&#125;;END&#123;for(i in ips)&#123;print i,ips[i]&#125; &#125;&#x27; |sort -k2 -rn |head</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># grep &#x27;07/Aug/2017&#x27; access.log |awk &#x27;&#123;ips[$1]++&#125;;END&#123;for(i in ips)&#123;print i,ips[i]&#125; &#125;&#x27; |awk &#x27;$2&gt;100&#x27; |sort -k2 -rn</span></span><br></pre></td></tr></table></figure><p><strong>名词解释：</strong></p><blockquote><p>网站浏览量（PV）<br>名词：PV=PageView (网站浏览量)<br>说明：指页面的浏览次数，用以衡量网站用户访问的网页数量。多次打开同一页面则浏览量累计。用户每打开一个页面便记录1次PV。</p><p>名词：VV = Visit View（访问次数）<br>说明：从访客来到您网站到最终关闭网站的所有页面离开，计为1次访问。若访客连续30分钟没有新开和刷新页面，或者访客关闭了浏览器，则被计算为本次访问结束。</p><p>独立访客（UV）<br>名词：UV= Unique Visitor（独立访客数）<br>说明：1天内相同的访客多次访问您的网站只计算1个UV。</p><p>独立IP（IP）<br>名词：IP=独立IP数<br>说明：指1天内使用不同IP地址的用户访问网站的数量。同一IP无论访问了几个页面，独立IP数均为1</p></blockquote></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="https://www.jermyn.cn">Jermyn</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://www.jermyn.cn/posts/d746.html">https://www.jermyn.cn/posts/d746.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.jermyn.cn" target="_blank">Jermyn's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/shell%E8%84%9A%E6%9C%AC/">shell脚本</a></div><div class="post_share"><div class="social-share" data-image="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed@main/9a8a/8.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/2c50.html"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed@main/blogImages/5.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Tag-Plugins-Plus</div></div></a></div><div class="next-post pull-right"><a href="/posts/c9d2.html"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed@main/blogImages/8.jpeg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">kafka基本操作</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/eb1d.html" title="Linux基础命令"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed/facf/a2515c0b70892176ece5818b442caf1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-05-22</div><div class="title">Linux基础命令</div></div></a></div><div><a href="/posts/f495.html" title="Linux磁盘的挂载和卸载"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed/facf/164328e26e5f747d41095c92e017d82.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-05-22</div><div class="title">Linux磁盘的挂载和卸载</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed@main/9a8a/auther.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">Jermyn</div><div class="author-info__description">个人学习笔记</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">17</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Jermyn-code"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/Jermyn-code" target="_blank" title="Github"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-github-fill"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=1773046949@qq.com" target="_blank" title="Email"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-mail"></use></svg></a><a class="social-icon faa-parent animated-hover" href="tencent://Message/?Uin=1773046949&amp;amp;websiteName=local.edu.com:8888=&amp;amp;Menu=yes" target="_blank" title="QQ"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-QQ1"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed@main/blogImages/qrcode.jpg" target="_blank" title="WeChat"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-weixin"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://www.instagram.com/born_in2084/" target="_blank" title="Instagram"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-instagram-fill"></use></svg></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">在读学习，联系我请+VX：AYOBRUH</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E5%B7%A5%E5%85%B7%E7%94%A8%E6%B3%95"><span class="toc-number">1.</span> <span class="toc-text">小工具用法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#grep-%E7%94%A8%E6%B3%95"><span class="toc-number">1.0.1.</span> <span class="toc-text">grep 用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#cut-%E7%94%A8%E6%B3%95"><span class="toc-number">1.0.2.</span> <span class="toc-text">cut 用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#tee-%E7%94%A8%E6%B3%95"><span class="toc-number">1.0.3.</span> <span class="toc-text">tee 用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sort-%E7%94%A8%E6%B3%95"><span class="toc-number">1.0.4.</span> <span class="toc-text">sort 用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#uniq-%E7%94%A8%E6%B3%95"><span class="toc-number">1.0.5.</span> <span class="toc-text">uniq 用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#diff-%E7%94%A8%E6%B3%95"><span class="toc-number">1.0.6.</span> <span class="toc-text">diff 用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#paste%E7%94%A8%E6%B3%95"><span class="toc-number">1.0.7.</span> <span class="toc-text">paste用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#tr-%E7%94%A8%E6%B3%95"><span class="toc-number">1.0.8.</span> <span class="toc-text">tr 用法</span></a></li></ol></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#bash-%E7%89%B9%E6%80%A7"><span class="toc-number">2.</span> <span class="toc-text">bash 特性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E5%92%8C%E6%96%87%E4%BB%B6%E8%87%AA%E5%8A%A8%E8%A1%A5%E5%85%A8"><span class="toc-number">2.0.1.</span> <span class="toc-text">命令和文件自动补全</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell-%E5%88%9D%E8%AF%86"><span class="toc-number">3.</span> <span class="toc-text">shell 初识</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E4%B8%AAshll-%E8%84%9A%E6%9C%AC"><span class="toc-number">3.0.1.</span> <span class="toc-text">第一个shll 脚本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%99%E4%B8%80%E4%B8%AA-shell-%E8%84%9A%E6%9C%AC"><span class="toc-number">3.0.2.</span> <span class="toc-text">写一个 shell 脚本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-number">4.</span> <span class="toc-text">变量的定义</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="toc-number">4.0.1.</span> <span class="toc-text">定义变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E5%90%8D%E5%AE%9A%E4%B9%89%E8%A7%84%E5%88%99"><span class="toc-number">4.0.2.</span> <span class="toc-text">变量名定义规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E5%90%8D%E7%9A%84%E5%AE%9A%E4%B9%89%E6%96%B9%E5%BC%8F"><span class="toc-number">4.0.3.</span> <span class="toc-text">变量名的定义方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">4.0.4.</span> <span class="toc-text">变量的分类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84%E5%9B%9B%E5%88%99%E8%BF%90%E7%AE%97"><span class="toc-number">5.</span> <span class="toc-text">简单的四则运算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9B%E5%88%99%E8%BF%90%E7%AE%97%E7%AC%A6%E5%8F%B7"><span class="toc-number">5.0.1.</span> <span class="toc-text">四则运算符号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#i-%E5%92%8C-i"><span class="toc-number">5.0.2.</span> <span class="toc-text">i++ 和 ++i</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E5%AE%9A%E4%B9%89"><span class="toc-number">5.0.3.</span> <span class="toc-text">数组定义</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD%E8%AF%AD%E5%8F%A5"><span class="toc-number">6.</span> <span class="toc-text">条件判断语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD%E8%AF%AD%E5%8F%A5-1"><span class="toc-number">6.0.1.</span> <span class="toc-text">条件判断语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD%E7%9B%B8%E5%85%B3%E5%8F%82%E6%95%B0"><span class="toc-number">6.0.2.</span> <span class="toc-text">条件判断相关参数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5%EF%BC%88if%E2%80%A6-%EF%BC%89"><span class="toc-number">7.</span> <span class="toc-text">流程控制语句（if….）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E7%BB%93%E6%9E%84"><span class="toc-number">7.0.1.</span> <span class="toc-text">基本语法结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD%E8%AF%AD%E5%8F%A5%EF%BC%88for%E2%80%A6-%EF%BC%89"><span class="toc-number">8.</span> <span class="toc-text">条件判断语句（for….）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#for%E5%BE%AA%E7%8E%AF%E8%AF%AD%E6%B3%95%E7%BB%93%E6%9E%84"><span class="toc-number">8.0.1.</span> <span class="toc-text">for循环语法结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD%E8%AF%AD%E5%8F%A5%EF%BC%88while%E2%80%A6-amp-until%EF%BC%89"><span class="toc-number">9.</span> <span class="toc-text">条件判断语句（while…&amp;until）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#while%E5%BE%AA%E7%8E%AF"><span class="toc-number">9.0.1.</span> <span class="toc-text">while循环</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A0-%E5%85%B7%E4%BD%93%E9%9C%80%E6%B1%82"><span class="toc-number">9.0.2.</span> <span class="toc-text">① 具体需求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A1-%E6%80%9D%E8%B7%AF"><span class="toc-number">9.0.3.</span> <span class="toc-text">② 思路</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#until-%E5%BE%AA%E7%8E%AF"><span class="toc-number">9.0.4.</span> <span class="toc-text">until 循环</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E6%95%B0"><span class="toc-number">10.</span> <span class="toc-text">随机数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E9%9A%8F%E6%9C%BA%E6%95%B0"><span class="toc-number">10.0.1.</span> <span class="toc-text">生成随机数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-number">10.0.2.</span> <span class="toc-text">示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E5%B5%8C%E5%A5%97-shift-%E4%BD%8D%E7%A7%BB-%E8%A1%A5%E5%85%85expect"><span class="toc-number">11.</span> <span class="toc-text">循环嵌套+shift 位移+补充expect</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95%EF%BC%9A"><span class="toc-number">11.0.1.</span> <span class="toc-text">语法：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#shift-%E4%BD%8D%E7%A7%BB%E7%9A%84%E7%94%A8%E6%B3%95"><span class="toc-number">11.0.2.</span> <span class="toc-text">shift 位移的用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A5%E5%85%85%E6%89%A9%E5%B1%95expect"><span class="toc-number">11.0.3.</span> <span class="toc-text">补充扩展expect</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E6%88%98%E7%A4%BA%E4%BE%8B"><span class="toc-number">12.</span> <span class="toc-text">实战示例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%99%E4%B8%80%E4%B8%AA%E8%84%9A%E6%9C%AC%EF%BC%8C%E7%BB%9F%E8%AE%A1web%E6%9C%8D%E5%8A%A1%E7%9A%84%E4%B8%8D%E5%90%8C%E8%BF%9E%E6%8E%A5%E7%8A%B6%E6%80%81%E4%B8%AA%E6%95%B0"><span class="toc-number">12.0.1.</span> <span class="toc-text">写一个脚本，统计web服务的不同连接状态个数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#case%E8%AF%AD%E5%8F%A5-%E5%87%BD%E6%95%B0"><span class="toc-number">13.</span> <span class="toc-text">case语句+函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#case%E8%AF%AD%E5%8F%A5"><span class="toc-number">13.0.1.</span> <span class="toc-text">case语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-number">13.0.2.</span> <span class="toc-text">函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">14.</span> <span class="toc-text">正则表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E6%AD%A3%E5%88%99%E4%B8%AD%E6%99%AE%E9%80%9A%E5%B8%B8%E7%94%A8%E7%9A%84%E5%85%83%E5%AD%97%E7%AC%A6"><span class="toc-number">14.0.1.</span> <span class="toc-text">1.1 正则中普通常用的元字符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E6%AD%A3%E5%88%99%E4%B8%AD%E5%85%B6%E4%BB%96%E5%B8%B8%E7%94%A8%E5%85%83%E5%AD%97%E7%AC%A6"><span class="toc-number">14.0.2.</span> <span class="toc-text">1.2 正则中其他常用元字符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-%E6%89%A9%E5%B1%95%E7%B1%BB%E6%AD%A3%E5%88%99%E5%B8%B8%E7%94%A8%E5%85%83%E5%AD%97%E7%AC%A6"><span class="toc-number">14.0.3.</span> <span class="toc-text">1.3 扩展类正则常用元字符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-%E7%AC%AC%E4%BA%8C%E7%B1%BB%E6%AD%A3%E5%88%99"><span class="toc-number">14.0.4.</span> <span class="toc-text">1.4 第二类正则</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E5%AD%97%E7%AC%A6%E4%B8%80%E8%A7%88%E8%A1%A8"><span class="toc-number">15.</span> <span class="toc-text">正则字符一览表</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0"><span class="toc-number">15.0.1.</span> <span class="toc-text">练习</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E6%90%AD%E5%BB%BAWeb%E6%9C%8D%E5%8A%A1"><span class="toc-number">16.</span> <span class="toc-text">脚本搭建Web服务</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E6%90%AD%E5%BB%BAweb%E6%9C%8D%E5%8A%A1"><span class="toc-number">16.0.1.</span> <span class="toc-text">脚本搭建web服务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sed-%E7%94%A8%E6%B3%95"><span class="toc-number">17.</span> <span class="toc-text">sed 用法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%A0%BC%E5%BC%8F"><span class="toc-number">17.0.1.</span> <span class="toc-text">命令行格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E6%A8%A1%E5%BC%8F"><span class="toc-number">17.0.2.</span> <span class="toc-text">脚本模式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#awk%E7%94%A8%E6%B3%95"><span class="toc-number">18.</span> <span class="toc-text">awk用法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#awk-%E4%BB%8B%E7%BB%8D"><span class="toc-number">18.0.1.</span> <span class="toc-text">awk 介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#awk-%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">18.0.2.</span> <span class="toc-text">awk 使用方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8"><span class="toc-number">18.0.3.</span> <span class="toc-text">脚本模式使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#awk%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">18.0.4.</span> <span class="toc-text">awk工作原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#awk%E4%BD%BF%E7%94%A8%E8%BF%9B%E9%98%B6"><span class="toc-number">18.0.5.</span> <span class="toc-text">awk使用进阶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#awk%E7%9A%84%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B"><span class="toc-number">18.0.6.</span> <span class="toc-text">awk的脚本编程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%9F%E8%AE%A1%E6%A1%88%E4%BE%8B"><span class="toc-number">18.0.7.</span> <span class="toc-text">统计案例</span></a></li></ol></li></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/9b06.html" title="zookeeper技术"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed/9b06/a1c4c5ed718d3dcfacaa90f881266cd.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="zookeeper技术"></a><div class="content"><a class="title" href="/posts/9b06.html" title="zookeeper技术">zookeeper技术</a><time datetime="2023-07-10T11:35:16.000Z" title="发表于 2023-07-10 11:35:16">2023-07-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/3a9e.html" title="Hadoop3.x"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed/3a9e/c5a81243b295e460476d240cd09e442.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Hadoop3.x"></a><div class="content"><a class="title" href="/posts/3a9e.html" title="Hadoop3.x">Hadoop3.x</a><time datetime="2023-06-06T21:12:09.000Z" title="发表于 2023-06-06 21:12:09">2023-06-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/77ed.html" title="Hadoop2.x源码编译"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed/facf/7c668fc4863f9534bfc36f9b42fd723.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Hadoop2.x源码编译"></a><div class="content"><a class="title" href="/posts/77ed.html" title="Hadoop2.x源码编译">Hadoop2.x源码编译</a><time datetime="2023-05-25T18:12:54.000Z" title="发表于 2023-05-25 18:12:54">2023-05-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/facf.html" title="Hadoop2.x"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed/facf/006bf826d4ef7fff55821708a9726a2.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Hadoop2.x"></a><div class="content"><a class="title" href="/posts/facf.html" title="Hadoop2.x">Hadoop2.x</a><time datetime="2023-05-23T21:12:50.000Z" title="发表于 2023-05-23 21:12:50">2023-05-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/eb1d.html" title="Linux基础命令"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed/facf/a2515c0b70892176ece5818b442caf1.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Linux基础命令"></a><div class="content"><a class="title" href="/posts/eb1d.html" title="Linux基础命令">Linux基础命令</a><time datetime="2023-05-22T22:17:56.000Z" title="发表于 2023-05-22 22:17:56">2023-05-22</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2023 By Jermyn</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo.jermyn.cn/',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.jermyn.cn/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><div class="aplayer no-destroy" data-id="8670693070" data-server="tencent" data-type="playlist" data-order="list" data-fixed="true" data-preload="auto" data-autoplay="false" data-mutex="true"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><div class="app-refresh" id="app-refresh" style="position:fixed;top:-2.2rem;left:0;right:0;z-index:99999;padding:0 1rem;font-size:15px;height:2.2rem;transition:all .3s ease"><div class="app-refresh-wrap" style="display:flex;color:#fff;height:100%;align-items:center;justify-content:center"><label>✨ 有新文章啦！ 👉</label><a href="javascript:void(0)" onclick="location.reload()"><span style="color:#fff;text-decoration:underline;cursor:pointer">🍗点击食用🍔</span></a></div></div><script>if ('serviceWorker' in navigator) {
if (navigator.serviceWorker.controller) {
navigator.serviceWorker.addEventListener('controllerchange', function() {
showNotification()
})
}
window.addEventListener('load', function() {
navigator.serviceWorker.register('/sw.js')
})
}
function showNotification() {
if (GLOBAL_CONFIG.Snackbar) {
var snackbarBg =
document.documentElement.getAttribute('data-theme') === 'light' ?
GLOBAL_CONFIG.Snackbar.bgLight :
GLOBAL_CONFIG.Snackbar.bgDark
var snackbarPos = GLOBAL_CONFIG.Snackbar.position
Snackbar.show({
text: '✨ 有新文章啦！ 👉',
backgroundColor: snackbarBg,
duration: 500000,
pos: snackbarPos,
actionText: '🍗点击食用🍔',
actionTextColor: '#fff',
onActionClick: function(e) {
location.reload()
},
})
} else {
var showBg =
document.documentElement.getAttribute('data-theme') === 'light' ?
'#49b1f5' :
'#1f1f1f'
var cssText = `top: 0; background: ${showBg};`
document.getElementById('app-refresh').style.cssText = cssText
}
}</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script data-pjax>function butterfly_clock_anzhiyu_injector_config(){var e=document.getElementsByClassName("sticky_layout")[0];console.log("已挂载butterfly_clock_anzhiyu"),e&&e.insertAdjacentHTML("afterbegin",'<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>')}for(var elist="null".split(","),cpage=location.pathname,epage="all",qweather_key="0f5e430e0ec2485a8e175000f1ca33eb",gaud_map_key="163f0b807c26d68365ae5f029f76cf19",baidu_ak_key="undefined",flag=0,clock_rectangle="111.62,33.79",clock_default_rectangle_enable="false",i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;"all"===epage&&0==flag?butterfly_clock_anzhiyu_injector_config():epage===cpage&&butterfly_clock_anzhiyu_injector_config()</script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script data-pjax>function butterfly_footer_beautify_injector_config(){var A=document.getElementById("footer-wrap");console.log("已挂载butterfly_footer_beautify"),A.insertAdjacentHTML("beforeend",'<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v4.2.2" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://cloud.tencent.com/" style="margin-inline:5px" data-title="本站使用JsDelivr为静态资源提供CDN加速" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/CDN-Tencent-blue?style=flat&amp;logo=iCloud" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/Jermyn-code" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>')}for(var elist="null".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;"all"===epage&&0==flag?butterfly_footer_beautify_injector_config():epage===cpage&&butterfly_footer_beautify_injector_config()</script><script async src="/js/runtime/runtime.min.js"></script><script data-pjax>function butterfly_swiper_injector_config(){var a=document.getElementById("recent-posts");console.log("已挂载butterfly_swiper"),a.insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/9a8a.html" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed@main/blogImages/1.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-10-02</span><a class="blog-slider__title" href="posts/9a8a.html" alt="">Java高级编程</a><div class="blog-slider__text">Java学习笔记，Java基础阶段的高级编程，包含多线程，Java常用类，枚举类&amp;注解，Java集合，泛型，IO流，网络编程，Java反射机制，Java8的其他新特性，Java9&amp;10&amp;11新特性，文档资源来自尚硅谷，整理为博主，在此感谢尚硅谷无私分享大量的学习资源。</div><a class="blog-slider__button" href="posts/9a8a.html" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/ba42.html" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed@main/blogImages/3.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-26</span><a class="blog-slider__title" href="posts/ba42.html" alt="">Hadoop集群脚本部署</a><div class="blog-slider__text">Hadoop脚本部署，包含7个shell脚本，以及一个ip.txt文件，建议运行顺序为00-06</div><a class="blog-slider__button" href="posts/ba42.html" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/ef13.html" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed@main/blogImages/6.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-27</span><a class="blog-slider__title" href="posts/ef13.html" alt="">大数据集群服务部署</a><div class="blog-slider__text">本文为大数据集群服务的部署文档,包括zookeeper服务部署,Hadoop服务部署,Spark服务部署,Kafka服务部署,Hbase服务部署,Hive服务部署</div><a class="blog-slider__button" href="posts/ef13.html" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/d746.html" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed@main/9a8a/8.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-26</span><a class="blog-slider__title" href="posts/d746.html" alt="">shell 学习笔记</a><div class="blog-slider__text">shell脚本学习笔记，学完可自行编写shell脚本</div><a class="blog-slider__button" href="posts/d746.html" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/e6c9.html" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn1.tianli0.top/gh/Jermyn-code/FigureBed@main/blogImages/2.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-09-02</span><a class="blog-slider__title" href="posts/e6c9.html" alt="">Jave基础编程</a><div class="blog-slider__text">Java学习笔记，Java基础阶段的基础编程，包含Java语言概述，基本语法，数组，面向对象编程，异常处理。文档资源来自尚硅谷，整理为博主，在此感谢尚硅谷无私分享大量的学习资源。</div><a class="blog-slider__button" href="posts/e6c9.html" alt="">详情   </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>')}for(var elist="undefined".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;"all"===epage&&0==flag?butterfly_swiper_injector_config():epage===cpage&&butterfly_swiper_injector_config()</script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><div class="js-pjax"><script async>for(var arr=document.getElementsByClassName("recent-post-item"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration","1.5s"),arr[i].setAttribute("data-wow-delay","200ms"),arr[i].setAttribute("data-wow-offset","30"),arr[i].setAttribute("data-wow-iteration","1")</script><script async>for(var arr=document.getElementsByClassName("card-widget"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration",""),arr[i].setAttribute("data-wow-delay","200ms"),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script><script async>for(var arr=document.getElementsByClassName("flink-list-card"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__flipInY"),arr[i].setAttribute("data-wow-duration","3s"),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script><script async>for(var arr=document.getElementsByClassName("flink-list-card"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__animated"),arr[i].setAttribute("data-wow-duration","3s"),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script><script async>for(var arr=document.getElementsByClassName("article-sort-item"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__slideInRight"),arr[i].setAttribute("data-wow-duration","1.5s"),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script><script async>for(var arr=document.getElementsByClassName("site-card"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__flipInY"),arr[i].setAttribute("data-wow-duration","3s"),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script><script async>for(var arr=document.getElementsByClassName("site-card"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__animated"),arr[i].setAttribute("data-wow-duration","3s"),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script></div><script defer src="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/wow_init.js"></script><script async src="//at.alicdn.com/t/c/font_3617685_a7gpo3nfht.js"></script></body></html>